const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/host-Be33yNiH.js","assets/clsx-B-dksMZM.js","assets/audience-DU3g1Np7.js"])))=>i.map(i=>d[i]);
var Ov=l=>{throw TypeError(l)};var Bd=(l,t,e)=>t.has(l)||Ov("Cannot "+e);var Zt=(l,t,e)=>(Bd(l,t,"read from private field"),e?e.call(l):t.get(l)),qi=(l,t,e)=>t.has(l)?Ov("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(l):t.set(l,e),Ge=(l,t,e,i)=>(Bd(l,t,"write to private field"),i?i.call(l,e):t.set(l,e),e),Vi=(l,t,e)=>(Bd(l,t,"access private method"),e);var Mv=(l,t,e,i)=>({set _(n){Ge(l,t,n,e)},get _(){return Zt(l,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();function Gf(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function d0(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var t=l.default;if(typeof t=="function"){var e=function i(){var n=!1;try{n=this instanceof i}catch{}return n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(l).forEach(function(i){var n=Object.getOwnPropertyDescriptor(l,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return l[i]}})}),e}var Id={exports:{}},uo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function PA(){if(kv)return uo;kv=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,n,a){var o=null;if(a!==void 0&&(o=""+a),n.key!==void 0&&(o=""+n.key),"key"in n){a={};for(var u in n)u!=="key"&&(a[u]=n[u])}else a=n;return n=a.ref,{$$typeof:l,type:i,key:o,ref:n!==void 0?n:null,props:a}}return uo.Fragment=t,uo.jsx=e,uo.jsxs=e,uo}var Dv;function NA(){return Dv||(Dv=1,Id.exports=PA()),Id.exports}var st=NA(),jd={exports:{}},ho={},Ud={exports:{}},Fd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lv;function BA(){return Lv||(Lv=1,(function(l){function t(N,q){var Q=N.length;N.push(q);t:for(;0<Q;){var vt=Q-1>>>1,Ct=N[vt];if(0<n(Ct,q))N[vt]=q,N[Q]=Ct,Q=vt;else break t}}function e(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var q=N[0],Q=N.pop();if(Q!==q){N[0]=Q;t:for(var vt=0,Ct=N.length,L=Ct>>>1;vt<L;){var $=2*(vt+1)-1,K=N[$],J=$+1,at=N[J];if(0>n(K,Q))J<Ct&&0>n(at,K)?(N[vt]=at,N[J]=Q,vt=J):(N[vt]=K,N[$]=Q,vt=$);else if(J<Ct&&0>n(at,Q))N[vt]=at,N[J]=Q,vt=J;else break t}}return q}function n(N,q){var Q=N.sortIndex-q.sortIndex;return Q!==0?Q:N.id-q.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;l.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();l.unstable_now=function(){return o.now()-u}}var d=[],f=[],p=1,g=null,v=3,b=!1,w=!1,_=!1,A=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function x(N){for(var q=e(f);q!==null;){if(q.callback===null)i(f);else if(q.startTime<=N)i(f),q.sortIndex=q.expirationTime,t(d,q);else break;q=e(f)}}function D(N){if(_=!1,x(N),!w)if(e(d)!==null)w=!0,M||(M=!0,et());else{var q=e(f);q!==null&&yt(D,q.startTime-N)}}var M=!1,k=-1,I=5,H=-1;function X(){return A?!0:!(l.unstable_now()-H<I)}function W(){if(A=!1,M){var N=l.unstable_now();H=N;var q=!0;try{t:{w=!1,_&&(_=!1,R(k),k=-1),b=!0;var Q=v;try{e:{for(x(N),g=e(d);g!==null&&!(g.expirationTime>N&&X());){var vt=g.callback;if(typeof vt=="function"){g.callback=null,v=g.priorityLevel;var Ct=vt(g.expirationTime<=N);if(N=l.unstable_now(),typeof Ct=="function"){g.callback=Ct,x(N),q=!0;break e}g===e(d)&&i(d),x(N)}else i(d);g=e(d)}if(g!==null)q=!0;else{var L=e(f);L!==null&&yt(D,L.startTime-N),q=!1}}break t}finally{g=null,v=Q,b=!1}q=void 0}}finally{q?et():M=!1}}}var et;if(typeof C=="function")et=function(){C(W)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,ft=mt.port2;mt.port1.onmessage=W,et=function(){ft.postMessage(null)}}else et=function(){E(W,0)};function yt(N,q){k=E(function(){N(l.unstable_now())},q)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(N){N.callback=null},l.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<N?Math.floor(1e3/N):5},l.unstable_getCurrentPriorityLevel=function(){return v},l.unstable_next=function(N){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var Q=v;v=q;try{return N()}finally{v=Q}},l.unstable_requestPaint=function(){A=!0},l.unstable_runWithPriority=function(N,q){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var Q=v;v=N;try{return q()}finally{v=Q}},l.unstable_scheduleCallback=function(N,q,Q){var vt=l.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?vt+Q:vt):Q=vt,N){case 1:var Ct=-1;break;case 2:Ct=250;break;case 5:Ct=1073741823;break;case 4:Ct=1e4;break;default:Ct=5e3}return Ct=Q+Ct,N={id:p++,callback:q,priorityLevel:N,startTime:Q,expirationTime:Ct,sortIndex:-1},Q>vt?(N.sortIndex=Q,t(f,N),e(d)===null&&N===e(f)&&(_?(R(k),k=-1):_=!0,yt(D,Q-vt))):(N.sortIndex=Ct,t(d,N),w||b||(w=!0,M||(M=!0,et()))),N},l.unstable_shouldYield=X,l.unstable_wrapCallback=function(N){var q=v;return function(){var Q=v;v=q;try{return N.apply(this,arguments)}finally{v=Q}}}})(Fd)),Fd}var Pv;function IA(){return Pv||(Pv=1,Ud.exports=BA()),Ud.exports}var zd={exports:{}},bt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv;function jA(){if(Nv)return bt;Nv=1;var l=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),v=Symbol.iterator;function b(L){return L===null||typeof L!="object"?null:(L=v&&L[v]||L["@@iterator"],typeof L=="function"?L:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,A={};function E(L,$,K){this.props=L,this.context=$,this.refs=A,this.updater=K||w}E.prototype.isReactComponent={},E.prototype.setState=function(L,$){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,$,"setState")},E.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function R(){}R.prototype=E.prototype;function C(L,$,K){this.props=L,this.context=$,this.refs=A,this.updater=K||w}var x=C.prototype=new R;x.constructor=C,_(x,E.prototype),x.isPureReactComponent=!0;var D=Array.isArray;function M(){}var k={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function H(L,$,K){var J=K.ref;return{$$typeof:l,type:L,key:$,ref:J!==void 0?J:null,props:K}}function X(L,$){return H(L.type,$,L.props)}function W(L){return typeof L=="object"&&L!==null&&L.$$typeof===l}function et(L){var $={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(K){return $[K]})}var mt=/\/+/g;function ft(L,$){return typeof L=="object"&&L!==null&&L.key!=null?et(""+L.key):$.toString(36)}function yt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(M,M):(L.status="pending",L.then(function($){L.status==="pending"&&(L.status="fulfilled",L.value=$)},function($){L.status==="pending"&&(L.status="rejected",L.reason=$)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function N(L,$,K,J,at){var ot=typeof L;(ot==="undefined"||ot==="boolean")&&(L=null);var lt=!1;if(L===null)lt=!0;else switch(ot){case"bigint":case"string":case"number":lt=!0;break;case"object":switch(L.$$typeof){case l:case t:lt=!0;break;case p:return lt=L._init,N(lt(L._payload),$,K,J,at)}}if(lt)return at=at(L),lt=J===""?"."+ft(L,0):J,D(at)?(K="",lt!=null&&(K=lt.replace(mt,"$&/")+"/"),N(at,$,K,"",function(Oi){return Oi})):at!=null&&(W(at)&&(at=X(at,K+(at.key==null||L&&L.key===at.key?"":(""+at.key).replace(mt,"$&/")+"/")+lt)),$.push(at)),1;lt=0;var Xt=J===""?".":J+":";if(D(L))for(var Pt=0;Pt<L.length;Pt++)J=L[Pt],ot=Xt+ft(J,Pt),lt+=N(J,$,K,ot,at);else if(Pt=b(L),typeof Pt=="function")for(L=Pt.call(L),Pt=0;!(J=L.next()).done;)J=J.value,ot=Xt+ft(J,Pt++),lt+=N(J,$,K,ot,at);else if(ot==="object"){if(typeof L.then=="function")return N(yt(L),$,K,J,at);throw $=String(L),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return lt}function q(L,$,K){if(L==null)return L;var J=[],at=0;return N(L,J,"","",function(ot){return $.call(K,ot,at++)}),J}function Q(L){if(L._status===-1){var $=L._result;$=$(),$.then(function(K){(L._status===0||L._status===-1)&&(L._status=1,L._result=K)},function(K){(L._status===0||L._status===-1)&&(L._status=2,L._result=K)}),L._status===-1&&(L._status=0,L._result=$)}if(L._status===1)return L._result.default;throw L._result}var vt=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},Ct={map:q,forEach:function(L,$,K){q(L,function(){$.apply(this,arguments)},K)},count:function(L){var $=0;return q(L,function(){$++}),$},toArray:function(L){return q(L,function($){return $})||[]},only:function(L){if(!W(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return bt.Activity=g,bt.Children=Ct,bt.Component=E,bt.Fragment=e,bt.Profiler=n,bt.PureComponent=C,bt.StrictMode=i,bt.Suspense=d,bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,bt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return k.H.useMemoCache(L)}},bt.cache=function(L){return function(){return L.apply(null,arguments)}},bt.cacheSignal=function(){return null},bt.cloneElement=function(L,$,K){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var J=_({},L.props),at=L.key;if($!=null)for(ot in $.key!==void 0&&(at=""+$.key),$)!I.call($,ot)||ot==="key"||ot==="__self"||ot==="__source"||ot==="ref"&&$.ref===void 0||(J[ot]=$[ot]);var ot=arguments.length-2;if(ot===1)J.children=K;else if(1<ot){for(var lt=Array(ot),Xt=0;Xt<ot;Xt++)lt[Xt]=arguments[Xt+2];J.children=lt}return H(L.type,at,J)},bt.createContext=function(L){return L={$$typeof:o,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:a,_context:L},L},bt.createElement=function(L,$,K){var J,at={},ot=null;if($!=null)for(J in $.key!==void 0&&(ot=""+$.key),$)I.call($,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(at[J]=$[J]);var lt=arguments.length-2;if(lt===1)at.children=K;else if(1<lt){for(var Xt=Array(lt),Pt=0;Pt<lt;Pt++)Xt[Pt]=arguments[Pt+2];at.children=Xt}if(L&&L.defaultProps)for(J in lt=L.defaultProps,lt)at[J]===void 0&&(at[J]=lt[J]);return H(L,ot,at)},bt.createRef=function(){return{current:null}},bt.forwardRef=function(L){return{$$typeof:u,render:L}},bt.isValidElement=W,bt.lazy=function(L){return{$$typeof:p,_payload:{_status:-1,_result:L},_init:Q}},bt.memo=function(L,$){return{$$typeof:f,type:L,compare:$===void 0?null:$}},bt.startTransition=function(L){var $=k.T,K={};k.T=K;try{var J=L(),at=k.S;at!==null&&at(K,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(M,vt)}catch(ot){vt(ot)}finally{$!==null&&K.types!==null&&($.types=K.types),k.T=$}},bt.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},bt.use=function(L){return k.H.use(L)},bt.useActionState=function(L,$,K){return k.H.useActionState(L,$,K)},bt.useCallback=function(L,$){return k.H.useCallback(L,$)},bt.useContext=function(L){return k.H.useContext(L)},bt.useDebugValue=function(){},bt.useDeferredValue=function(L,$){return k.H.useDeferredValue(L,$)},bt.useEffect=function(L,$){return k.H.useEffect(L,$)},bt.useEffectEvent=function(L){return k.H.useEffectEvent(L)},bt.useId=function(){return k.H.useId()},bt.useImperativeHandle=function(L,$,K){return k.H.useImperativeHandle(L,$,K)},bt.useInsertionEffect=function(L,$){return k.H.useInsertionEffect(L,$)},bt.useLayoutEffect=function(L,$){return k.H.useLayoutEffect(L,$)},bt.useMemo=function(L,$){return k.H.useMemo(L,$)},bt.useOptimistic=function(L,$){return k.H.useOptimistic(L,$)},bt.useReducer=function(L,$,K){return k.H.useReducer(L,$,K)},bt.useRef=function(L){return k.H.useRef(L)},bt.useState=function(L){return k.H.useState(L)},bt.useSyncExternalStore=function(L,$,K){return k.H.useSyncExternalStore(L,$,K)},bt.useTransition=function(){return k.H.useTransition()},bt.version="19.2.0",bt}var Bv;function ha(){return Bv||(Bv=1,zd.exports=jA()),zd.exports}var Hd={exports:{}},ke={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iv;function UA(){if(Iv)return ke;Iv=1;var l=ha();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},n=Symbol.for("react.portal");function a(d,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:g==null?null:""+g,children:d,containerInfo:f,implementation:p}}var o=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return ke.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ke.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(d,f,null,p)},ke.flushSync=function(d){var f=o.T,p=i.p;try{if(o.T=null,i.p=2,d)return d()}finally{o.T=f,i.p=p,i.d.f()}},ke.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},ke.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},ke.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:b}):p==="script"&&i.d.X(d,{crossOrigin:g,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},ke.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},ke.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin);i.d.L(d,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},ke.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},ke.requestFormReset=function(d){i.d.r(d)},ke.unstable_batchedUpdates=function(d,f){return d(f)},ke.useFormState=function(d,f,p){return o.H.useFormState(d,f,p)},ke.useFormStatus=function(){return o.H.useHostTransitionStatus()},ke.version="19.2.0",ke}var jv;function f0(){if(jv)return Hd.exports;jv=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),Hd.exports=UA(),Hd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uv;function FA(){if(Uv)return ho;Uv=1;var l=IA(),t=ha(),e=f0();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)r+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var r=s,c=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(c=r.return),s=r.return;while(s)}return r.tag===3?c:null}function o(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function u(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(a(s)!==s)throw Error(i(188))}function f(s){var r=s.alternate;if(!r){if(r=a(s),r===null)throw Error(i(188));return r!==s?null:s}for(var c=s,h=r;;){var m=c.return;if(m===null)break;var y=m.alternate;if(y===null){if(h=m.return,h!==null){c=h;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===c)return d(m),s;if(y===h)return d(m),r;y=y.sibling}throw Error(i(188))}if(c.return!==h.return)c=m,h=y;else{for(var S=!1,T=m.child;T;){if(T===c){S=!0,c=m,h=y;break}if(T===h){S=!0,h=m,c=y;break}T=T.sibling}if(!S){for(T=y.child;T;){if(T===c){S=!0,c=y,h=m;break}if(T===h){S=!0,h=y,c=m;break}T=T.sibling}if(!S)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?s:r}function p(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=p(s),r!==null)return r;s=s.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function et(s){return s===null||typeof s!="object"?null:(s=W&&s[W]||s["@@iterator"],typeof s=="function"?s:null)}var mt=Symbol.for("react.client.reference");function ft(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===mt?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case _:return"Fragment";case E:return"Profiler";case A:return"StrictMode";case D:return"Suspense";case M:return"SuspenseList";case H:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case C:return s.displayName||"Context";case R:return(s._context.displayName||"Context")+".Consumer";case x:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case k:return r=s.displayName||null,r!==null?r:ft(s.type)||"Memo";case I:r=s._payload,s=s._init;try{return ft(s(r))}catch{}}return null}var yt=Array.isArray,N=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},vt=[],Ct=-1;function L(s){return{current:s}}function $(s){0>Ct||(s.current=vt[Ct],vt[Ct]=null,Ct--)}function K(s,r){Ct++,vt[Ct]=s.current,s.current=r}var J=L(null),at=L(null),ot=L(null),lt=L(null);function Xt(s,r){switch(K(ot,r),K(at,s),K(J,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?Jy(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=Jy(r),s=Zy(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}$(J),K(J,s)}function Pt(){$(J),$(at),$(ot)}function Oi(s){s.memoizedState!==null&&K(lt,s);var r=J.current,c=Zy(r,s.type);r!==c&&(K(at,s),K(J,c))}function gi(s){at.current===s&&($(J),$(at)),lt.current===s&&($(lt),ao._currentValue=Q)}var Ne,hn;function Mi(s){if(Ne===void 0)try{throw Error()}catch(c){var r=c.stack.trim().match(/\n( *(at )?)/);Ne=r&&r[1]||"",hn=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ne+s+hn}var Qn=!1;function ma(s,r){if(!s||Qn)return"";Qn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(r){var Y=function(){throw Error()};if(Object.defineProperty(Y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Y,[])}catch(z){var F=z}Reflect.construct(s,[],Y)}else{try{Y.call()}catch(z){F=z}s.call(Y.prototype)}}else{try{throw Error()}catch(z){F=z}(Y=s())&&typeof Y.catch=="function"&&Y.catch(function(){})}}catch(z){if(z&&F&&typeof z.stack=="string")return[z.stack,F.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=h.DetermineComponentFrameRoot(),S=y[0],T=y[1];if(S&&T){var O=S.split(`
`),U=T.split(`
`);for(m=h=0;h<O.length&&!O[h].includes("DetermineComponentFrameRoot");)h++;for(;m<U.length&&!U[m].includes("DetermineComponentFrameRoot");)m++;if(h===O.length||m===U.length)for(h=O.length-1,m=U.length-1;1<=h&&0<=m&&O[h]!==U[m];)m--;for(;1<=h&&0<=m;h--,m--)if(O[h]!==U[m]){if(h!==1||m!==1)do if(h--,m--,0>m||O[h]!==U[m]){var V=`
`+O[h].replace(" at new "," at ");return s.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",s.displayName)),V}while(1<=h&&0<=m);break}}}finally{Qn=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Mi(c):""}function Au(s,r){switch(s.tag){case 26:case 27:case 5:return Mi(s.type);case 16:return Mi("Lazy");case 13:return s.child!==r&&r!==null?Mi("Suspense Fallback"):Mi("Suspense");case 19:return Mi("SuspenseList");case 0:case 15:return ma(s.type,!1);case 11:return ma(s.type.render,!1);case 1:return ma(s.type,!0);case 31:return Mi("Activity");default:return""}}function Zo(s){try{var r="",c=null;do r+=Au(s,c),c=s,s=s.return;while(s);return r}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Rs=Object.prototype.hasOwnProperty,xs=l.unstable_scheduleCallback,Jn=l.unstable_cancelCallback,tl=l.unstable_shouldYield,zt=l.unstable_requestPaint,It=l.unstable_now,Qe=l.unstable_getCurrentPriorityLevel,ya=l.unstable_ImmediatePriority,kp=l.unstable_UserBlockingPriority,el=l.unstable_NormalPriority,gw=l.unstable_LowPriority,Dp=l.unstable_IdlePriority,mw=l.log,yw=l.unstable_setDisableYieldValue,va=null,Je=null;function Os(s){if(typeof mw=="function"&&yw(s),Je&&typeof Je.setStrictMode=="function")try{Je.setStrictMode(va,s)}catch{}}var Ze=Math.clz32?Math.clz32:_w,vw=Math.log,bw=Math.LN2;function _w(s){return s>>>=0,s===0?32:31-(vw(s)/bw|0)|0}var il=256,sl=262144,nl=4194304;function dn(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function rl(s,r,c){var h=s.pendingLanes;if(h===0)return 0;var m=0,y=s.suspendedLanes,S=s.pingedLanes;s=s.warmLanes;var T=h&134217727;return T!==0?(h=T&~y,h!==0?m=dn(h):(S&=T,S!==0?m=dn(S):c||(c=T&~s,c!==0&&(m=dn(c))))):(T=h&~y,T!==0?m=dn(T):S!==0?m=dn(S):c||(c=h&~s,c!==0&&(m=dn(c)))),m===0?0:r!==0&&r!==m&&(r&y)===0&&(y=m&-m,c=r&-r,y>=c||y===32&&(c&4194048)!==0)?r:m}function ba(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function ww(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lp(){var s=nl;return nl<<=1,(nl&62914560)===0&&(nl=4194304),s}function Eu(s){for(var r=[],c=0;31>c;c++)r.push(s);return r}function _a(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Sw(s,r,c,h,m,y){var S=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var T=s.entanglements,O=s.expirationTimes,U=s.hiddenUpdates;for(c=S&~c;0<c;){var V=31-Ze(c),Y=1<<V;T[V]=0,O[V]=-1;var F=U[V];if(F!==null)for(U[V]=null,V=0;V<F.length;V++){var z=F[V];z!==null&&(z.lane&=-536870913)}c&=~Y}h!==0&&Pp(s,h,0),y!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=y&~(S&~r))}function Pp(s,r,c){s.pendingLanes|=r,s.suspendedLanes&=~r;var h=31-Ze(r);s.entangledLanes|=r,s.entanglements[h]=s.entanglements[h]|1073741824|c&261930}function Np(s,r){var c=s.entangledLanes|=r;for(s=s.entanglements;c;){var h=31-Ze(c),m=1<<h;m&r|s[h]&r&&(s[h]|=r),c&=~m}}function Bp(s,r){var c=r&-r;return c=(c&42)!==0?1:Tu(c),(c&(s.suspendedLanes|r))!==0?0:c}function Tu(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Cu(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ip(){var s=q.p;return s!==0?s:(s=window.event,s===void 0?32:Sv(s.type))}function jp(s,r){var c=q.p;try{return q.p=s,r()}finally{q.p=c}}var Ms=Math.random().toString(36).slice(2),Ee="__reactFiber$"+Ms,Ue="__reactProps$"+Ms,Zn="__reactContainer$"+Ms,Ru="__reactEvents$"+Ms,Aw="__reactListeners$"+Ms,Ew="__reactHandles$"+Ms,Up="__reactResources$"+Ms,wa="__reactMarker$"+Ms;function xu(s){delete s[Ee],delete s[Ue],delete s[Ru],delete s[Aw],delete s[Ew]}function tr(s){var r=s[Ee];if(r)return r;for(var c=s.parentNode;c;){if(r=c[Zn]||c[Ee]){if(c=r.alternate,r.child!==null||c!==null&&c.child!==null)for(s=av(s);s!==null;){if(c=s[Ee])return c;s=av(s)}return r}s=c,c=s.parentNode}return null}function er(s){if(s=s[Ee]||s[Zn]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Sa(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function ir(s){var r=s[Up];return r||(r=s[Up]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function be(s){s[wa]=!0}var Fp=new Set,zp={};function fn(s,r){sr(s,r),sr(s+"Capture",r)}function sr(s,r){for(zp[s]=r,s=0;s<r.length;s++)Fp.add(r[s])}var Tw=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Hp={},$p={};function Cw(s){return Rs.call($p,s)?!0:Rs.call(Hp,s)?!1:Tw.test(s)?$p[s]=!0:(Hp[s]=!0,!1)}function al(s,r,c){if(Cw(r))if(c===null)s.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var h=r.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+c)}}function ol(s,r,c){if(c===null)s.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+c)}}function ts(s,r,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(r,c,""+h)}}function mi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function qp(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Rw(s,r,c){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var m=h.get,y=h.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return m.call(this)},set:function(S){c=""+S,y.call(this,S)}}),Object.defineProperty(s,r,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Ou(s){if(!s._valueTracker){var r=qp(s)?"checked":"value";s._valueTracker=Rw(s,r,""+s[r])}}function Vp(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var c=r.getValue(),h="";return s&&(h=qp(s)?s.checked?"true":"false":s.value),s=h,s!==c?(r.setValue(s),!0):!1}function ll(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var xw=/[\n"\\]/g;function yi(s){return s.replace(xw,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Mu(s,r,c,h,m,y,S,T){s.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.type=S:s.removeAttribute("type"),r!=null?S==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+mi(r)):s.value!==""+mi(r)&&(s.value=""+mi(r)):S!=="submit"&&S!=="reset"||s.removeAttribute("value"),r!=null?ku(s,S,mi(r)):c!=null?ku(s,S,mi(c)):h!=null&&s.removeAttribute("value"),m==null&&y!=null&&(s.defaultChecked=!!y),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.name=""+mi(T):s.removeAttribute("name")}function Gp(s,r,c,h,m,y,S,T){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),r!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||r!=null)){Ou(s);return}c=c!=null?""+mi(c):"",r=r!=null?""+mi(r):c,T||r===s.value||(s.value=r),s.defaultValue=r}h=h??m,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=T?s.checked:!!h,s.defaultChecked=!!h,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(s.name=S),Ou(s)}function ku(s,r,c){r==="number"&&ll(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function nr(s,r,c,h){if(s=s.options,r){r={};for(var m=0;m<c.length;m++)r["$"+c[m]]=!0;for(c=0;c<s.length;c++)m=r.hasOwnProperty("$"+s[c].value),s[c].selected!==m&&(s[c].selected=m),m&&h&&(s[c].defaultSelected=!0)}else{for(c=""+mi(c),r=null,m=0;m<s.length;m++){if(s[m].value===c){s[m].selected=!0,h&&(s[m].defaultSelected=!0);return}r!==null||s[m].disabled||(r=s[m])}r!==null&&(r.selected=!0)}}function Yp(s,r,c){if(r!=null&&(r=""+mi(r),r!==s.value&&(s.value=r),c==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=c!=null?""+mi(c):""}function Xp(s,r,c,h){if(r==null){if(h!=null){if(c!=null)throw Error(i(92));if(yt(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),r=c}c=mi(r),s.defaultValue=c,h=s.textContent,h===c&&h!==""&&h!==null&&(s.value=h),Ou(s)}function rr(s,r){if(r){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=r;return}}s.textContent=r}var Ow=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Kp(s,r,c){var h=r.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":h?s.setProperty(r,c):typeof c!="number"||c===0||Ow.has(r)?r==="float"?s.cssFloat=c:s[r]=(""+c).trim():s[r]=c+"px"}function Wp(s,r,c){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||r!=null&&r.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var m in r)h=r[m],r.hasOwnProperty(m)&&c[m]!==h&&Kp(s,m,h)}else for(var y in r)r.hasOwnProperty(y)&&Kp(s,y,r[y])}function Du(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cl(s){return kw.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function es(){}var Lu=null;function Pu(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ar=null,or=null;function Qp(s){var r=er(s);if(r&&(s=r.stateNode)){var c=s[Ue]||null;t:switch(s=r.stateNode,r.type){case"input":if(Mu(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),r=c.name,c.type==="radio"&&r!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+yi(""+r)+'"][type="radio"]'),r=0;r<c.length;r++){var h=c[r];if(h!==s&&h.form===s.form){var m=h[Ue]||null;if(!m)throw Error(i(90));Mu(h,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<c.length;r++)h=c[r],h.form===s.form&&Vp(h)}break t;case"textarea":Yp(s,c.value,c.defaultValue);break t;case"select":r=c.value,r!=null&&nr(s,!!c.multiple,r,!1)}}}var Nu=!1;function Jp(s,r,c){if(Nu)return s(r,c);Nu=!0;try{var h=s(r);return h}finally{if(Nu=!1,(ar!==null||or!==null)&&(Wl(),ar&&(r=ar,s=or,or=ar=null,Qp(r),s)))for(r=0;r<s.length;r++)Qp(s[r])}}function Aa(s,r){var c=s.stateNode;if(c===null)return null;var h=c[Ue]||null;if(h===null)return null;c=h[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break t;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(i(231,r,typeof c));return c}var is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bu=!1;if(is)try{var Ea={};Object.defineProperty(Ea,"passive",{get:function(){Bu=!0}}),window.addEventListener("test",Ea,Ea),window.removeEventListener("test",Ea,Ea)}catch{Bu=!1}var ks=null,Iu=null,ul=null;function Zp(){if(ul)return ul;var s,r=Iu,c=r.length,h,m="value"in ks?ks.value:ks.textContent,y=m.length;for(s=0;s<c&&r[s]===m[s];s++);var S=c-s;for(h=1;h<=S&&r[c-h]===m[y-h];h++);return ul=m.slice(s,1<h?1-h:void 0)}function hl(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function dl(){return!0}function tg(){return!1}function Fe(s){function r(c,h,m,y,S){this._reactName=c,this._targetInst=m,this.type=h,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var T in s)s.hasOwnProperty(T)&&(c=s[T],this[T]=c?c(y):y[T]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?dl:tg,this.isPropagationStopped=tg,this}return g(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=dl)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=dl)},persist:function(){},isPersistent:dl}),r}var pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fl=Fe(pn),Ta=g({},pn,{view:0,detail:0}),Dw=Fe(Ta),ju,Uu,Ca,pl=g({},Ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zu,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ca&&(Ca&&s.type==="mousemove"?(ju=s.screenX-Ca.screenX,Uu=s.screenY-Ca.screenY):Uu=ju=0,Ca=s),ju)},movementY:function(s){return"movementY"in s?s.movementY:Uu}}),eg=Fe(pl),Lw=g({},pl,{dataTransfer:0}),Pw=Fe(Lw),Nw=g({},Ta,{relatedTarget:0}),Fu=Fe(Nw),Bw=g({},pn,{animationName:0,elapsedTime:0,pseudoElement:0}),Iw=Fe(Bw),jw=g({},pn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Uw=Fe(jw),Fw=g({},pn,{data:0}),ig=Fe(Fw),zw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$w={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qw(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=$w[s])?!!r[s]:!1}function zu(){return qw}var Vw=g({},Ta,{key:function(s){if(s.key){var r=zw[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=hl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Hw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zu,charCode:function(s){return s.type==="keypress"?hl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?hl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Gw=Fe(Vw),Yw=g({},pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sg=Fe(Yw),Xw=g({},Ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zu}),Kw=Fe(Xw),Ww=g({},pn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qw=Fe(Ww),Jw=g({},pl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zw=Fe(Jw),tS=g({},pn,{newState:0,oldState:0}),eS=Fe(tS),iS=[9,13,27,32],Hu=is&&"CompositionEvent"in window,Ra=null;is&&"documentMode"in document&&(Ra=document.documentMode);var sS=is&&"TextEvent"in window&&!Ra,ng=is&&(!Hu||Ra&&8<Ra&&11>=Ra),rg=" ",ag=!1;function og(s,r){switch(s){case"keyup":return iS.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var lr=!1;function nS(s,r){switch(s){case"compositionend":return lg(r);case"keypress":return r.which!==32?null:(ag=!0,rg);case"textInput":return s=r.data,s===rg&&ag?null:s;default:return null}}function rS(s,r){if(lr)return s==="compositionend"||!Hu&&og(s,r)?(s=Zp(),ul=Iu=ks=null,lr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ng&&r.locale!=="ko"?null:r.data;default:return null}}var aS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cg(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!aS[s.type]:r==="textarea"}function ug(s,r,c,h){ar?or?or.push(h):or=[h]:ar=h,r=sc(r,"onChange"),0<r.length&&(c=new fl("onChange","change",null,c,h),s.push({event:c,listeners:r}))}var xa=null,Oa=null;function oS(s){Gy(s,0)}function gl(s){var r=Sa(s);if(Vp(r))return s}function hg(s,r){if(s==="change")return r}var dg=!1;if(is){var $u;if(is){var qu="oninput"in document;if(!qu){var fg=document.createElement("div");fg.setAttribute("oninput","return;"),qu=typeof fg.oninput=="function"}$u=qu}else $u=!1;dg=$u&&(!document.documentMode||9<document.documentMode)}function pg(){xa&&(xa.detachEvent("onpropertychange",gg),Oa=xa=null)}function gg(s){if(s.propertyName==="value"&&gl(Oa)){var r=[];ug(r,Oa,s,Pu(s)),Jp(oS,r)}}function lS(s,r,c){s==="focusin"?(pg(),xa=r,Oa=c,xa.attachEvent("onpropertychange",gg)):s==="focusout"&&pg()}function cS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return gl(Oa)}function uS(s,r){if(s==="click")return gl(r)}function hS(s,r){if(s==="input"||s==="change")return gl(r)}function dS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var ti=typeof Object.is=="function"?Object.is:dS;function Ma(s,r){if(ti(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var c=Object.keys(s),h=Object.keys(r);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var m=c[h];if(!Rs.call(r,m)||!ti(s[m],r[m]))return!1}return!0}function mg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function yg(s,r){var c=mg(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=r&&h>=r)return{node:c,offset:r-s};s=h}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=mg(c)}}function vg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?vg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function bg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=ll(s.document);r instanceof s.HTMLIFrameElement;){try{var c=typeof r.contentWindow.location.href=="string"}catch{c=!1}if(c)s=r.contentWindow;else break;r=ll(s.document)}return r}function Vu(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var fS=is&&"documentMode"in document&&11>=document.documentMode,cr=null,Gu=null,ka=null,Yu=!1;function _g(s,r,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Yu||cr==null||cr!==ll(h)||(h=cr,"selectionStart"in h&&Vu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ka&&Ma(ka,h)||(ka=h,h=sc(Gu,"onSelect"),0<h.length&&(r=new fl("onSelect","select",null,r,c),s.push({event:r,listeners:h}),r.target=cr)))}function gn(s,r){var c={};return c[s.toLowerCase()]=r.toLowerCase(),c["Webkit"+s]="webkit"+r,c["Moz"+s]="moz"+r,c}var ur={animationend:gn("Animation","AnimationEnd"),animationiteration:gn("Animation","AnimationIteration"),animationstart:gn("Animation","AnimationStart"),transitionrun:gn("Transition","TransitionRun"),transitionstart:gn("Transition","TransitionStart"),transitioncancel:gn("Transition","TransitionCancel"),transitionend:gn("Transition","TransitionEnd")},Xu={},wg={};is&&(wg=document.createElement("div").style,"AnimationEvent"in window||(delete ur.animationend.animation,delete ur.animationiteration.animation,delete ur.animationstart.animation),"TransitionEvent"in window||delete ur.transitionend.transition);function mn(s){if(Xu[s])return Xu[s];if(!ur[s])return s;var r=ur[s],c;for(c in r)if(r.hasOwnProperty(c)&&c in wg)return Xu[s]=r[c];return s}var Sg=mn("animationend"),Ag=mn("animationiteration"),Eg=mn("animationstart"),pS=mn("transitionrun"),gS=mn("transitionstart"),mS=mn("transitioncancel"),Tg=mn("transitionend"),Cg=new Map,Ku="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ku.push("scrollEnd");function ki(s,r){Cg.set(s,r),fn(r,[s])}var ml=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},vi=[],hr=0,Wu=0;function yl(){for(var s=hr,r=Wu=hr=0;r<s;){var c=vi[r];vi[r++]=null;var h=vi[r];vi[r++]=null;var m=vi[r];vi[r++]=null;var y=vi[r];if(vi[r++]=null,h!==null&&m!==null){var S=h.pending;S===null?m.next=m:(m.next=S.next,S.next=m),h.pending=m}y!==0&&Rg(c,m,y)}}function vl(s,r,c,h){vi[hr++]=s,vi[hr++]=r,vi[hr++]=c,vi[hr++]=h,Wu|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Qu(s,r,c,h){return vl(s,r,c,h),bl(s)}function yn(s,r){return vl(s,null,null,r),bl(s)}function Rg(s,r,c){s.lanes|=c;var h=s.alternate;h!==null&&(h.lanes|=c);for(var m=!1,y=s.return;y!==null;)y.childLanes|=c,h=y.alternate,h!==null&&(h.childLanes|=c),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(m=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,m&&r!==null&&(m=31-Ze(c),s=y.hiddenUpdates,h=s[m],h===null?s[m]=[r]:h.push(r),r.lane=c|536870912),y):null}function bl(s){if(50<Za)throw Za=0,ad=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var dr={};function yS(s,r,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(s,r,c,h){return new yS(s,r,c,h)}function Ju(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ss(s,r){var c=s.alternate;return c===null?(c=ei(s.tag,r,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=r,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,r=s.dependencies,c.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function xg(s,r){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,r=c.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function _l(s,r,c,h,m,y){var S=0;if(h=s,typeof s=="function")Ju(s)&&(S=1);else if(typeof s=="string")S=SA(s,c,J.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case H:return s=ei(31,c,r,m),s.elementType=H,s.lanes=y,s;case _:return vn(c.children,m,y,r);case A:S=8,m|=24;break;case E:return s=ei(12,c,r,m|2),s.elementType=E,s.lanes=y,s;case D:return s=ei(13,c,r,m),s.elementType=D,s.lanes=y,s;case M:return s=ei(19,c,r,m),s.elementType=M,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case C:S=10;break t;case R:S=9;break t;case x:S=11;break t;case k:S=14;break t;case I:S=16,h=null;break t}S=29,c=Error(i(130,s===null?"null":typeof s,"")),h=null}return r=ei(S,c,r,m),r.elementType=s,r.type=h,r.lanes=y,r}function vn(s,r,c,h){return s=ei(7,s,h,r),s.lanes=c,s}function Zu(s,r,c){return s=ei(6,s,null,r),s.lanes=c,s}function Og(s){var r=ei(18,null,null,0);return r.stateNode=s,r}function th(s,r,c){return r=ei(4,s.children!==null?s.children:[],s.key,r),r.lanes=c,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Mg=new WeakMap;function bi(s,r){if(typeof s=="object"&&s!==null){var c=Mg.get(s);return c!==void 0?c:(r={value:s,source:r,stack:Zo(r)},Mg.set(s,r),r)}return{value:s,source:r,stack:Zo(r)}}var fr=[],pr=0,wl=null,Da=0,_i=[],wi=0,Ds=null,Fi=1,zi="";function ns(s,r){fr[pr++]=Da,fr[pr++]=wl,wl=s,Da=r}function kg(s,r,c){_i[wi++]=Fi,_i[wi++]=zi,_i[wi++]=Ds,Ds=s;var h=Fi;s=zi;var m=32-Ze(h)-1;h&=~(1<<m),c+=1;var y=32-Ze(r)+m;if(30<y){var S=m-m%5;y=(h&(1<<S)-1).toString(32),h>>=S,m-=S,Fi=1<<32-Ze(r)+m|c<<m|h,zi=y+s}else Fi=1<<y|c<<m|h,zi=s}function eh(s){s.return!==null&&(ns(s,1),kg(s,1,0))}function ih(s){for(;s===wl;)wl=fr[--pr],fr[pr]=null,Da=fr[--pr],fr[pr]=null;for(;s===Ds;)Ds=_i[--wi],_i[wi]=null,zi=_i[--wi],_i[wi]=null,Fi=_i[--wi],_i[wi]=null}function Dg(s,r){_i[wi++]=Fi,_i[wi++]=zi,_i[wi++]=Ds,Fi=r.id,zi=r.overflow,Ds=s}var Te=null,Wt=null,Dt=!1,Ls=null,Si=!1,sh=Error(i(519));function Ps(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw La(bi(r,s)),sh}function Lg(s){var r=s.stateNode,c=s.type,h=s.memoizedProps;switch(r[Ee]=s,r[Ue]=h,c){case"dialog":xt("cancel",r),xt("close",r);break;case"iframe":case"object":case"embed":xt("load",r);break;case"video":case"audio":for(c=0;c<eo.length;c++)xt(eo[c],r);break;case"source":xt("error",r);break;case"img":case"image":case"link":xt("error",r),xt("load",r);break;case"details":xt("toggle",r);break;case"input":xt("invalid",r),Gp(r,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":xt("invalid",r);break;case"textarea":xt("invalid",r),Xp(r,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||r.textContent===""+c||h.suppressHydrationWarning===!0||Wy(r.textContent,c)?(h.popover!=null&&(xt("beforetoggle",r),xt("toggle",r)),h.onScroll!=null&&xt("scroll",r),h.onScrollEnd!=null&&xt("scrollend",r),h.onClick!=null&&(r.onclick=es),r=!0):r=!1,r||Ps(s,!0)}function Pg(s){for(Te=s.return;Te;)switch(Te.tag){case 5:case 31:case 13:Si=!1;return;case 27:case 3:Si=!0;return;default:Te=Te.return}}function gr(s){if(s!==Te)return!1;if(!Dt)return Pg(s),Dt=!0,!1;var r=s.tag,c;if((c=r!==3&&r!==27)&&((c=r===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||wd(s.type,s.memoizedProps)),c=!c),c&&Wt&&Ps(s),Pg(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Wt=rv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Wt=rv(s)}else r===27?(r=Wt,Xs(s.type)?(s=Cd,Cd=null,Wt=s):Wt=r):Wt=Te?Ei(s.stateNode.nextSibling):null;return!0}function bn(){Wt=Te=null,Dt=!1}function nh(){var s=Ls;return s!==null&&(qe===null?qe=s:qe.push.apply(qe,s),Ls=null),s}function La(s){Ls===null?Ls=[s]:Ls.push(s)}var rh=L(null),_n=null,rs=null;function Ns(s,r,c){K(rh,r._currentValue),r._currentValue=c}function as(s){s._currentValue=rh.current,$(rh)}function ah(s,r,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,h!==null&&(h.childLanes|=r)):h!==null&&(h.childLanes&r)!==r&&(h.childLanes|=r),s===c)break;s=s.return}}function oh(s,r,c,h){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var y=m.dependencies;if(y!==null){var S=m.child;y=y.firstContext;t:for(;y!==null;){var T=y;y=m;for(var O=0;O<r.length;O++)if(T.context===r[O]){y.lanes|=c,T=y.alternate,T!==null&&(T.lanes|=c),ah(y.return,c,s),h||(S=null);break t}y=T.next}}else if(m.tag===18){if(S=m.return,S===null)throw Error(i(341));S.lanes|=c,y=S.alternate,y!==null&&(y.lanes|=c),ah(S,c,s),S=null}else S=m.child;if(S!==null)S.return=m;else for(S=m;S!==null;){if(S===s){S=null;break}if(m=S.sibling,m!==null){m.return=S.return,S=m;break}S=S.return}m=S}}function mr(s,r,c,h){s=null;for(var m=r,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var S=m.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var T=m.type;ti(m.pendingProps.value,S.value)||(s!==null?s.push(T):s=[T])}}else if(m===lt.current){if(S=m.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(ao):s=[ao])}m=m.return}s!==null&&oh(r,s,c,h),r.flags|=262144}function Sl(s){for(s=s.firstContext;s!==null;){if(!ti(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function wn(s){_n=s,rs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ce(s){return Ng(_n,s)}function Al(s,r){return _n===null&&wn(s),Ng(s,r)}function Ng(s,r){var c=r._currentValue;if(r={context:r,memoizedValue:c,next:null},rs===null){if(s===null)throw Error(i(308));rs=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else rs=rs.next=r;return c}var vS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(c,h){s.push(h)}};this.abort=function(){r.aborted=!0,s.forEach(function(c){return c()})}},bS=l.unstable_scheduleCallback,_S=l.unstable_NormalPriority,he={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lh(){return{controller:new vS,data:new Map,refCount:0}}function Pa(s){s.refCount--,s.refCount===0&&bS(_S,function(){s.controller.abort()})}var Na=null,ch=0,yr=0,vr=null;function wS(s,r){if(Na===null){var c=Na=[];ch=0,yr=dd(),vr={status:"pending",value:void 0,then:function(h){c.push(h)}}}return ch++,r.then(Bg,Bg),r}function Bg(){if(--ch===0&&Na!==null){vr!==null&&(vr.status="fulfilled");var s=Na;Na=null,yr=0,vr=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function SS(s,r){var c=[],h={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return s.then(function(){h.status="fulfilled",h.value=r;for(var m=0;m<c.length;m++)(0,c[m])(r)},function(m){for(h.status="rejected",h.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),h}var Ig=N.S;N.S=function(s,r){_y=It(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&wS(s,r),Ig!==null&&Ig(s,r)};var Sn=L(null);function uh(){var s=Sn.current;return s!==null?s:Gt.pooledCache}function El(s,r){r===null?K(Sn,Sn.current):K(Sn,r.pool)}function jg(){var s=uh();return s===null?null:{parent:he._currentValue,pool:s}}var br=Error(i(460)),hh=Error(i(474)),Tl=Error(i(542)),Cl={then:function(){}};function Ug(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Fg(s,r,c){switch(c=s[c],c===void 0?s.push(r):c!==r&&(r.then(es,es),r=c),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Hg(s),s;default:if(typeof r.status=="string")r.then(es,es);else{if(s=Gt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(h){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=h}},function(h){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=h}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Hg(s),s}throw En=r,br}}function An(s){try{var r=s._init;return r(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(En=c,br):c}}var En=null;function zg(){if(En===null)throw Error(i(459));var s=En;return En=null,s}function Hg(s){if(s===br||s===Tl)throw Error(i(483))}var _r=null,Ba=0;function Rl(s){var r=Ba;return Ba+=1,_r===null&&(_r=[]),Fg(_r,s,r)}function Ia(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function xl(s,r){throw r.$$typeof===v?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function $g(s){function r(B,P){if(s){var j=B.deletions;j===null?(B.deletions=[P],B.flags|=16):j.push(P)}}function c(B,P){if(!s)return null;for(;P!==null;)r(B,P),P=P.sibling;return null}function h(B){for(var P=new Map;B!==null;)B.key!==null?P.set(B.key,B):P.set(B.index,B),B=B.sibling;return P}function m(B,P){return B=ss(B,P),B.index=0,B.sibling=null,B}function y(B,P,j){return B.index=j,s?(j=B.alternate,j!==null?(j=j.index,j<P?(B.flags|=67108866,P):j):(B.flags|=67108866,P)):(B.flags|=1048576,P)}function S(B){return s&&B.alternate===null&&(B.flags|=67108866),B}function T(B,P,j,G){return P===null||P.tag!==6?(P=Zu(j,B.mode,G),P.return=B,P):(P=m(P,j),P.return=B,P)}function O(B,P,j,G){var ct=j.type;return ct===_?V(B,P,j.props.children,G,j.key):P!==null&&(P.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===I&&An(ct)===P.type)?(P=m(P,j.props),Ia(P,j),P.return=B,P):(P=_l(j.type,j.key,j.props,null,B.mode,G),Ia(P,j),P.return=B,P)}function U(B,P,j,G){return P===null||P.tag!==4||P.stateNode.containerInfo!==j.containerInfo||P.stateNode.implementation!==j.implementation?(P=th(j,B.mode,G),P.return=B,P):(P=m(P,j.children||[]),P.return=B,P)}function V(B,P,j,G,ct){return P===null||P.tag!==7?(P=vn(j,B.mode,G,ct),P.return=B,P):(P=m(P,j),P.return=B,P)}function Y(B,P,j){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return P=Zu(""+P,B.mode,j),P.return=B,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case b:return j=_l(P.type,P.key,P.props,null,B.mode,j),Ia(j,P),j.return=B,j;case w:return P=th(P,B.mode,j),P.return=B,P;case I:return P=An(P),Y(B,P,j)}if(yt(P)||et(P))return P=vn(P,B.mode,j,null),P.return=B,P;if(typeof P.then=="function")return Y(B,Rl(P),j);if(P.$$typeof===C)return Y(B,Al(B,P),j);xl(B,P)}return null}function F(B,P,j,G){var ct=P!==null?P.key:null;if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return ct!==null?null:T(B,P,""+j,G);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case b:return j.key===ct?O(B,P,j,G):null;case w:return j.key===ct?U(B,P,j,G):null;case I:return j=An(j),F(B,P,j,G)}if(yt(j)||et(j))return ct!==null?null:V(B,P,j,G,null);if(typeof j.then=="function")return F(B,P,Rl(j),G);if(j.$$typeof===C)return F(B,P,Al(B,j),G);xl(B,j)}return null}function z(B,P,j,G,ct){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return B=B.get(j)||null,T(P,B,""+G,ct);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case b:return B=B.get(G.key===null?j:G.key)||null,O(P,B,G,ct);case w:return B=B.get(G.key===null?j:G.key)||null,U(P,B,G,ct);case I:return G=An(G),z(B,P,j,G,ct)}if(yt(G)||et(G))return B=B.get(j)||null,V(P,B,G,ct,null);if(typeof G.then=="function")return z(B,P,j,Rl(G),ct);if(G.$$typeof===C)return z(B,P,j,Al(P,G),ct);xl(P,G)}return null}function it(B,P,j,G){for(var ct=null,Nt=null,nt=P,Et=P=0,Mt=null;nt!==null&&Et<j.length;Et++){nt.index>Et?(Mt=nt,nt=null):Mt=nt.sibling;var Bt=F(B,nt,j[Et],G);if(Bt===null){nt===null&&(nt=Mt);break}s&&nt&&Bt.alternate===null&&r(B,nt),P=y(Bt,P,Et),Nt===null?ct=Bt:Nt.sibling=Bt,Nt=Bt,nt=Mt}if(Et===j.length)return c(B,nt),Dt&&ns(B,Et),ct;if(nt===null){for(;Et<j.length;Et++)nt=Y(B,j[Et],G),nt!==null&&(P=y(nt,P,Et),Nt===null?ct=nt:Nt.sibling=nt,Nt=nt);return Dt&&ns(B,Et),ct}for(nt=h(nt);Et<j.length;Et++)Mt=z(nt,B,Et,j[Et],G),Mt!==null&&(s&&Mt.alternate!==null&&nt.delete(Mt.key===null?Et:Mt.key),P=y(Mt,P,Et),Nt===null?ct=Mt:Nt.sibling=Mt,Nt=Mt);return s&&nt.forEach(function(Zs){return r(B,Zs)}),Dt&&ns(B,Et),ct}function pt(B,P,j,G){if(j==null)throw Error(i(151));for(var ct=null,Nt=null,nt=P,Et=P=0,Mt=null,Bt=j.next();nt!==null&&!Bt.done;Et++,Bt=j.next()){nt.index>Et?(Mt=nt,nt=null):Mt=nt.sibling;var Zs=F(B,nt,Bt.value,G);if(Zs===null){nt===null&&(nt=Mt);break}s&&nt&&Zs.alternate===null&&r(B,nt),P=y(Zs,P,Et),Nt===null?ct=Zs:Nt.sibling=Zs,Nt=Zs,nt=Mt}if(Bt.done)return c(B,nt),Dt&&ns(B,Et),ct;if(nt===null){for(;!Bt.done;Et++,Bt=j.next())Bt=Y(B,Bt.value,G),Bt!==null&&(P=y(Bt,P,Et),Nt===null?ct=Bt:Nt.sibling=Bt,Nt=Bt);return Dt&&ns(B,Et),ct}for(nt=h(nt);!Bt.done;Et++,Bt=j.next())Bt=z(nt,B,Et,Bt.value,G),Bt!==null&&(s&&Bt.alternate!==null&&nt.delete(Bt.key===null?Et:Bt.key),P=y(Bt,P,Et),Nt===null?ct=Bt:Nt.sibling=Bt,Nt=Bt);return s&&nt.forEach(function(LA){return r(B,LA)}),Dt&&ns(B,Et),ct}function qt(B,P,j,G){if(typeof j=="object"&&j!==null&&j.type===_&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case b:t:{for(var ct=j.key;P!==null;){if(P.key===ct){if(ct=j.type,ct===_){if(P.tag===7){c(B,P.sibling),G=m(P,j.props.children),G.return=B,B=G;break t}}else if(P.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===I&&An(ct)===P.type){c(B,P.sibling),G=m(P,j.props),Ia(G,j),G.return=B,B=G;break t}c(B,P);break}else r(B,P);P=P.sibling}j.type===_?(G=vn(j.props.children,B.mode,G,j.key),G.return=B,B=G):(G=_l(j.type,j.key,j.props,null,B.mode,G),Ia(G,j),G.return=B,B=G)}return S(B);case w:t:{for(ct=j.key;P!==null;){if(P.key===ct)if(P.tag===4&&P.stateNode.containerInfo===j.containerInfo&&P.stateNode.implementation===j.implementation){c(B,P.sibling),G=m(P,j.children||[]),G.return=B,B=G;break t}else{c(B,P);break}else r(B,P);P=P.sibling}G=th(j,B.mode,G),G.return=B,B=G}return S(B);case I:return j=An(j),qt(B,P,j,G)}if(yt(j))return it(B,P,j,G);if(et(j)){if(ct=et(j),typeof ct!="function")throw Error(i(150));return j=ct.call(j),pt(B,P,j,G)}if(typeof j.then=="function")return qt(B,P,Rl(j),G);if(j.$$typeof===C)return qt(B,P,Al(B,j),G);xl(B,j)}return typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint"?(j=""+j,P!==null&&P.tag===6?(c(B,P.sibling),G=m(P,j),G.return=B,B=G):(c(B,P),G=Zu(j,B.mode,G),G.return=B,B=G),S(B)):c(B,P)}return function(B,P,j,G){try{Ba=0;var ct=qt(B,P,j,G);return _r=null,ct}catch(nt){if(nt===br||nt===Tl)throw nt;var Nt=ei(29,nt,null,B.mode);return Nt.lanes=G,Nt.return=B,Nt}finally{}}}var Tn=$g(!0),qg=$g(!1),Bs=!1;function dh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fh(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Is(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function js(s,r,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(jt&2)!==0){var m=h.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),h.pending=r,r=bl(s),Rg(s,null,c),r}return vl(s,h,r,c),bl(s)}function ja(s,r,c){if(r=r.updateQueue,r!==null&&(r=r.shared,(c&4194048)!==0)){var h=r.lanes;h&=s.pendingLanes,c|=h,r.lanes=c,Np(s,c)}}function ph(s,r){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var m=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var S={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?m=y=S:y=y.next=S,c=c.next}while(c!==null);y===null?m=y=r:y=y.next=r}else m=y=r;c={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:h.shared,callbacks:h.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=r:s.next=r,c.lastBaseUpdate=r}var gh=!1;function Ua(){if(gh){var s=vr;if(s!==null)throw s}}function Fa(s,r,c,h){gh=!1;var m=s.updateQueue;Bs=!1;var y=m.firstBaseUpdate,S=m.lastBaseUpdate,T=m.shared.pending;if(T!==null){m.shared.pending=null;var O=T,U=O.next;O.next=null,S===null?y=U:S.next=U,S=O;var V=s.alternate;V!==null&&(V=V.updateQueue,T=V.lastBaseUpdate,T!==S&&(T===null?V.firstBaseUpdate=U:T.next=U,V.lastBaseUpdate=O))}if(y!==null){var Y=m.baseState;S=0,V=U=O=null,T=y;do{var F=T.lane&-536870913,z=F!==T.lane;if(z?(Ot&F)===F:(h&F)===F){F!==0&&F===yr&&(gh=!0),V!==null&&(V=V.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});t:{var it=s,pt=T;F=r;var qt=c;switch(pt.tag){case 1:if(it=pt.payload,typeof it=="function"){Y=it.call(qt,Y,F);break t}Y=it;break t;case 3:it.flags=it.flags&-65537|128;case 0:if(it=pt.payload,F=typeof it=="function"?it.call(qt,Y,F):it,F==null)break t;Y=g({},Y,F);break t;case 2:Bs=!0}}F=T.callback,F!==null&&(s.flags|=64,z&&(s.flags|=8192),z=m.callbacks,z===null?m.callbacks=[F]:z.push(F))}else z={lane:F,tag:T.tag,payload:T.payload,callback:T.callback,next:null},V===null?(U=V=z,O=Y):V=V.next=z,S|=F;if(T=T.next,T===null){if(T=m.shared.pending,T===null)break;z=T,T=z.next,z.next=null,m.lastBaseUpdate=z,m.shared.pending=null}}while(!0);V===null&&(O=Y),m.baseState=O,m.firstBaseUpdate=U,m.lastBaseUpdate=V,y===null&&(m.shared.lanes=0),$s|=S,s.lanes=S,s.memoizedState=Y}}function Vg(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function Gg(s,r){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Vg(c[s],r)}var wr=L(null),Ol=L(0);function Yg(s,r){s=gs,K(Ol,s),K(wr,r),gs=s|r.baseLanes}function mh(){K(Ol,gs),K(wr,wr.current)}function yh(){gs=Ol.current,$(wr),$(Ol)}var ii=L(null),Ai=null;function Us(s){var r=s.alternate;K(oe,oe.current&1),K(ii,s),Ai===null&&(r===null||wr.current!==null||r.memoizedState!==null)&&(Ai=s)}function vh(s){K(oe,oe.current),K(ii,s),Ai===null&&(Ai=s)}function Xg(s){s.tag===22?(K(oe,oe.current),K(ii,s),Ai===null&&(Ai=s)):Fs()}function Fs(){K(oe,oe.current),K(ii,ii.current)}function si(s){$(ii),Ai===s&&(Ai=null),$(oe)}var oe=L(0);function Ml(s){for(var r=s;r!==null;){if(r.tag===13){var c=r.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Ed(c)||Td(c)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var os=0,At=null,Ht=null,de=null,kl=!1,Sr=!1,Cn=!1,Dl=0,za=0,Ar=null,AS=0;function re(){throw Error(i(321))}function bh(s,r){if(r===null)return!1;for(var c=0;c<r.length&&c<s.length;c++)if(!ti(s[c],r[c]))return!1;return!0}function _h(s,r,c,h,m,y){return os=y,At=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,N.H=s===null||s.memoizedState===null?km:Nh,Cn=!1,y=c(h,m),Cn=!1,Sr&&(y=Wg(r,c,h,m)),Kg(s),y}function Kg(s){N.H=qa;var r=Ht!==null&&Ht.next!==null;if(os=0,de=Ht=At=null,kl=!1,za=0,Ar=null,r)throw Error(i(300));s===null||fe||(s=s.dependencies,s!==null&&Sl(s)&&(fe=!0))}function Wg(s,r,c,h){At=s;var m=0;do{if(Sr&&(Ar=null),za=0,Sr=!1,25<=m)throw Error(i(301));if(m+=1,de=Ht=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}N.H=Dm,y=r(c,h)}while(Sr);return y}function ES(){var s=N.H,r=s.useState()[0];return r=typeof r.then=="function"?Ha(r):r,s=s.useState()[0],(Ht!==null?Ht.memoizedState:null)!==s&&(At.flags|=1024),r}function wh(){var s=Dl!==0;return Dl=0,s}function Sh(s,r,c){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~c}function Ah(s){if(kl){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}kl=!1}os=0,de=Ht=At=null,Sr=!1,za=Dl=0,Ar=null}function Be(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return de===null?At.memoizedState=de=s:de=de.next=s,de}function le(){if(Ht===null){var s=At.alternate;s=s!==null?s.memoizedState:null}else s=Ht.next;var r=de===null?At.memoizedState:de.next;if(r!==null)de=r,Ht=s;else{if(s===null)throw At.alternate===null?Error(i(467)):Error(i(310));Ht=s,s={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},de===null?At.memoizedState=de=s:de=de.next=s}return de}function Ll(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ha(s){var r=za;return za+=1,Ar===null&&(Ar=[]),s=Fg(Ar,s,r),r=At,(de===null?r.memoizedState:de.next)===null&&(r=r.alternate,N.H=r===null||r.memoizedState===null?km:Nh),s}function Pl(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ha(s);if(s.$$typeof===C)return Ce(s)}throw Error(i(438,String(s)))}function Eh(s){var r=null,c=At.updateQueue;if(c!==null&&(r=c.memoCache),r==null){var h=At.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(r={data:h.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),c===null&&(c=Ll(),At.updateQueue=c),c.memoCache=r,c=r.data[r.index],c===void 0)for(c=r.data[r.index]=Array(s),h=0;h<s;h++)c[h]=X;return r.index++,c}function ls(s,r){return typeof r=="function"?r(s):r}function Nl(s){var r=le();return Th(r,Ht,s)}function Th(s,r,c){var h=s.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var m=s.baseQueue,y=h.pending;if(y!==null){if(m!==null){var S=m.next;m.next=y.next,y.next=S}r.baseQueue=m=y,h.pending=null}if(y=s.baseState,m===null)s.memoizedState=y;else{r=m.next;var T=S=null,O=null,U=r,V=!1;do{var Y=U.lane&-536870913;if(Y!==U.lane?(Ot&Y)===Y:(os&Y)===Y){var F=U.revertLane;if(F===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),Y===yr&&(V=!0);else if((os&F)===F){U=U.next,F===yr&&(V=!0);continue}else Y={lane:0,revertLane:U.revertLane,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},O===null?(T=O=Y,S=y):O=O.next=Y,At.lanes|=F,$s|=F;Y=U.action,Cn&&c(y,Y),y=U.hasEagerState?U.eagerState:c(y,Y)}else F={lane:Y,revertLane:U.revertLane,gesture:U.gesture,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},O===null?(T=O=F,S=y):O=O.next=F,At.lanes|=Y,$s|=Y;U=U.next}while(U!==null&&U!==r);if(O===null?S=y:O.next=T,!ti(y,s.memoizedState)&&(fe=!0,V&&(c=vr,c!==null)))throw c;s.memoizedState=y,s.baseState=S,s.baseQueue=O,h.lastRenderedState=y}return m===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function Ch(s){var r=le(),c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=s;var h=c.dispatch,m=c.pending,y=r.memoizedState;if(m!==null){c.pending=null;var S=m=m.next;do y=s(y,S.action),S=S.next;while(S!==m);ti(y,r.memoizedState)||(fe=!0),r.memoizedState=y,r.baseQueue===null&&(r.baseState=y),c.lastRenderedState=y}return[y,h]}function Qg(s,r,c){var h=At,m=le(),y=Dt;if(y){if(c===void 0)throw Error(i(407));c=c()}else c=r();var S=!ti((Ht||m).memoizedState,c);if(S&&(m.memoizedState=c,fe=!0),m=m.queue,Oh(tm.bind(null,h,m,s),[s]),m.getSnapshot!==r||S||de!==null&&de.memoizedState.tag&1){if(h.flags|=2048,Er(9,{destroy:void 0},Zg.bind(null,h,m,c,r),null),Gt===null)throw Error(i(349));y||(os&127)!==0||Jg(h,r,c)}return c}function Jg(s,r,c){s.flags|=16384,s={getSnapshot:r,value:c},r=At.updateQueue,r===null?(r=Ll(),At.updateQueue=r,r.stores=[s]):(c=r.stores,c===null?r.stores=[s]:c.push(s))}function Zg(s,r,c,h){r.value=c,r.getSnapshot=h,em(r)&&im(s)}function tm(s,r,c){return c(function(){em(r)&&im(s)})}function em(s){var r=s.getSnapshot;s=s.value;try{var c=r();return!ti(s,c)}catch{return!0}}function im(s){var r=yn(s,2);r!==null&&Ve(r,s,2)}function Rh(s){var r=Be();if(typeof s=="function"){var c=s;if(s=c(),Cn){Os(!0);try{c()}finally{Os(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:s},r}function sm(s,r,c,h){return s.baseState=c,Th(s,Ht,typeof h=="function"?h:ls)}function TS(s,r,c,h,m){if(jl(s))throw Error(i(485));if(s=r.action,s!==null){var y={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};N.T!==null?c(!0):y.isTransition=!1,h(y),c=r.pending,c===null?(y.next=r.pending=y,nm(r,y)):(y.next=c.next,r.pending=c.next=y)}}function nm(s,r){var c=r.action,h=r.payload,m=s.state;if(r.isTransition){var y=N.T,S={};N.T=S;try{var T=c(m,h),O=N.S;O!==null&&O(S,T),rm(s,r,T)}catch(U){xh(s,r,U)}finally{y!==null&&S.types!==null&&(y.types=S.types),N.T=y}}else try{y=c(m,h),rm(s,r,y)}catch(U){xh(s,r,U)}}function rm(s,r,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){am(s,r,h)},function(h){return xh(s,r,h)}):am(s,r,c)}function am(s,r,c){r.status="fulfilled",r.value=c,om(r),s.state=c,r=s.pending,r!==null&&(c=r.next,c===r?s.pending=null:(c=c.next,r.next=c,nm(s,c)))}function xh(s,r,c){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do r.status="rejected",r.reason=c,om(r),r=r.next;while(r!==h)}s.action=null}function om(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function lm(s,r){return r}function cm(s,r){if(Dt){var c=Gt.formState;if(c!==null){t:{var h=At;if(Dt){if(Wt){e:{for(var m=Wt,y=Si;m.nodeType!==8;){if(!y){m=null;break e}if(m=Ei(m.nextSibling),m===null){m=null;break e}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){Wt=Ei(m.nextSibling),h=m.data==="F!";break t}}Ps(h)}h=!1}h&&(r=c[0])}}return c=Be(),c.memoizedState=c.baseState=r,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lm,lastRenderedState:r},c.queue=h,c=xm.bind(null,At,h),h.dispatch=c,h=Rh(!1),y=Ph.bind(null,At,!1,h.queue),h=Be(),m={state:r,dispatch:null,action:s,pending:null},h.queue=m,c=TS.bind(null,At,m,y,c),m.dispatch=c,h.memoizedState=s,[r,c,!1]}function um(s){var r=le();return hm(r,Ht,s)}function hm(s,r,c){if(r=Th(s,r,lm)[0],s=Nl(ls)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var h=Ha(r)}catch(S){throw S===br?Tl:S}else h=r;r=le();var m=r.queue,y=m.dispatch;return c!==r.memoizedState&&(At.flags|=2048,Er(9,{destroy:void 0},CS.bind(null,m,c),null)),[h,y,s]}function CS(s,r){s.action=r}function dm(s){var r=le(),c=Ht;if(c!==null)return hm(r,c,s);le(),r=r.memoizedState,c=le();var h=c.queue.dispatch;return c.memoizedState=s,[r,h,!1]}function Er(s,r,c,h){return s={tag:s,create:c,deps:h,inst:r,next:null},r=At.updateQueue,r===null&&(r=Ll(),At.updateQueue=r),c=r.lastEffect,c===null?r.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,r.lastEffect=s),s}function fm(){return le().memoizedState}function Bl(s,r,c,h){var m=Be();At.flags|=s,m.memoizedState=Er(1|r,{destroy:void 0},c,h===void 0?null:h)}function Il(s,r,c,h){var m=le();h=h===void 0?null:h;var y=m.memoizedState.inst;Ht!==null&&h!==null&&bh(h,Ht.memoizedState.deps)?m.memoizedState=Er(r,y,c,h):(At.flags|=s,m.memoizedState=Er(1|r,y,c,h))}function pm(s,r){Bl(8390656,8,s,r)}function Oh(s,r){Il(2048,8,s,r)}function RS(s){At.flags|=4;var r=At.updateQueue;if(r===null)r=Ll(),At.updateQueue=r,r.events=[s];else{var c=r.events;c===null?r.events=[s]:c.push(s)}}function gm(s){var r=le().memoizedState;return RS({ref:r,nextImpl:s}),function(){if((jt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function mm(s,r){return Il(4,2,s,r)}function ym(s,r){return Il(4,4,s,r)}function vm(s,r){if(typeof r=="function"){s=s();var c=r(s);return function(){typeof c=="function"?c():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function bm(s,r,c){c=c!=null?c.concat([s]):null,Il(4,4,vm.bind(null,r,s),c)}function Mh(){}function _m(s,r){var c=le();r=r===void 0?null:r;var h=c.memoizedState;return r!==null&&bh(r,h[1])?h[0]:(c.memoizedState=[s,r],s)}function wm(s,r){var c=le();r=r===void 0?null:r;var h=c.memoizedState;if(r!==null&&bh(r,h[1]))return h[0];if(h=s(),Cn){Os(!0);try{s()}finally{Os(!1)}}return c.memoizedState=[h,r],h}function kh(s,r,c){return c===void 0||(os&1073741824)!==0&&(Ot&261930)===0?s.memoizedState=r:(s.memoizedState=c,s=Sy(),At.lanes|=s,$s|=s,c)}function Sm(s,r,c,h){return ti(c,r)?c:wr.current!==null?(s=kh(s,c,h),ti(s,r)||(fe=!0),s):(os&42)===0||(os&1073741824)!==0&&(Ot&261930)===0?(fe=!0,s.memoizedState=c):(s=Sy(),At.lanes|=s,$s|=s,r)}function Am(s,r,c,h,m){var y=q.p;q.p=y!==0&&8>y?y:8;var S=N.T,T={};N.T=T,Ph(s,!1,r,c);try{var O=m(),U=N.S;if(U!==null&&U(T,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var V=SS(O,h);$a(s,r,V,ai(s))}else $a(s,r,h,ai(s))}catch(Y){$a(s,r,{then:function(){},status:"rejected",reason:Y},ai())}finally{q.p=y,S!==null&&T.types!==null&&(S.types=T.types),N.T=S}}function xS(){}function Dh(s,r,c,h){if(s.tag!==5)throw Error(i(476));var m=Em(s).queue;Am(s,m,r,Q,c===null?xS:function(){return Tm(s),c(h)})}function Em(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:Q},next:null};var c={};return r.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:c},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Tm(s){var r=Em(s);r.next===null&&(r=s.alternate.memoizedState),$a(s,r.next.queue,{},ai())}function Lh(){return Ce(ao)}function Cm(){return le().memoizedState}function Rm(){return le().memoizedState}function OS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var c=ai();s=Is(c);var h=js(r,s,c);h!==null&&(Ve(h,r,c),ja(h,r,c)),r={cache:lh()},s.payload=r;return}r=r.return}}function MS(s,r,c){var h=ai();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},jl(s)?Om(r,c):(c=Qu(s,r,c,h),c!==null&&(Ve(c,s,h),Mm(c,r,h)))}function xm(s,r,c){var h=ai();$a(s,r,c,h)}function $a(s,r,c,h){var m={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(jl(s))Om(r,m);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=r.lastRenderedReducer,y!==null))try{var S=r.lastRenderedState,T=y(S,c);if(m.hasEagerState=!0,m.eagerState=T,ti(T,S))return vl(s,r,m,0),Gt===null&&yl(),!1}catch{}finally{}if(c=Qu(s,r,m,h),c!==null)return Ve(c,s,h),Mm(c,r,h),!0}return!1}function Ph(s,r,c,h){if(h={lane:2,revertLane:dd(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},jl(s)){if(r)throw Error(i(479))}else r=Qu(s,c,h,2),r!==null&&Ve(r,s,2)}function jl(s){var r=s.alternate;return s===At||r!==null&&r===At}function Om(s,r){Sr=kl=!0;var c=s.pending;c===null?r.next=r:(r.next=c.next,c.next=r),s.pending=r}function Mm(s,r,c){if((c&4194048)!==0){var h=r.lanes;h&=s.pendingLanes,c|=h,r.lanes=c,Np(s,c)}}var qa={readContext:Ce,use:Pl,useCallback:re,useContext:re,useEffect:re,useImperativeHandle:re,useLayoutEffect:re,useInsertionEffect:re,useMemo:re,useReducer:re,useRef:re,useState:re,useDebugValue:re,useDeferredValue:re,useTransition:re,useSyncExternalStore:re,useId:re,useHostTransitionStatus:re,useFormState:re,useActionState:re,useOptimistic:re,useMemoCache:re,useCacheRefresh:re};qa.useEffectEvent=re;var km={readContext:Ce,use:Pl,useCallback:function(s,r){return Be().memoizedState=[s,r===void 0?null:r],s},useContext:Ce,useEffect:pm,useImperativeHandle:function(s,r,c){c=c!=null?c.concat([s]):null,Bl(4194308,4,vm.bind(null,r,s),c)},useLayoutEffect:function(s,r){return Bl(4194308,4,s,r)},useInsertionEffect:function(s,r){Bl(4,2,s,r)},useMemo:function(s,r){var c=Be();r=r===void 0?null:r;var h=s();if(Cn){Os(!0);try{s()}finally{Os(!1)}}return c.memoizedState=[h,r],h},useReducer:function(s,r,c){var h=Be();if(c!==void 0){var m=c(r);if(Cn){Os(!0);try{c(r)}finally{Os(!1)}}}else m=r;return h.memoizedState=h.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},h.queue=s,s=s.dispatch=MS.bind(null,At,s),[h.memoizedState,s]},useRef:function(s){var r=Be();return s={current:s},r.memoizedState=s},useState:function(s){s=Rh(s);var r=s.queue,c=xm.bind(null,At,r);return r.dispatch=c,[s.memoizedState,c]},useDebugValue:Mh,useDeferredValue:function(s,r){var c=Be();return kh(c,s,r)},useTransition:function(){var s=Rh(!1);return s=Am.bind(null,At,s.queue,!0,!1),Be().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,c){var h=At,m=Be();if(Dt){if(c===void 0)throw Error(i(407));c=c()}else{if(c=r(),Gt===null)throw Error(i(349));(Ot&127)!==0||Jg(h,r,c)}m.memoizedState=c;var y={value:c,getSnapshot:r};return m.queue=y,pm(tm.bind(null,h,y,s),[s]),h.flags|=2048,Er(9,{destroy:void 0},Zg.bind(null,h,y,c,r),null),c},useId:function(){var s=Be(),r=Gt.identifierPrefix;if(Dt){var c=zi,h=Fi;c=(h&~(1<<32-Ze(h)-1)).toString(32)+c,r="_"+r+"R_"+c,c=Dl++,0<c&&(r+="H"+c.toString(32)),r+="_"}else c=AS++,r="_"+r+"r_"+c.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Lh,useFormState:cm,useActionState:cm,useOptimistic:function(s){var r=Be();r.memoizedState=r.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=c,r=Ph.bind(null,At,!0,c),c.dispatch=r,[s,r]},useMemoCache:Eh,useCacheRefresh:function(){return Be().memoizedState=OS.bind(null,At)},useEffectEvent:function(s){var r=Be(),c={impl:s};return r.memoizedState=c,function(){if((jt&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},Nh={readContext:Ce,use:Pl,useCallback:_m,useContext:Ce,useEffect:Oh,useImperativeHandle:bm,useInsertionEffect:mm,useLayoutEffect:ym,useMemo:wm,useReducer:Nl,useRef:fm,useState:function(){return Nl(ls)},useDebugValue:Mh,useDeferredValue:function(s,r){var c=le();return Sm(c,Ht.memoizedState,s,r)},useTransition:function(){var s=Nl(ls)[0],r=le().memoizedState;return[typeof s=="boolean"?s:Ha(s),r]},useSyncExternalStore:Qg,useId:Cm,useHostTransitionStatus:Lh,useFormState:um,useActionState:um,useOptimistic:function(s,r){var c=le();return sm(c,Ht,s,r)},useMemoCache:Eh,useCacheRefresh:Rm};Nh.useEffectEvent=gm;var Dm={readContext:Ce,use:Pl,useCallback:_m,useContext:Ce,useEffect:Oh,useImperativeHandle:bm,useInsertionEffect:mm,useLayoutEffect:ym,useMemo:wm,useReducer:Ch,useRef:fm,useState:function(){return Ch(ls)},useDebugValue:Mh,useDeferredValue:function(s,r){var c=le();return Ht===null?kh(c,s,r):Sm(c,Ht.memoizedState,s,r)},useTransition:function(){var s=Ch(ls)[0],r=le().memoizedState;return[typeof s=="boolean"?s:Ha(s),r]},useSyncExternalStore:Qg,useId:Cm,useHostTransitionStatus:Lh,useFormState:dm,useActionState:dm,useOptimistic:function(s,r){var c=le();return Ht!==null?sm(c,Ht,s,r):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:Eh,useCacheRefresh:Rm};Dm.useEffectEvent=gm;function Bh(s,r,c,h){r=s.memoizedState,c=c(h,r),c=c==null?r:g({},r,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Ih={enqueueSetState:function(s,r,c){s=s._reactInternals;var h=ai(),m=Is(h);m.payload=r,c!=null&&(m.callback=c),r=js(s,m,h),r!==null&&(Ve(r,s,h),ja(r,s,h))},enqueueReplaceState:function(s,r,c){s=s._reactInternals;var h=ai(),m=Is(h);m.tag=1,m.payload=r,c!=null&&(m.callback=c),r=js(s,m,h),r!==null&&(Ve(r,s,h),ja(r,s,h))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var c=ai(),h=Is(c);h.tag=2,r!=null&&(h.callback=r),r=js(s,h,c),r!==null&&(Ve(r,s,c),ja(r,s,c))}};function Lm(s,r,c,h,m,y,S){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,y,S):r.prototype&&r.prototype.isPureReactComponent?!Ma(c,h)||!Ma(m,y):!0}function Pm(s,r,c,h){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(c,h),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(c,h),r.state!==s&&Ih.enqueueReplaceState(r,r.state,null)}function Rn(s,r){var c=r;if("ref"in r){c={};for(var h in r)h!=="ref"&&(c[h]=r[h])}if(s=s.defaultProps){c===r&&(c=g({},c));for(var m in s)c[m]===void 0&&(c[m]=s[m])}return c}function Nm(s){ml(s)}function Bm(s){console.error(s)}function Im(s){ml(s)}function Ul(s,r){try{var c=s.onUncaughtError;c(r.value,{componentStack:r.stack})}catch(h){setTimeout(function(){throw h})}}function jm(s,r,c){try{var h=s.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function jh(s,r,c){return c=Is(c),c.tag=3,c.payload={element:null},c.callback=function(){Ul(s,r)},c}function Um(s){return s=Is(s),s.tag=3,s}function Fm(s,r,c,h){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var y=h.value;s.payload=function(){return m(y)},s.callback=function(){jm(r,c,h)}}var S=c.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(s.callback=function(){jm(r,c,h),typeof m!="function"&&(qs===null?qs=new Set([this]):qs.add(this));var T=h.stack;this.componentDidCatch(h.value,{componentStack:T!==null?T:""})})}function kS(s,r,c,h,m){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(r=c.alternate,r!==null&&mr(r,c,m,!0),c=ii.current,c!==null){switch(c.tag){case 31:case 13:return Ai===null?Ql():c.alternate===null&&ae===0&&(ae=3),c.flags&=-257,c.flags|=65536,c.lanes=m,h===Cl?c.flags|=16384:(r=c.updateQueue,r===null?c.updateQueue=new Set([h]):r.add(h),cd(s,h,m)),!1;case 22:return c.flags|=65536,h===Cl?c.flags|=16384:(r=c.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=r):(c=r.retryQueue,c===null?r.retryQueue=new Set([h]):c.add(h)),cd(s,h,m)),!1}throw Error(i(435,c.tag))}return cd(s,h,m),Ql(),!1}if(Dt)return r=ii.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,h!==sh&&(s=Error(i(422),{cause:h}),La(bi(s,c)))):(h!==sh&&(r=Error(i(423),{cause:h}),La(bi(r,c))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,h=bi(h,c),m=jh(s.stateNode,h,m),ph(s,m),ae!==4&&(ae=2)),!1;var y=Error(i(520),{cause:h});if(y=bi(y,c),Ja===null?Ja=[y]:Ja.push(y),ae!==4&&(ae=2),r===null)return!0;h=bi(h,c),c=r;do{switch(c.tag){case 3:return c.flags|=65536,s=m&-m,c.lanes|=s,s=jh(c.stateNode,h,s),ph(c,s),!1;case 1:if(r=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(qs===null||!qs.has(y))))return c.flags|=65536,m&=-m,c.lanes|=m,m=Um(m),Fm(m,s,c,h),ph(c,m),!1}c=c.return}while(c!==null);return!1}var Uh=Error(i(461)),fe=!1;function Re(s,r,c,h){r.child=s===null?qg(r,null,c,h):Tn(r,s.child,c,h)}function zm(s,r,c,h,m){c=c.render;var y=r.ref;if("ref"in h){var S={};for(var T in h)T!=="ref"&&(S[T]=h[T])}else S=h;return wn(r),h=_h(s,r,c,S,y,m),T=wh(),s!==null&&!fe?(Sh(s,r,m),cs(s,r,m)):(Dt&&T&&eh(r),r.flags|=1,Re(s,r,h,m),r.child)}function Hm(s,r,c,h,m){if(s===null){var y=c.type;return typeof y=="function"&&!Ju(y)&&y.defaultProps===void 0&&c.compare===null?(r.tag=15,r.type=y,$m(s,r,y,h,m)):(s=_l(c.type,null,h,r,r.mode,m),s.ref=r.ref,s.return=r,r.child=s)}if(y=s.child,!Yh(s,m)){var S=y.memoizedProps;if(c=c.compare,c=c!==null?c:Ma,c(S,h)&&s.ref===r.ref)return cs(s,r,m)}return r.flags|=1,s=ss(y,h),s.ref=r.ref,s.return=r,r.child=s}function $m(s,r,c,h,m){if(s!==null){var y=s.memoizedProps;if(Ma(y,h)&&s.ref===r.ref)if(fe=!1,r.pendingProps=h=y,Yh(s,m))(s.flags&131072)!==0&&(fe=!0);else return r.lanes=s.lanes,cs(s,r,m)}return Fh(s,r,c,h,m)}function qm(s,r,c,h){var m=h.children,y=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((r.flags&128)!==0){if(y=y!==null?y.baseLanes|c:c,s!==null){for(h=r.child=s.child,m=0;h!==null;)m=m|h.lanes|h.childLanes,h=h.sibling;h=m&~y}else h=0,r.child=null;return Vm(s,r,y,c,h)}if((c&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&El(r,y!==null?y.cachePool:null),y!==null?Yg(r,y):mh(),Xg(r);else return h=r.lanes=536870912,Vm(s,r,y!==null?y.baseLanes|c:c,c,h)}else y!==null?(El(r,y.cachePool),Yg(r,y),Fs(),r.memoizedState=null):(s!==null&&El(r,null),mh(),Fs());return Re(s,r,m,c),r.child}function Va(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Vm(s,r,c,h,m){var y=uh();return y=y===null?null:{parent:he._currentValue,pool:y},r.memoizedState={baseLanes:c,cachePool:y},s!==null&&El(r,null),mh(),Xg(r),s!==null&&mr(s,r,h,!0),r.childLanes=m,null}function Fl(s,r){return r=Hl({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function Gm(s,r,c){return Tn(r,s.child,null,c),s=Fl(r,r.pendingProps),s.flags|=2,si(r),r.memoizedState=null,s}function DS(s,r,c){var h=r.pendingProps,m=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(Dt){if(h.mode==="hidden")return s=Fl(r,h),r.lanes=536870912,Va(null,s);if(vh(r),(s=Wt)?(s=nv(s,Si),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ds!==null?{id:Fi,overflow:zi}:null,retryLane:536870912,hydrationErrors:null},c=Og(s),c.return=r,r.child=c,Te=r,Wt=null)):s=null,s===null)throw Ps(r);return r.lanes=536870912,null}return Fl(r,h)}var y=s.memoizedState;if(y!==null){var S=y.dehydrated;if(vh(r),m)if(r.flags&256)r.flags&=-257,r=Gm(s,r,c);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(fe||mr(s,r,c,!1),m=(c&s.childLanes)!==0,fe||m){if(h=Gt,h!==null&&(S=Bp(h,c),S!==0&&S!==y.retryLane))throw y.retryLane=S,yn(s,S),Ve(h,s,S),Uh;Ql(),r=Gm(s,r,c)}else s=y.treeContext,Wt=Ei(S.nextSibling),Te=r,Dt=!0,Ls=null,Si=!1,s!==null&&Dg(r,s),r=Fl(r,h),r.flags|=4096;return r}return s=ss(s.child,{mode:h.mode,children:h.children}),s.ref=r.ref,r.child=s,s.return=r,s}function zl(s,r){var c=r.ref;if(c===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(s===null||s.ref!==c)&&(r.flags|=4194816)}}function Fh(s,r,c,h,m){return wn(r),c=_h(s,r,c,h,void 0,m),h=wh(),s!==null&&!fe?(Sh(s,r,m),cs(s,r,m)):(Dt&&h&&eh(r),r.flags|=1,Re(s,r,c,m),r.child)}function Ym(s,r,c,h,m,y){return wn(r),r.updateQueue=null,c=Wg(r,h,c,m),Kg(s),h=wh(),s!==null&&!fe?(Sh(s,r,y),cs(s,r,y)):(Dt&&h&&eh(r),r.flags|=1,Re(s,r,c,y),r.child)}function Xm(s,r,c,h,m){if(wn(r),r.stateNode===null){var y=dr,S=c.contextType;typeof S=="object"&&S!==null&&(y=Ce(S)),y=new c(h,y),r.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ih,r.stateNode=y,y._reactInternals=r,y=r.stateNode,y.props=h,y.state=r.memoizedState,y.refs={},dh(r),S=c.contextType,y.context=typeof S=="object"&&S!==null?Ce(S):dr,y.state=r.memoizedState,S=c.getDerivedStateFromProps,typeof S=="function"&&(Bh(r,c,S,h),y.state=r.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&Ih.enqueueReplaceState(y,y.state,null),Fa(r,h,y,m),Ua(),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308),h=!0}else if(s===null){y=r.stateNode;var T=r.memoizedProps,O=Rn(c,T);y.props=O;var U=y.context,V=c.contextType;S=dr,typeof V=="object"&&V!==null&&(S=Ce(V));var Y=c.getDerivedStateFromProps;V=typeof Y=="function"||typeof y.getSnapshotBeforeUpdate=="function",T=r.pendingProps!==T,V||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T||U!==S)&&Pm(r,y,h,S),Bs=!1;var F=r.memoizedState;y.state=F,Fa(r,h,y,m),Ua(),U=r.memoizedState,T||F!==U||Bs?(typeof Y=="function"&&(Bh(r,c,Y,h),U=r.memoizedState),(O=Bs||Lm(r,c,O,h,F,U,S))?(V||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=h,r.memoizedState=U),y.props=h,y.state=U,y.context=S,h=O):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),h=!1)}else{y=r.stateNode,fh(s,r),S=r.memoizedProps,V=Rn(c,S),y.props=V,Y=r.pendingProps,F=y.context,U=c.contextType,O=dr,typeof U=="object"&&U!==null&&(O=Ce(U)),T=c.getDerivedStateFromProps,(U=typeof T=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==Y||F!==O)&&Pm(r,y,h,O),Bs=!1,F=r.memoizedState,y.state=F,Fa(r,h,y,m),Ua();var z=r.memoizedState;S!==Y||F!==z||Bs||s!==null&&s.dependencies!==null&&Sl(s.dependencies)?(typeof T=="function"&&(Bh(r,c,T,h),z=r.memoizedState),(V=Bs||Lm(r,c,V,h,F,z,O)||s!==null&&s.dependencies!==null&&Sl(s.dependencies))?(U||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(h,z,O),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(h,z,O)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===s.memoizedProps&&F===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===s.memoizedProps&&F===s.memoizedState||(r.flags|=1024),r.memoizedProps=h,r.memoizedState=z),y.props=h,y.state=z,y.context=O,h=V):(typeof y.componentDidUpdate!="function"||S===s.memoizedProps&&F===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===s.memoizedProps&&F===s.memoizedState||(r.flags|=1024),h=!1)}return y=h,zl(s,r),h=(r.flags&128)!==0,y||h?(y=r.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:y.render(),r.flags|=1,s!==null&&h?(r.child=Tn(r,s.child,null,m),r.child=Tn(r,null,c,m)):Re(s,r,c,m),r.memoizedState=y.state,s=r.child):s=cs(s,r,m),s}function Km(s,r,c,h){return bn(),r.flags|=256,Re(s,r,c,h),r.child}var zh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hh(s){return{baseLanes:s,cachePool:jg()}}function $h(s,r,c){return s=s!==null?s.childLanes&~c:0,r&&(s|=ri),s}function Wm(s,r,c){var h=r.pendingProps,m=!1,y=(r.flags&128)!==0,S;if((S=y)||(S=s!==null&&s.memoizedState===null?!1:(oe.current&2)!==0),S&&(m=!0,r.flags&=-129),S=(r.flags&32)!==0,r.flags&=-33,s===null){if(Dt){if(m?Us(r):Fs(),(s=Wt)?(s=nv(s,Si),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ds!==null?{id:Fi,overflow:zi}:null,retryLane:536870912,hydrationErrors:null},c=Og(s),c.return=r,r.child=c,Te=r,Wt=null)):s=null,s===null)throw Ps(r);return Td(s)?r.lanes=32:r.lanes=536870912,null}var T=h.children;return h=h.fallback,m?(Fs(),m=r.mode,T=Hl({mode:"hidden",children:T},m),h=vn(h,m,c,null),T.return=r,h.return=r,T.sibling=h,r.child=T,h=r.child,h.memoizedState=Hh(c),h.childLanes=$h(s,S,c),r.memoizedState=zh,Va(null,h)):(Us(r),qh(r,T))}var O=s.memoizedState;if(O!==null&&(T=O.dehydrated,T!==null)){if(y)r.flags&256?(Us(r),r.flags&=-257,r=Vh(s,r,c)):r.memoizedState!==null?(Fs(),r.child=s.child,r.flags|=128,r=null):(Fs(),T=h.fallback,m=r.mode,h=Hl({mode:"visible",children:h.children},m),T=vn(T,m,c,null),T.flags|=2,h.return=r,T.return=r,h.sibling=T,r.child=h,Tn(r,s.child,null,c),h=r.child,h.memoizedState=Hh(c),h.childLanes=$h(s,S,c),r.memoizedState=zh,r=Va(null,h));else if(Us(r),Td(T)){if(S=T.nextSibling&&T.nextSibling.dataset,S)var U=S.dgst;S=U,h=Error(i(419)),h.stack="",h.digest=S,La({value:h,source:null,stack:null}),r=Vh(s,r,c)}else if(fe||mr(s,r,c,!1),S=(c&s.childLanes)!==0,fe||S){if(S=Gt,S!==null&&(h=Bp(S,c),h!==0&&h!==O.retryLane))throw O.retryLane=h,yn(s,h),Ve(S,s,h),Uh;Ed(T)||Ql(),r=Vh(s,r,c)}else Ed(T)?(r.flags|=192,r.child=s.child,r=null):(s=O.treeContext,Wt=Ei(T.nextSibling),Te=r,Dt=!0,Ls=null,Si=!1,s!==null&&Dg(r,s),r=qh(r,h.children),r.flags|=4096);return r}return m?(Fs(),T=h.fallback,m=r.mode,O=s.child,U=O.sibling,h=ss(O,{mode:"hidden",children:h.children}),h.subtreeFlags=O.subtreeFlags&65011712,U!==null?T=ss(U,T):(T=vn(T,m,c,null),T.flags|=2),T.return=r,h.return=r,h.sibling=T,r.child=h,Va(null,h),h=r.child,T=s.child.memoizedState,T===null?T=Hh(c):(m=T.cachePool,m!==null?(O=he._currentValue,m=m.parent!==O?{parent:O,pool:O}:m):m=jg(),T={baseLanes:T.baseLanes|c,cachePool:m}),h.memoizedState=T,h.childLanes=$h(s,S,c),r.memoizedState=zh,Va(s.child,h)):(Us(r),c=s.child,s=c.sibling,c=ss(c,{mode:"visible",children:h.children}),c.return=r,c.sibling=null,s!==null&&(S=r.deletions,S===null?(r.deletions=[s],r.flags|=16):S.push(s)),r.child=c,r.memoizedState=null,c)}function qh(s,r){return r=Hl({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Hl(s,r){return s=ei(22,s,null,r),s.lanes=0,s}function Vh(s,r,c){return Tn(r,s.child,null,c),s=qh(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function Qm(s,r,c){s.lanes|=r;var h=s.alternate;h!==null&&(h.lanes|=r),ah(s.return,r,c)}function Gh(s,r,c,h,m,y){var S=s.memoizedState;S===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:m,treeForkCount:y}:(S.isBackwards=r,S.rendering=null,S.renderingStartTime=0,S.last=h,S.tail=c,S.tailMode=m,S.treeForkCount=y)}function Jm(s,r,c){var h=r.pendingProps,m=h.revealOrder,y=h.tail;h=h.children;var S=oe.current,T=(S&2)!==0;if(T?(S=S&1|2,r.flags|=128):S&=1,K(oe,S),Re(s,r,h,c),h=Dt?Da:0,!T&&s!==null&&(s.flags&128)!==0)t:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Qm(s,c,r);else if(s.tag===19)Qm(s,c,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break t;for(;s.sibling===null;){if(s.return===null||s.return===r)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(c=r.child,m=null;c!==null;)s=c.alternate,s!==null&&Ml(s)===null&&(m=c),c=c.sibling;c=m,c===null?(m=r.child,r.child=null):(m=c.sibling,c.sibling=null),Gh(r,!1,m,c,y,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,m=r.child,r.child=null;m!==null;){if(s=m.alternate,s!==null&&Ml(s)===null){r.child=m;break}s=m.sibling,m.sibling=c,c=m,m=s}Gh(r,!0,c,null,y,h);break;case"together":Gh(r,!1,null,null,void 0,h);break;default:r.memoizedState=null}return r.child}function cs(s,r,c){if(s!==null&&(r.dependencies=s.dependencies),$s|=r.lanes,(c&r.childLanes)===0)if(s!==null){if(mr(s,r,c,!1),(c&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,c=ss(s,s.pendingProps),r.child=c,c.return=r;s.sibling!==null;)s=s.sibling,c=c.sibling=ss(s,s.pendingProps),c.return=r;c.sibling=null}return r.child}function Yh(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&Sl(s)))}function LS(s,r,c){switch(r.tag){case 3:Xt(r,r.stateNode.containerInfo),Ns(r,he,s.memoizedState.cache),bn();break;case 27:case 5:Oi(r);break;case 4:Xt(r,r.stateNode.containerInfo);break;case 10:Ns(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,vh(r),null;break;case 13:var h=r.memoizedState;if(h!==null)return h.dehydrated!==null?(Us(r),r.flags|=128,null):(c&r.child.childLanes)!==0?Wm(s,r,c):(Us(r),s=cs(s,r,c),s!==null?s.sibling:null);Us(r);break;case 19:var m=(s.flags&128)!==0;if(h=(c&r.childLanes)!==0,h||(mr(s,r,c,!1),h=(c&r.childLanes)!==0),m){if(h)return Jm(s,r,c);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),K(oe,oe.current),h)break;return null;case 22:return r.lanes=0,qm(s,r,c,r.pendingProps);case 24:Ns(r,he,s.memoizedState.cache)}return cs(s,r,c)}function Zm(s,r,c){if(s!==null)if(s.memoizedProps!==r.pendingProps)fe=!0;else{if(!Yh(s,c)&&(r.flags&128)===0)return fe=!1,LS(s,r,c);fe=(s.flags&131072)!==0}else fe=!1,Dt&&(r.flags&1048576)!==0&&kg(r,Da,r.index);switch(r.lanes=0,r.tag){case 16:t:{var h=r.pendingProps;if(s=An(r.elementType),r.type=s,typeof s=="function")Ju(s)?(h=Rn(s,h),r.tag=1,r=Xm(null,r,s,h,c)):(r.tag=0,r=Fh(null,r,s,h,c));else{if(s!=null){var m=s.$$typeof;if(m===x){r.tag=11,r=zm(null,r,s,h,c);break t}else if(m===k){r.tag=14,r=Hm(null,r,s,h,c);break t}}throw r=ft(s)||s,Error(i(306,r,""))}}return r;case 0:return Fh(s,r,r.type,r.pendingProps,c);case 1:return h=r.type,m=Rn(h,r.pendingProps),Xm(s,r,h,m,c);case 3:t:{if(Xt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));h=r.pendingProps;var y=r.memoizedState;m=y.element,fh(s,r),Fa(r,h,null,c);var S=r.memoizedState;if(h=S.cache,Ns(r,he,h),h!==y.cache&&oh(r,[he],c,!0),Ua(),h=S.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:S.cache},r.updateQueue.baseState=y,r.memoizedState=y,r.flags&256){r=Km(s,r,h,c);break t}else if(h!==m){m=bi(Error(i(424)),r),La(m),r=Km(s,r,h,c);break t}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Wt=Ei(s.firstChild),Te=r,Dt=!0,Ls=null,Si=!0,c=qg(r,null,h,c),r.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(bn(),h===m){r=cs(s,r,c);break t}Re(s,r,h,c)}r=r.child}return r;case 26:return zl(s,r),s===null?(c=uv(r.type,null,r.pendingProps,null))?r.memoizedState=c:Dt||(c=r.type,s=r.pendingProps,h=nc(ot.current).createElement(c),h[Ee]=r,h[Ue]=s,xe(h,c,s),be(h),r.stateNode=h):r.memoizedState=uv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Oi(r),s===null&&Dt&&(h=r.stateNode=ov(r.type,r.pendingProps,ot.current),Te=r,Si=!0,m=Wt,Xs(r.type)?(Cd=m,Wt=Ei(h.firstChild)):Wt=m),Re(s,r,r.pendingProps.children,c),zl(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&Dt&&((m=h=Wt)&&(h=cA(h,r.type,r.pendingProps,Si),h!==null?(r.stateNode=h,Te=r,Wt=Ei(h.firstChild),Si=!1,m=!0):m=!1),m||Ps(r)),Oi(r),m=r.type,y=r.pendingProps,S=s!==null?s.memoizedProps:null,h=y.children,wd(m,y)?h=null:S!==null&&wd(m,S)&&(r.flags|=32),r.memoizedState!==null&&(m=_h(s,r,ES,null,null,c),ao._currentValue=m),zl(s,r),Re(s,r,h,c),r.child;case 6:return s===null&&Dt&&((s=c=Wt)&&(c=uA(c,r.pendingProps,Si),c!==null?(r.stateNode=c,Te=r,Wt=null,s=!0):s=!1),s||Ps(r)),null;case 13:return Wm(s,r,c);case 4:return Xt(r,r.stateNode.containerInfo),h=r.pendingProps,s===null?r.child=Tn(r,null,h,c):Re(s,r,h,c),r.child;case 11:return zm(s,r,r.type,r.pendingProps,c);case 7:return Re(s,r,r.pendingProps,c),r.child;case 8:return Re(s,r,r.pendingProps.children,c),r.child;case 12:return Re(s,r,r.pendingProps.children,c),r.child;case 10:return h=r.pendingProps,Ns(r,r.type,h.value),Re(s,r,h.children,c),r.child;case 9:return m=r.type._context,h=r.pendingProps.children,wn(r),m=Ce(m),h=h(m),r.flags|=1,Re(s,r,h,c),r.child;case 14:return Hm(s,r,r.type,r.pendingProps,c);case 15:return $m(s,r,r.type,r.pendingProps,c);case 19:return Jm(s,r,c);case 31:return DS(s,r,c);case 22:return qm(s,r,c,r.pendingProps);case 24:return wn(r),h=Ce(he),s===null?(m=uh(),m===null&&(m=Gt,y=lh(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=c),m=y),r.memoizedState={parent:h,cache:m},dh(r),Ns(r,he,m)):((s.lanes&c)!==0&&(fh(s,r),Fa(r,null,null,c),Ua()),m=s.memoizedState,y=r.memoizedState,m.parent!==h?(m={parent:h,cache:h},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Ns(r,he,h)):(h=y.cache,Ns(r,he,h),h!==m.cache&&oh(r,[he],c,!0))),Re(s,r,r.pendingProps.children,c),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function us(s){s.flags|=4}function Xh(s,r,c,h,m){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(Cy())s.flags|=8192;else throw En=Cl,hh}else s.flags&=-16777217}function ty(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!gv(r))if(Cy())s.flags|=8192;else throw En=Cl,hh}function $l(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Lp():536870912,s.lanes|=r,xr|=r)}function Ga(s,r){if(!Dt)switch(s.tailMode){case"hidden":r=s.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function Qt(s){var r=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(r)for(var m=s.child;m!==null;)c|=m.lanes|m.childLanes,h|=m.subtreeFlags&65011712,h|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)c|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=h,s.childLanes=c,r}function PS(s,r,c){var h=r.pendingProps;switch(ih(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(r),null;case 1:return Qt(r),null;case 3:return c=r.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),r.memoizedState.cache!==h&&(r.flags|=2048),as(he),Pt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(gr(r)?us(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,nh())),Qt(r),null;case 26:var m=r.type,y=r.memoizedState;return s===null?(us(r),y!==null?(Qt(r),ty(r,y)):(Qt(r),Xh(r,m,null,h,c))):y?y!==s.memoizedState?(us(r),Qt(r),ty(r,y)):(Qt(r),r.flags&=-16777217):(s=s.memoizedProps,s!==h&&us(r),Qt(r),Xh(r,m,s,h,c)),null;case 27:if(gi(r),c=ot.current,m=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==h&&us(r);else{if(!h){if(r.stateNode===null)throw Error(i(166));return Qt(r),null}s=J.current,gr(r)?Lg(r):(s=ov(m,h,c),r.stateNode=s,us(r))}return Qt(r),null;case 5:if(gi(r),m=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==h&&us(r);else{if(!h){if(r.stateNode===null)throw Error(i(166));return Qt(r),null}if(y=J.current,gr(r))Lg(r);else{var S=nc(ot.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof h.is=="string"?S.createElement("select",{is:h.is}):S.createElement("select"),h.multiple?y.multiple=!0:h.size&&(y.size=h.size);break;default:y=typeof h.is=="string"?S.createElement(m,{is:h.is}):S.createElement(m)}}y[Ee]=r,y[Ue]=h;t:for(S=r.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===r)break t;for(;S.sibling===null;){if(S.return===null||S.return===r)break t;S=S.return}S.sibling.return=S.return,S=S.sibling}r.stateNode=y;t:switch(xe(y,m,h),m){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&us(r)}}return Qt(r),Xh(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,c),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==h&&us(r);else{if(typeof h!="string"&&r.stateNode===null)throw Error(i(166));if(s=ot.current,gr(r)){if(s=r.stateNode,c=r.memoizedProps,h=null,m=Te,m!==null)switch(m.tag){case 27:case 5:h=m.memoizedProps}s[Ee]=r,s=!!(s.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Wy(s.nodeValue,c)),s||Ps(r,!0)}else s=nc(s).createTextNode(h),s[Ee]=r,r.stateNode=s}return Qt(r),null;case 31:if(c=r.memoizedState,s===null||s.memoizedState!==null){if(h=gr(r),c!==null){if(s===null){if(!h)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ee]=r}else bn(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qt(r),s=!1}else c=nh(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return r.flags&256?(si(r),r):(si(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Qt(r),null;case 13:if(h=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=gr(r),h!==null&&h.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Ee]=r}else bn(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qt(r),m=!1}else m=nh(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(si(r),r):(si(r),null)}return si(r),(r.flags&128)!==0?(r.lanes=c,r):(c=h!==null,s=s!==null&&s.memoizedState!==null,c&&(h=r.child,m=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(m=h.alternate.memoizedState.cachePool.pool),y=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==m&&(h.flags|=2048)),c!==s&&c&&(r.child.flags|=8192),$l(r,r.updateQueue),Qt(r),null);case 4:return Pt(),s===null&&md(r.stateNode.containerInfo),Qt(r),null;case 10:return as(r.type),Qt(r),null;case 19:if($(oe),h=r.memoizedState,h===null)return Qt(r),null;if(m=(r.flags&128)!==0,y=h.rendering,y===null)if(m)Ga(h,!1);else{if(ae!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(y=Ml(s),y!==null){for(r.flags|=128,Ga(h,!1),s=y.updateQueue,r.updateQueue=s,$l(r,s),r.subtreeFlags=0,s=c,c=r.child;c!==null;)xg(c,s),c=c.sibling;return K(oe,oe.current&1|2),Dt&&ns(r,h.treeForkCount),r.child}s=s.sibling}h.tail!==null&&It()>Xl&&(r.flags|=128,m=!0,Ga(h,!1),r.lanes=4194304)}else{if(!m)if(s=Ml(y),s!==null){if(r.flags|=128,m=!0,s=s.updateQueue,r.updateQueue=s,$l(r,s),Ga(h,!0),h.tail===null&&h.tailMode==="hidden"&&!y.alternate&&!Dt)return Qt(r),null}else 2*It()-h.renderingStartTime>Xl&&c!==536870912&&(r.flags|=128,m=!0,Ga(h,!1),r.lanes=4194304);h.isBackwards?(y.sibling=r.child,r.child=y):(s=h.last,s!==null?s.sibling=y:r.child=y,h.last=y)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=It(),s.sibling=null,c=oe.current,K(oe,m?c&1|2:c&1),Dt&&ns(r,h.treeForkCount),s):(Qt(r),null);case 22:case 23:return si(r),yh(),h=r.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(r.flags|=8192):h&&(r.flags|=8192),h?(c&536870912)!==0&&(r.flags&128)===0&&(Qt(r),r.subtreeFlags&6&&(r.flags|=8192)):Qt(r),c=r.updateQueue,c!==null&&$l(r,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),h=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),h!==c&&(r.flags|=2048),s!==null&&$(Sn),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),as(he),Qt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function NS(s,r){switch(ih(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return as(he),Pt(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return gi(r),null;case 31:if(r.memoizedState!==null){if(si(r),r.alternate===null)throw Error(i(340));bn()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(si(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));bn()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return $(oe),null;case 4:return Pt(),null;case 10:return as(r.type),null;case 22:case 23:return si(r),yh(),s!==null&&$(Sn),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return as(he),null;case 25:return null;default:return null}}function ey(s,r){switch(ih(r),r.tag){case 3:as(he),Pt();break;case 26:case 27:case 5:gi(r);break;case 4:Pt();break;case 31:r.memoizedState!==null&&si(r);break;case 13:si(r);break;case 19:$(oe);break;case 10:as(r.type);break;case 22:case 23:si(r),yh(),s!==null&&$(Sn);break;case 24:as(he)}}function Ya(s,r){try{var c=r.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var m=h.next;c=m;do{if((c.tag&s)===s){h=void 0;var y=c.create,S=c.inst;h=y(),S.destroy=h}c=c.next}while(c!==m)}}catch(T){Ft(r,r.return,T)}}function zs(s,r,c){try{var h=r.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var y=m.next;h=y;do{if((h.tag&s)===s){var S=h.inst,T=S.destroy;if(T!==void 0){S.destroy=void 0,m=r;var O=c,U=T;try{U()}catch(V){Ft(m,O,V)}}}h=h.next}while(h!==y)}}catch(V){Ft(r,r.return,V)}}function iy(s){var r=s.updateQueue;if(r!==null){var c=s.stateNode;try{Gg(r,c)}catch(h){Ft(s,s.return,h)}}}function sy(s,r,c){c.props=Rn(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(h){Ft(s,r,h)}}function Xa(s,r){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof c=="function"?s.refCleanup=c(h):c.current=h}}catch(m){Ft(s,r,m)}}function Hi(s,r){var c=s.ref,h=s.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(m){Ft(s,r,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Ft(s,r,m)}else c.current=null}function ny(s){var r=s.type,c=s.memoizedProps,h=s.stateNode;try{t:switch(r){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break t;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(m){Ft(s,s.return,m)}}function Kh(s,r,c){try{var h=s.stateNode;sA(h,s.type,c,r),h[Ue]=r}catch(m){Ft(s,s.return,m)}}function ry(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Xs(s.type)||s.tag===4}function Wh(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||ry(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Xs(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Qh(s,r,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,r?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,r):(r=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,r.appendChild(s),c=c._reactRootContainer,c!=null||r.onclick!==null||(r.onclick=es));else if(h!==4&&(h===27&&Xs(s.type)&&(c=s.stateNode,r=null),s=s.child,s!==null))for(Qh(s,r,c),s=s.sibling;s!==null;)Qh(s,r,c),s=s.sibling}function ql(s,r,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,r?c.insertBefore(s,r):c.appendChild(s);else if(h!==4&&(h===27&&Xs(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(ql(s,r,c),s=s.sibling;s!==null;)ql(s,r,c),s=s.sibling}function ay(s){var r=s.stateNode,c=s.memoizedProps;try{for(var h=s.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);xe(r,h,c),r[Ee]=s,r[Ue]=c}catch(y){Ft(s,s.return,y)}}var hs=!1,pe=!1,Jh=!1,oy=typeof WeakSet=="function"?WeakSet:Set,_e=null;function BS(s,r){if(s=s.containerInfo,bd=hc,s=bg(s),Vu(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else t:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var m=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break t}var S=0,T=-1,O=-1,U=0,V=0,Y=s,F=null;e:for(;;){for(var z;Y!==c||m!==0&&Y.nodeType!==3||(T=S+m),Y!==y||h!==0&&Y.nodeType!==3||(O=S+h),Y.nodeType===3&&(S+=Y.nodeValue.length),(z=Y.firstChild)!==null;)F=Y,Y=z;for(;;){if(Y===s)break e;if(F===c&&++U===m&&(T=S),F===y&&++V===h&&(O=S),(z=Y.nextSibling)!==null)break;Y=F,F=Y.parentNode}Y=z}c=T===-1||O===-1?null:{start:T,end:O}}else c=null}c=c||{start:0,end:0}}else c=null;for(_d={focusedElem:s,selectionRange:c},hc=!1,_e=r;_e!==null;)if(r=_e,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,_e=s;else for(;_e!==null;){switch(r=_e,y=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)m=s[c],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,c=r,m=y.memoizedProps,y=y.memoizedState,h=c.stateNode;try{var it=Rn(c.type,m);s=h.getSnapshotBeforeUpdate(it,y),h.__reactInternalSnapshotBeforeUpdate=s}catch(pt){Ft(c,c.return,pt)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,c=s.nodeType,c===9)Ad(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Ad(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,_e=s;break}_e=r.return}}function ly(s,r,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:fs(s,c),h&4&&Ya(5,c);break;case 1:if(fs(s,c),h&4)if(s=c.stateNode,r===null)try{s.componentDidMount()}catch(S){Ft(c,c.return,S)}else{var m=Rn(c.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(m,r,s.__reactInternalSnapshotBeforeUpdate)}catch(S){Ft(c,c.return,S)}}h&64&&iy(c),h&512&&Xa(c,c.return);break;case 3:if(fs(s,c),h&64&&(s=c.updateQueue,s!==null)){if(r=null,c.child!==null)switch(c.child.tag){case 27:case 5:r=c.child.stateNode;break;case 1:r=c.child.stateNode}try{Gg(s,r)}catch(S){Ft(c,c.return,S)}}break;case 27:r===null&&h&4&&ay(c);case 26:case 5:fs(s,c),r===null&&h&4&&ny(c),h&512&&Xa(c,c.return);break;case 12:fs(s,c);break;case 31:fs(s,c),h&4&&hy(s,c);break;case 13:fs(s,c),h&4&&dy(s,c),h&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=VS.bind(null,c),hA(s,c))));break;case 22:if(h=c.memoizedState!==null||hs,!h){r=r!==null&&r.memoizedState!==null||pe,m=hs;var y=pe;hs=h,(pe=r)&&!y?ps(s,c,(c.subtreeFlags&8772)!==0):fs(s,c),hs=m,pe=y}break;case 30:break;default:fs(s,c)}}function cy(s){var r=s.alternate;r!==null&&(s.alternate=null,cy(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&xu(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Jt=null,ze=!1;function ds(s,r,c){for(c=c.child;c!==null;)uy(s,r,c),c=c.sibling}function uy(s,r,c){if(Je&&typeof Je.onCommitFiberUnmount=="function")try{Je.onCommitFiberUnmount(va,c)}catch{}switch(c.tag){case 26:pe||Hi(c,r),ds(s,r,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:pe||Hi(c,r);var h=Jt,m=ze;Xs(c.type)&&(Jt=c.stateNode,ze=!1),ds(s,r,c),so(c.stateNode),Jt=h,ze=m;break;case 5:pe||Hi(c,r);case 6:if(h=Jt,m=ze,Jt=null,ds(s,r,c),Jt=h,ze=m,Jt!==null)if(ze)try{(Jt.nodeType===9?Jt.body:Jt.nodeName==="HTML"?Jt.ownerDocument.body:Jt).removeChild(c.stateNode)}catch(y){Ft(c,r,y)}else try{Jt.removeChild(c.stateNode)}catch(y){Ft(c,r,y)}break;case 18:Jt!==null&&(ze?(s=Jt,iv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Br(s)):iv(Jt,c.stateNode));break;case 4:h=Jt,m=ze,Jt=c.stateNode.containerInfo,ze=!0,ds(s,r,c),Jt=h,ze=m;break;case 0:case 11:case 14:case 15:zs(2,c,r),pe||zs(4,c,r),ds(s,r,c);break;case 1:pe||(Hi(c,r),h=c.stateNode,typeof h.componentWillUnmount=="function"&&sy(c,r,h)),ds(s,r,c);break;case 21:ds(s,r,c);break;case 22:pe=(h=pe)||c.memoizedState!==null,ds(s,r,c),pe=h;break;default:ds(s,r,c)}}function hy(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Br(s)}catch(c){Ft(r,r.return,c)}}}function dy(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Br(s)}catch(c){Ft(r,r.return,c)}}function IS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new oy),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new oy),r;default:throw Error(i(435,s.tag))}}function Vl(s,r){var c=IS(s);r.forEach(function(h){if(!c.has(h)){c.add(h);var m=GS.bind(null,s,h);h.then(m,m)}})}function He(s,r){var c=r.deletions;if(c!==null)for(var h=0;h<c.length;h++){var m=c[h],y=s,S=r,T=S;t:for(;T!==null;){switch(T.tag){case 27:if(Xs(T.type)){Jt=T.stateNode,ze=!1;break t}break;case 5:Jt=T.stateNode,ze=!1;break t;case 3:case 4:Jt=T.stateNode.containerInfo,ze=!0;break t}T=T.return}if(Jt===null)throw Error(i(160));uy(y,S,m),Jt=null,ze=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)fy(r,s),r=r.sibling}var Di=null;function fy(s,r){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:He(r,s),$e(s),h&4&&(zs(3,s,s.return),Ya(3,s),zs(5,s,s.return));break;case 1:He(r,s),$e(s),h&512&&(pe||c===null||Hi(c,c.return)),h&64&&hs&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var m=Di;if(He(r,s),$e(s),h&512&&(pe||c===null||Hi(c,c.return)),h&4){var y=c!==null?c.memoizedState:null;if(h=s.memoizedState,c===null)if(h===null)if(s.stateNode===null){t:{h=s.type,c=s.memoizedProps,m=m.ownerDocument||m;e:switch(h){case"title":y=m.getElementsByTagName("title")[0],(!y||y[wa]||y[Ee]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(h),m.head.insertBefore(y,m.querySelector("head > title"))),xe(y,h,c),y[Ee]=s,be(y),h=y;break t;case"link":var S=fv("link","href",m).get(h+(c.href||""));if(S){for(var T=0;T<S.length;T++)if(y=S[T],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){S.splice(T,1);break e}}y=m.createElement(h),xe(y,h,c),m.head.appendChild(y);break;case"meta":if(S=fv("meta","content",m).get(h+(c.content||""))){for(T=0;T<S.length;T++)if(y=S[T],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){S.splice(T,1);break e}}y=m.createElement(h),xe(y,h,c),m.head.appendChild(y);break;default:throw Error(i(468,h))}y[Ee]=s,be(y),h=y}s.stateNode=h}else pv(m,s.type,s.stateNode);else s.stateNode=dv(m,h,s.memoizedProps);else y!==h?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,h===null?pv(m,s.type,s.stateNode):dv(m,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Kh(s,s.memoizedProps,c.memoizedProps)}break;case 27:He(r,s),$e(s),h&512&&(pe||c===null||Hi(c,c.return)),c!==null&&h&4&&Kh(s,s.memoizedProps,c.memoizedProps);break;case 5:if(He(r,s),$e(s),h&512&&(pe||c===null||Hi(c,c.return)),s.flags&32){m=s.stateNode;try{rr(m,"")}catch(it){Ft(s,s.return,it)}}h&4&&s.stateNode!=null&&(m=s.memoizedProps,Kh(s,m,c!==null?c.memoizedProps:m)),h&1024&&(Jh=!0);break;case 6:if(He(r,s),$e(s),h&4){if(s.stateNode===null)throw Error(i(162));h=s.memoizedProps,c=s.stateNode;try{c.nodeValue=h}catch(it){Ft(s,s.return,it)}}break;case 3:if(oc=null,m=Di,Di=rc(r.containerInfo),He(r,s),Di=m,$e(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Br(r.containerInfo)}catch(it){Ft(s,s.return,it)}Jh&&(Jh=!1,py(s));break;case 4:h=Di,Di=rc(s.stateNode.containerInfo),He(r,s),$e(s),Di=h;break;case 12:He(r,s),$e(s);break;case 31:He(r,s),$e(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Vl(s,h)));break;case 13:He(r,s),$e(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Yl=It()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Vl(s,h)));break;case 22:m=s.memoizedState!==null;var O=c!==null&&c.memoizedState!==null,U=hs,V=pe;if(hs=U||m,pe=V||O,He(r,s),pe=V,hs=U,$e(s),h&8192)t:for(r=s.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(c===null||O||hs||pe||xn(s)),c=null,r=s;;){if(r.tag===5||r.tag===26){if(c===null){O=c=r;try{if(y=O.stateNode,m)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{T=O.stateNode;var Y=O.memoizedProps.style,F=Y!=null&&Y.hasOwnProperty("display")?Y.display:null;T.style.display=F==null||typeof F=="boolean"?"":(""+F).trim()}}catch(it){Ft(O,O.return,it)}}}else if(r.tag===6){if(c===null){O=r;try{O.stateNode.nodeValue=m?"":O.memoizedProps}catch(it){Ft(O,O.return,it)}}}else if(r.tag===18){if(c===null){O=r;try{var z=O.stateNode;m?sv(z,!0):sv(O.stateNode,!1)}catch(it){Ft(O,O.return,it)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break t;for(;r.sibling===null;){if(r.return===null||r.return===s)break t;c===r&&(c=null),r=r.return}c===r&&(c=null),r.sibling.return=r.return,r=r.sibling}h&4&&(h=s.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Vl(s,c))));break;case 19:He(r,s),$e(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Vl(s,h)));break;case 30:break;case 21:break;default:He(r,s),$e(s)}}function $e(s){var r=s.flags;if(r&2){try{for(var c,h=s.return;h!==null;){if(ry(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var m=c.stateNode,y=Wh(s);ql(s,y,m);break;case 5:var S=c.stateNode;c.flags&32&&(rr(S,""),c.flags&=-33);var T=Wh(s);ql(s,T,S);break;case 3:case 4:var O=c.stateNode.containerInfo,U=Wh(s);Qh(s,U,O);break;default:throw Error(i(161))}}catch(V){Ft(s,s.return,V)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function py(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;py(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function fs(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)ly(s,r.alternate,r),r=r.sibling}function xn(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:zs(4,r,r.return),xn(r);break;case 1:Hi(r,r.return);var c=r.stateNode;typeof c.componentWillUnmount=="function"&&sy(r,r.return,c),xn(r);break;case 27:so(r.stateNode);case 26:case 5:Hi(r,r.return),xn(r);break;case 22:r.memoizedState===null&&xn(r);break;case 30:xn(r);break;default:xn(r)}s=s.sibling}}function ps(s,r,c){for(c=c&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var h=r.alternate,m=s,y=r,S=y.flags;switch(y.tag){case 0:case 11:case 15:ps(m,y,c),Ya(4,y);break;case 1:if(ps(m,y,c),h=y,m=h.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(U){Ft(h,h.return,U)}if(h=y,m=h.updateQueue,m!==null){var T=h.stateNode;try{var O=m.shared.hiddenCallbacks;if(O!==null)for(m.shared.hiddenCallbacks=null,m=0;m<O.length;m++)Vg(O[m],T)}catch(U){Ft(h,h.return,U)}}c&&S&64&&iy(y),Xa(y,y.return);break;case 27:ay(y);case 26:case 5:ps(m,y,c),c&&h===null&&S&4&&ny(y),Xa(y,y.return);break;case 12:ps(m,y,c);break;case 31:ps(m,y,c),c&&S&4&&hy(m,y);break;case 13:ps(m,y,c),c&&S&4&&dy(m,y);break;case 22:y.memoizedState===null&&ps(m,y,c),Xa(y,y.return);break;case 30:break;default:ps(m,y,c)}r=r.sibling}}function Zh(s,r){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Pa(c))}function td(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Pa(s))}function Li(s,r,c,h){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)gy(s,r,c,h),r=r.sibling}function gy(s,r,c,h){var m=r.flags;switch(r.tag){case 0:case 11:case 15:Li(s,r,c,h),m&2048&&Ya(9,r);break;case 1:Li(s,r,c,h);break;case 3:Li(s,r,c,h),m&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Pa(s)));break;case 12:if(m&2048){Li(s,r,c,h),s=r.stateNode;try{var y=r.memoizedProps,S=y.id,T=y.onPostCommit;typeof T=="function"&&T(S,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(O){Ft(r,r.return,O)}}else Li(s,r,c,h);break;case 31:Li(s,r,c,h);break;case 13:Li(s,r,c,h);break;case 23:break;case 22:y=r.stateNode,S=r.alternate,r.memoizedState!==null?y._visibility&2?Li(s,r,c,h):Ka(s,r):y._visibility&2?Li(s,r,c,h):(y._visibility|=2,Tr(s,r,c,h,(r.subtreeFlags&10256)!==0||!1)),m&2048&&Zh(S,r);break;case 24:Li(s,r,c,h),m&2048&&td(r.alternate,r);break;default:Li(s,r,c,h)}}function Tr(s,r,c,h,m){for(m=m&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var y=s,S=r,T=c,O=h,U=S.flags;switch(S.tag){case 0:case 11:case 15:Tr(y,S,T,O,m),Ya(8,S);break;case 23:break;case 22:var V=S.stateNode;S.memoizedState!==null?V._visibility&2?Tr(y,S,T,O,m):Ka(y,S):(V._visibility|=2,Tr(y,S,T,O,m)),m&&U&2048&&Zh(S.alternate,S);break;case 24:Tr(y,S,T,O,m),m&&U&2048&&td(S.alternate,S);break;default:Tr(y,S,T,O,m)}r=r.sibling}}function Ka(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var c=s,h=r,m=h.flags;switch(h.tag){case 22:Ka(c,h),m&2048&&Zh(h.alternate,h);break;case 24:Ka(c,h),m&2048&&td(h.alternate,h);break;default:Ka(c,h)}r=r.sibling}}var Wa=8192;function Cr(s,r,c){if(s.subtreeFlags&Wa)for(s=s.child;s!==null;)my(s,r,c),s=s.sibling}function my(s,r,c){switch(s.tag){case 26:Cr(s,r,c),s.flags&Wa&&s.memoizedState!==null&&AA(c,Di,s.memoizedState,s.memoizedProps);break;case 5:Cr(s,r,c);break;case 3:case 4:var h=Di;Di=rc(s.stateNode.containerInfo),Cr(s,r,c),Di=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=Wa,Wa=16777216,Cr(s,r,c),Wa=h):Cr(s,r,c));break;default:Cr(s,r,c)}}function yy(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Qa(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var h=r[c];_e=h,by(h,s)}yy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)vy(s),s=s.sibling}function vy(s){switch(s.tag){case 0:case 11:case 15:Qa(s),s.flags&2048&&zs(9,s,s.return);break;case 3:Qa(s);break;case 12:Qa(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Gl(s)):Qa(s);break;default:Qa(s)}}function Gl(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var h=r[c];_e=h,by(h,s)}yy(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:zs(8,r,r.return),Gl(r);break;case 22:c=r.stateNode,c._visibility&2&&(c._visibility&=-3,Gl(r));break;default:Gl(r)}s=s.sibling}}function by(s,r){for(;_e!==null;){var c=_e;switch(c.tag){case 0:case 11:case 15:zs(8,c,r);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Pa(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,_e=h;else t:for(c=s;_e!==null;){h=_e;var m=h.sibling,y=h.return;if(cy(h),h===c){_e=null;break t}if(m!==null){m.return=y,_e=m;break t}_e=y}}}var jS={getCacheForType:function(s){var r=Ce(he),c=r.data.get(s);return c===void 0&&(c=s(),r.data.set(s,c)),c},cacheSignal:function(){return Ce(he).controller.signal}},US=typeof WeakMap=="function"?WeakMap:Map,jt=0,Gt=null,Rt=null,Ot=0,Ut=0,ni=null,Hs=!1,Rr=!1,ed=!1,gs=0,ae=0,$s=0,On=0,id=0,ri=0,xr=0,Ja=null,qe=null,sd=!1,Yl=0,_y=0,Xl=1/0,Kl=null,qs=null,ye=0,Vs=null,Or=null,ms=0,nd=0,rd=null,wy=null,Za=0,ad=null;function ai(){return(jt&2)!==0&&Ot!==0?Ot&-Ot:N.T!==null?dd():Ip()}function Sy(){if(ri===0)if((Ot&536870912)===0||Dt){var s=sl;sl<<=1,(sl&3932160)===0&&(sl=262144),ri=s}else ri=536870912;return s=ii.current,s!==null&&(s.flags|=32),ri}function Ve(s,r,c){(s===Gt&&(Ut===2||Ut===9)||s.cancelPendingCommit!==null)&&(Mr(s,0),Gs(s,Ot,ri,!1)),_a(s,c),((jt&2)===0||s!==Gt)&&(s===Gt&&((jt&2)===0&&(On|=c),ae===4&&Gs(s,Ot,ri,!1)),$i(s))}function Ay(s,r,c){if((jt&6)!==0)throw Error(i(327));var h=!c&&(r&127)===0&&(r&s.expiredLanes)===0||ba(s,r),m=h?HS(s,r):ld(s,r,!0),y=h;do{if(m===0){Rr&&!h&&Gs(s,r,0,!1);break}else{if(c=s.current.alternate,y&&!FS(c)){m=ld(s,r,!1),y=!1;continue}if(m===2){if(y=r,s.errorRecoveryDisabledLanes&y)var S=0;else S=s.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){r=S;t:{var T=s;m=Ja;var O=T.current.memoizedState.isDehydrated;if(O&&(Mr(T,S).flags|=256),S=ld(T,S,!1),S!==2){if(ed&&!O){T.errorRecoveryDisabledLanes|=y,On|=y,m=4;break t}y=qe,qe=m,y!==null&&(qe===null?qe=y:qe.push.apply(qe,y))}m=S}if(y=!1,m!==2)continue}}if(m===1){Mr(s,0),Gs(s,r,0,!0);break}t:{switch(h=s,y=m,y){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Gs(h,r,ri,!Hs);break t;case 2:qe=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(m=Yl+300-It(),10<m)){if(Gs(h,r,ri,!Hs),rl(h,0,!0)!==0)break t;ms=r,h.timeoutHandle=tv(Ey.bind(null,h,c,qe,Kl,sd,r,ri,On,xr,Hs,y,"Throttled",-0,0),m);break t}Ey(h,c,qe,Kl,sd,r,ri,On,xr,Hs,y,null,-0,0)}}break}while(!0);$i(s)}function Ey(s,r,c,h,m,y,S,T,O,U,V,Y,F,z){if(s.timeoutHandle=-1,Y=r.subtreeFlags,Y&8192||(Y&16785408)===16785408){Y={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:es},my(r,y,Y);var it=(y&62914560)===y?Yl-It():(y&4194048)===y?_y-It():0;if(it=EA(Y,it),it!==null){ms=y,s.cancelPendingCommit=it(Dy.bind(null,s,r,y,c,h,m,S,T,O,V,Y,null,F,z)),Gs(s,y,S,!U);return}}Dy(s,r,y,c,h,m,S,T,O)}function FS(s){for(var r=s;;){var c=r.tag;if((c===0||c===11||c===15)&&r.flags&16384&&(c=r.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var m=c[h],y=m.getSnapshot;m=m.value;try{if(!ti(y(),m))return!1}catch{return!1}}if(c=r.child,r.subtreeFlags&16384&&c!==null)c.return=r,r=c;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Gs(s,r,c,h){r&=~id,r&=~On,s.suspendedLanes|=r,s.pingedLanes&=~r,h&&(s.warmLanes|=r),h=s.expirationTimes;for(var m=r;0<m;){var y=31-Ze(m),S=1<<y;h[y]=-1,m&=~S}c!==0&&Pp(s,c,r)}function Wl(){return(jt&6)===0?(to(0),!1):!0}function od(){if(Rt!==null){if(Ut===0)var s=Rt.return;else s=Rt,rs=_n=null,Ah(s),_r=null,Ba=0,s=Rt;for(;s!==null;)ey(s.alternate,s),s=s.return;Rt=null}}function Mr(s,r){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,aA(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),ms=0,od(),Gt=s,Rt=c=ss(s.current,null),Ot=r,Ut=0,ni=null,Hs=!1,Rr=ba(s,r),ed=!1,xr=ri=id=On=$s=ae=0,qe=Ja=null,sd=!1,(r&8)!==0&&(r|=r&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=r;0<h;){var m=31-Ze(h),y=1<<m;r|=s[m],h&=~y}return gs=r,yl(),c}function Ty(s,r){At=null,N.H=qa,r===br||r===Tl?(r=zg(),Ut=3):r===hh?(r=zg(),Ut=4):Ut=r===Uh?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,ni=r,Rt===null&&(ae=1,Ul(s,bi(r,s.current)))}function Cy(){var s=ii.current;return s===null?!0:(Ot&4194048)===Ot?Ai===null:(Ot&62914560)===Ot||(Ot&536870912)!==0?s===Ai:!1}function Ry(){var s=N.H;return N.H=qa,s===null?qa:s}function xy(){var s=N.A;return N.A=jS,s}function Ql(){ae=4,Hs||(Ot&4194048)!==Ot&&ii.current!==null||(Rr=!0),($s&134217727)===0&&(On&134217727)===0||Gt===null||Gs(Gt,Ot,ri,!1)}function ld(s,r,c){var h=jt;jt|=2;var m=Ry(),y=xy();(Gt!==s||Ot!==r)&&(Kl=null,Mr(s,r)),r=!1;var S=ae;t:do try{if(Ut!==0&&Rt!==null){var T=Rt,O=ni;switch(Ut){case 8:od(),S=6;break t;case 3:case 2:case 9:case 6:ii.current===null&&(r=!0);var U=Ut;if(Ut=0,ni=null,kr(s,T,O,U),c&&Rr){S=0;break t}break;default:U=Ut,Ut=0,ni=null,kr(s,T,O,U)}}zS(),S=ae;break}catch(V){Ty(s,V)}while(!0);return r&&s.shellSuspendCounter++,rs=_n=null,jt=h,N.H=m,N.A=y,Rt===null&&(Gt=null,Ot=0,yl()),S}function zS(){for(;Rt!==null;)Oy(Rt)}function HS(s,r){var c=jt;jt|=2;var h=Ry(),m=xy();Gt!==s||Ot!==r?(Kl=null,Xl=It()+500,Mr(s,r)):Rr=ba(s,r);t:do try{if(Ut!==0&&Rt!==null){r=Rt;var y=ni;e:switch(Ut){case 1:Ut=0,ni=null,kr(s,r,y,1);break;case 2:case 9:if(Ug(y)){Ut=0,ni=null,My(r);break}r=function(){Ut!==2&&Ut!==9||Gt!==s||(Ut=7),$i(s)},y.then(r,r);break t;case 3:Ut=7;break t;case 4:Ut=5;break t;case 7:Ug(y)?(Ut=0,ni=null,My(r)):(Ut=0,ni=null,kr(s,r,y,7));break;case 5:var S=null;switch(Rt.tag){case 26:S=Rt.memoizedState;case 5:case 27:var T=Rt;if(S?gv(S):T.stateNode.complete){Ut=0,ni=null;var O=T.sibling;if(O!==null)Rt=O;else{var U=T.return;U!==null?(Rt=U,Jl(U)):Rt=null}break e}}Ut=0,ni=null,kr(s,r,y,5);break;case 6:Ut=0,ni=null,kr(s,r,y,6);break;case 8:od(),ae=6;break t;default:throw Error(i(462))}}$S();break}catch(V){Ty(s,V)}while(!0);return rs=_n=null,N.H=h,N.A=m,jt=c,Rt!==null?0:(Gt=null,Ot=0,yl(),ae)}function $S(){for(;Rt!==null&&!tl();)Oy(Rt)}function Oy(s){var r=Zm(s.alternate,s,gs);s.memoizedProps=s.pendingProps,r===null?Jl(s):Rt=r}function My(s){var r=s,c=r.alternate;switch(r.tag){case 15:case 0:r=Ym(c,r,r.pendingProps,r.type,void 0,Ot);break;case 11:r=Ym(c,r,r.pendingProps,r.type.render,r.ref,Ot);break;case 5:Ah(r);default:ey(c,r),r=Rt=xg(r,gs),r=Zm(c,r,gs)}s.memoizedProps=s.pendingProps,r===null?Jl(s):Rt=r}function kr(s,r,c,h){rs=_n=null,Ah(r),_r=null,Ba=0;var m=r.return;try{if(kS(s,m,r,c,Ot)){ae=1,Ul(s,bi(c,s.current)),Rt=null;return}}catch(y){if(m!==null)throw Rt=m,y;ae=1,Ul(s,bi(c,s.current)),Rt=null;return}r.flags&32768?(Dt||h===1?s=!0:Rr||(Ot&536870912)!==0?s=!1:(Hs=s=!0,(h===2||h===9||h===3||h===6)&&(h=ii.current,h!==null&&h.tag===13&&(h.flags|=16384))),ky(r,s)):Jl(r)}function Jl(s){var r=s;do{if((r.flags&32768)!==0){ky(r,Hs);return}s=r.return;var c=PS(r.alternate,r,gs);if(c!==null){Rt=c;return}if(r=r.sibling,r!==null){Rt=r;return}Rt=r=s}while(r!==null);ae===0&&(ae=5)}function ky(s,r){do{var c=NS(s.alternate,s);if(c!==null){c.flags&=32767,Rt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!r&&(s=s.sibling,s!==null)){Rt=s;return}Rt=s=c}while(s!==null);ae=6,Rt=null}function Dy(s,r,c,h,m,y,S,T,O){s.cancelPendingCommit=null;do Zl();while(ye!==0);if((jt&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(y=r.lanes|r.childLanes,y|=Wu,Sw(s,c,y,S,T,O),s===Gt&&(Rt=Gt=null,Ot=0),Or=r,Vs=s,ms=c,nd=y,rd=m,wy=h,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,YS(el,function(){return Iy(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||h){h=N.T,N.T=null,m=q.p,q.p=2,S=jt,jt|=4;try{BS(s,r,c)}finally{jt=S,q.p=m,N.T=h}}ye=1,Ly(),Py(),Ny()}}function Ly(){if(ye===1){ye=0;var s=Vs,r=Or,c=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||c){c=N.T,N.T=null;var h=q.p;q.p=2;var m=jt;jt|=4;try{fy(r,s);var y=_d,S=bg(s.containerInfo),T=y.focusedElem,O=y.selectionRange;if(S!==T&&T&&T.ownerDocument&&vg(T.ownerDocument.documentElement,T)){if(O!==null&&Vu(T)){var U=O.start,V=O.end;if(V===void 0&&(V=U),"selectionStart"in T)T.selectionStart=U,T.selectionEnd=Math.min(V,T.value.length);else{var Y=T.ownerDocument||document,F=Y&&Y.defaultView||window;if(F.getSelection){var z=F.getSelection(),it=T.textContent.length,pt=Math.min(O.start,it),qt=O.end===void 0?pt:Math.min(O.end,it);!z.extend&&pt>qt&&(S=qt,qt=pt,pt=S);var B=yg(T,pt),P=yg(T,qt);if(B&&P&&(z.rangeCount!==1||z.anchorNode!==B.node||z.anchorOffset!==B.offset||z.focusNode!==P.node||z.focusOffset!==P.offset)){var j=Y.createRange();j.setStart(B.node,B.offset),z.removeAllRanges(),pt>qt?(z.addRange(j),z.extend(P.node,P.offset)):(j.setEnd(P.node,P.offset),z.addRange(j))}}}}for(Y=[],z=T;z=z.parentNode;)z.nodeType===1&&Y.push({element:z,left:z.scrollLeft,top:z.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<Y.length;T++){var G=Y[T];G.element.scrollLeft=G.left,G.element.scrollTop=G.top}}hc=!!bd,_d=bd=null}finally{jt=m,q.p=h,N.T=c}}s.current=r,ye=2}}function Py(){if(ye===2){ye=0;var s=Vs,r=Or,c=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||c){c=N.T,N.T=null;var h=q.p;q.p=2;var m=jt;jt|=4;try{ly(s,r.alternate,r)}finally{jt=m,q.p=h,N.T=c}}ye=3}}function Ny(){if(ye===4||ye===3){ye=0,zt();var s=Vs,r=Or,c=ms,h=wy;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?ye=5:(ye=0,Or=Vs=null,By(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(qs=null),Cu(c),r=r.stateNode,Je&&typeof Je.onCommitFiberRoot=="function")try{Je.onCommitFiberRoot(va,r,void 0,(r.current.flags&128)===128)}catch{}if(h!==null){r=N.T,m=q.p,q.p=2,N.T=null;try{for(var y=s.onRecoverableError,S=0;S<h.length;S++){var T=h[S];y(T.value,{componentStack:T.stack})}}finally{N.T=r,q.p=m}}(ms&3)!==0&&Zl(),$i(s),m=s.pendingLanes,(c&261930)!==0&&(m&42)!==0?s===ad?Za++:(Za=0,ad=s):Za=0,to(0)}}function By(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Pa(r)))}function Zl(){return Ly(),Py(),Ny(),Iy()}function Iy(){if(ye!==5)return!1;var s=Vs,r=nd;nd=0;var c=Cu(ms),h=N.T,m=q.p;try{q.p=32>c?32:c,N.T=null,c=rd,rd=null;var y=Vs,S=ms;if(ye=0,Or=Vs=null,ms=0,(jt&6)!==0)throw Error(i(331));var T=jt;if(jt|=4,vy(y.current),gy(y,y.current,S,c),jt=T,to(0,!1),Je&&typeof Je.onPostCommitFiberRoot=="function")try{Je.onPostCommitFiberRoot(va,y)}catch{}return!0}finally{q.p=m,N.T=h,By(s,r)}}function jy(s,r,c){r=bi(c,r),r=jh(s.stateNode,r,2),s=js(s,r,2),s!==null&&(_a(s,2),$i(s))}function Ft(s,r,c){if(s.tag===3)jy(s,s,c);else for(;r!==null;){if(r.tag===3){jy(r,s,c);break}else if(r.tag===1){var h=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(qs===null||!qs.has(h))){s=bi(c,s),c=Um(2),h=js(r,c,2),h!==null&&(Fm(c,h,r,s),_a(h,2),$i(h));break}}r=r.return}}function cd(s,r,c){var h=s.pingCache;if(h===null){h=s.pingCache=new US;var m=new Set;h.set(r,m)}else m=h.get(r),m===void 0&&(m=new Set,h.set(r,m));m.has(c)||(ed=!0,m.add(c),s=qS.bind(null,s,r,c),r.then(s,s))}function qS(s,r,c){var h=s.pingCache;h!==null&&h.delete(r),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,Gt===s&&(Ot&c)===c&&(ae===4||ae===3&&(Ot&62914560)===Ot&&300>It()-Yl?(jt&2)===0&&Mr(s,0):id|=c,xr===Ot&&(xr=0)),$i(s)}function Uy(s,r){r===0&&(r=Lp()),s=yn(s,r),s!==null&&(_a(s,r),$i(s))}function VS(s){var r=s.memoizedState,c=0;r!==null&&(c=r.retryLane),Uy(s,c)}function GS(s,r){var c=0;switch(s.tag){case 31:case 13:var h=s.stateNode,m=s.memoizedState;m!==null&&(c=m.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(r),Uy(s,c)}function YS(s,r){return xs(s,r)}var tc=null,Dr=null,ud=!1,ec=!1,hd=!1,Ys=0;function $i(s){s!==Dr&&s.next===null&&(Dr===null?tc=Dr=s:Dr=Dr.next=s),ec=!0,ud||(ud=!0,KS())}function to(s,r){if(!hd&&ec){hd=!0;do for(var c=!1,h=tc;h!==null;){if(s!==0){var m=h.pendingLanes;if(m===0)var y=0;else{var S=h.suspendedLanes,T=h.pingedLanes;y=(1<<31-Ze(42|s)+1)-1,y&=m&~(S&~T),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,$y(h,y))}else y=Ot,y=rl(h,h===Gt?y:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(y&3)===0||ba(h,y)||(c=!0,$y(h,y));h=h.next}while(c);hd=!1}}function XS(){Fy()}function Fy(){ec=ud=!1;var s=0;Ys!==0&&rA()&&(s=Ys);for(var r=It(),c=null,h=tc;h!==null;){var m=h.next,y=zy(h,r);y===0?(h.next=null,c===null?tc=m:c.next=m,m===null&&(Dr=c)):(c=h,(s!==0||(y&3)!==0)&&(ec=!0)),h=m}ye!==0&&ye!==5||to(s),Ys!==0&&(Ys=0)}function zy(s,r){for(var c=s.suspendedLanes,h=s.pingedLanes,m=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var S=31-Ze(y),T=1<<S,O=m[S];O===-1?((T&c)===0||(T&h)!==0)&&(m[S]=ww(T,r)):O<=r&&(s.expiredLanes|=T),y&=~T}if(r=Gt,c=Ot,c=rl(s,s===r?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,c===0||s===r&&(Ut===2||Ut===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Jn(h),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||ba(s,c)){if(r=c&-c,r===s.callbackPriority)return r;switch(h!==null&&Jn(h),Cu(c)){case 2:case 8:c=kp;break;case 32:c=el;break;case 268435456:c=Dp;break;default:c=el}return h=Hy.bind(null,s),c=xs(c,h),s.callbackPriority=r,s.callbackNode=c,r}return h!==null&&h!==null&&Jn(h),s.callbackPriority=2,s.callbackNode=null,2}function Hy(s,r){if(ye!==0&&ye!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(Zl()&&s.callbackNode!==c)return null;var h=Ot;return h=rl(s,s===Gt?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(Ay(s,h,r),zy(s,It()),s.callbackNode!=null&&s.callbackNode===c?Hy.bind(null,s):null)}function $y(s,r){if(Zl())return null;Ay(s,r,!0)}function KS(){oA(function(){(jt&6)!==0?xs(ya,XS):Fy()})}function dd(){if(Ys===0){var s=yr;s===0&&(s=il,il<<=1,(il&261888)===0&&(il=256)),Ys=s}return Ys}function qy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:cl(""+s)}function Vy(s,r){var c=r.ownerDocument.createElement("input");return c.name=r.name,c.value=r.value,s.id&&c.setAttribute("form",s.id),r.parentNode.insertBefore(c,r),s=new FormData(s),c.parentNode.removeChild(c),s}function WS(s,r,c,h,m){if(r==="submit"&&c&&c.stateNode===m){var y=qy((m[Ue]||null).action),S=h.submitter;S&&(r=(r=S[Ue]||null)?qy(r.formAction):S.getAttribute("formAction"),r!==null&&(y=r,S=null));var T=new fl("action","action",null,h,m);s.push({event:T,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ys!==0){var O=S?Vy(m,S):new FormData(m);Dh(c,{pending:!0,data:O,method:m.method,action:y},null,O)}}else typeof y=="function"&&(T.preventDefault(),O=S?Vy(m,S):new FormData(m),Dh(c,{pending:!0,data:O,method:m.method,action:y},y,O))},currentTarget:m}]})}}for(var fd=0;fd<Ku.length;fd++){var pd=Ku[fd],QS=pd.toLowerCase(),JS=pd[0].toUpperCase()+pd.slice(1);ki(QS,"on"+JS)}ki(Sg,"onAnimationEnd"),ki(Ag,"onAnimationIteration"),ki(Eg,"onAnimationStart"),ki("dblclick","onDoubleClick"),ki("focusin","onFocus"),ki("focusout","onBlur"),ki(pS,"onTransitionRun"),ki(gS,"onTransitionStart"),ki(mS,"onTransitionCancel"),ki(Tg,"onTransitionEnd"),sr("onMouseEnter",["mouseout","mouseover"]),sr("onMouseLeave",["mouseout","mouseover"]),sr("onPointerEnter",["pointerout","pointerover"]),sr("onPointerLeave",["pointerout","pointerover"]),fn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fn("onBeforeInput",["compositionend","keypress","textInput","paste"]),fn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(eo));function Gy(s,r){r=(r&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],m=h.event;h=h.listeners;t:{var y=void 0;if(r)for(var S=h.length-1;0<=S;S--){var T=h[S],O=T.instance,U=T.currentTarget;if(T=T.listener,O!==y&&m.isPropagationStopped())break t;y=T,m.currentTarget=U;try{y(m)}catch(V){ml(V)}m.currentTarget=null,y=O}else for(S=0;S<h.length;S++){if(T=h[S],O=T.instance,U=T.currentTarget,T=T.listener,O!==y&&m.isPropagationStopped())break t;y=T,m.currentTarget=U;try{y(m)}catch(V){ml(V)}m.currentTarget=null,y=O}}}}function xt(s,r){var c=r[Ru];c===void 0&&(c=r[Ru]=new Set);var h=s+"__bubble";c.has(h)||(Yy(r,s,2,!1),c.add(h))}function gd(s,r,c){var h=0;r&&(h|=4),Yy(c,s,h,r)}var ic="_reactListening"+Math.random().toString(36).slice(2);function md(s){if(!s[ic]){s[ic]=!0,Fp.forEach(function(c){c!=="selectionchange"&&(ZS.has(c)||gd(c,!1,s),gd(c,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[ic]||(r[ic]=!0,gd("selectionchange",!1,r))}}function Yy(s,r,c,h){switch(Sv(r)){case 2:var m=RA;break;case 8:m=xA;break;default:m=kd}c=m.bind(null,r,c,s),m=void 0,!Bu||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),h?m!==void 0?s.addEventListener(r,c,{capture:!0,passive:m}):s.addEventListener(r,c,!0):m!==void 0?s.addEventListener(r,c,{passive:m}):s.addEventListener(r,c,!1)}function yd(s,r,c,h,m){var y=h;if((r&1)===0&&(r&2)===0&&h!==null)t:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var T=h.stateNode.containerInfo;if(T===m)break;if(S===4)for(S=h.return;S!==null;){var O=S.tag;if((O===3||O===4)&&S.stateNode.containerInfo===m)return;S=S.return}for(;T!==null;){if(S=tr(T),S===null)return;if(O=S.tag,O===5||O===6||O===26||O===27){h=y=S;continue t}T=T.parentNode}}h=h.return}Jp(function(){var U=y,V=Pu(c),Y=[];t:{var F=Cg.get(s);if(F!==void 0){var z=fl,it=s;switch(s){case"keypress":if(hl(c)===0)break t;case"keydown":case"keyup":z=Gw;break;case"focusin":it="focus",z=Fu;break;case"focusout":it="blur",z=Fu;break;case"beforeblur":case"afterblur":z=Fu;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":z=eg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":z=Pw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":z=Kw;break;case Sg:case Ag:case Eg:z=Iw;break;case Tg:z=Qw;break;case"scroll":case"scrollend":z=Dw;break;case"wheel":z=Zw;break;case"copy":case"cut":case"paste":z=Uw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":z=sg;break;case"toggle":case"beforetoggle":z=eS}var pt=(r&4)!==0,qt=!pt&&(s==="scroll"||s==="scrollend"),B=pt?F!==null?F+"Capture":null:F;pt=[];for(var P=U,j;P!==null;){var G=P;if(j=G.stateNode,G=G.tag,G!==5&&G!==26&&G!==27||j===null||B===null||(G=Aa(P,B),G!=null&&pt.push(io(P,G,j))),qt)break;P=P.return}0<pt.length&&(F=new z(F,it,null,c,V),Y.push({event:F,listeners:pt}))}}if((r&7)===0){t:{if(F=s==="mouseover"||s==="pointerover",z=s==="mouseout"||s==="pointerout",F&&c!==Lu&&(it=c.relatedTarget||c.fromElement)&&(tr(it)||it[Zn]))break t;if((z||F)&&(F=V.window===V?V:(F=V.ownerDocument)?F.defaultView||F.parentWindow:window,z?(it=c.relatedTarget||c.toElement,z=U,it=it?tr(it):null,it!==null&&(qt=a(it),pt=it.tag,it!==qt||pt!==5&&pt!==27&&pt!==6)&&(it=null)):(z=null,it=U),z!==it)){if(pt=eg,G="onMouseLeave",B="onMouseEnter",P="mouse",(s==="pointerout"||s==="pointerover")&&(pt=sg,G="onPointerLeave",B="onPointerEnter",P="pointer"),qt=z==null?F:Sa(z),j=it==null?F:Sa(it),F=new pt(G,P+"leave",z,c,V),F.target=qt,F.relatedTarget=j,G=null,tr(V)===U&&(pt=new pt(B,P+"enter",it,c,V),pt.target=j,pt.relatedTarget=qt,G=pt),qt=G,z&&it)e:{for(pt=tA,B=z,P=it,j=0,G=B;G;G=pt(G))j++;G=0;for(var ct=P;ct;ct=pt(ct))G++;for(;0<j-G;)B=pt(B),j--;for(;0<G-j;)P=pt(P),G--;for(;j--;){if(B===P||P!==null&&B===P.alternate){pt=B;break e}B=pt(B),P=pt(P)}pt=null}else pt=null;z!==null&&Xy(Y,F,z,pt,!1),it!==null&&qt!==null&&Xy(Y,qt,it,pt,!0)}}t:{if(F=U?Sa(U):window,z=F.nodeName&&F.nodeName.toLowerCase(),z==="select"||z==="input"&&F.type==="file")var Nt=hg;else if(cg(F))if(dg)Nt=hS;else{Nt=cS;var nt=lS}else z=F.nodeName,!z||z.toLowerCase()!=="input"||F.type!=="checkbox"&&F.type!=="radio"?U&&Du(U.elementType)&&(Nt=hg):Nt=uS;if(Nt&&(Nt=Nt(s,U))){ug(Y,Nt,c,V);break t}nt&&nt(s,F,U),s==="focusout"&&U&&F.type==="number"&&U.memoizedProps.value!=null&&ku(F,"number",F.value)}switch(nt=U?Sa(U):window,s){case"focusin":(cg(nt)||nt.contentEditable==="true")&&(cr=nt,Gu=U,ka=null);break;case"focusout":ka=Gu=cr=null;break;case"mousedown":Yu=!0;break;case"contextmenu":case"mouseup":case"dragend":Yu=!1,_g(Y,c,V);break;case"selectionchange":if(fS)break;case"keydown":case"keyup":_g(Y,c,V)}var Et;if(Hu)t:{switch(s){case"compositionstart":var Mt="onCompositionStart";break t;case"compositionend":Mt="onCompositionEnd";break t;case"compositionupdate":Mt="onCompositionUpdate";break t}Mt=void 0}else lr?og(s,c)&&(Mt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Mt="onCompositionStart");Mt&&(ng&&c.locale!=="ko"&&(lr||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&lr&&(Et=Zp()):(ks=V,Iu="value"in ks?ks.value:ks.textContent,lr=!0)),nt=sc(U,Mt),0<nt.length&&(Mt=new ig(Mt,s,null,c,V),Y.push({event:Mt,listeners:nt}),Et?Mt.data=Et:(Et=lg(c),Et!==null&&(Mt.data=Et)))),(Et=sS?nS(s,c):rS(s,c))&&(Mt=sc(U,"onBeforeInput"),0<Mt.length&&(nt=new ig("onBeforeInput","beforeinput",null,c,V),Y.push({event:nt,listeners:Mt}),nt.data=Et)),WS(Y,s,U,c,V)}Gy(Y,r)})}function io(s,r,c){return{instance:s,listener:r,currentTarget:c}}function sc(s,r){for(var c=r+"Capture",h=[];s!==null;){var m=s,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=Aa(s,c),m!=null&&h.unshift(io(s,m,y)),m=Aa(s,r),m!=null&&h.push(io(s,m,y))),s.tag===3)return h;s=s.return}return[]}function tA(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Xy(s,r,c,h,m){for(var y=r._reactName,S=[];c!==null&&c!==h;){var T=c,O=T.alternate,U=T.stateNode;if(T=T.tag,O!==null&&O===h)break;T!==5&&T!==26&&T!==27||U===null||(O=U,m?(U=Aa(c,y),U!=null&&S.unshift(io(c,U,O))):m||(U=Aa(c,y),U!=null&&S.push(io(c,U,O)))),c=c.return}S.length!==0&&s.push({event:r,listeners:S})}var eA=/\r\n?/g,iA=/\u0000|\uFFFD/g;function Ky(s){return(typeof s=="string"?s:""+s).replace(eA,`
`).replace(iA,"")}function Wy(s,r){return r=Ky(r),Ky(s)===r}function $t(s,r,c,h,m,y){switch(c){case"children":typeof h=="string"?r==="body"||r==="textarea"&&h===""||rr(s,h):(typeof h=="number"||typeof h=="bigint")&&r!=="body"&&rr(s,""+h);break;case"className":ol(s,"class",h);break;case"tabIndex":ol(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ol(s,c,h);break;case"style":Wp(s,h,y);break;case"data":if(r!=="object"){ol(s,"data",h);break}case"src":case"href":if(h===""&&(r!=="a"||c!=="href")){s.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=cl(""+h),s.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(r!=="input"&&$t(s,r,"name",m.name,m,null),$t(s,r,"formEncType",m.formEncType,m,null),$t(s,r,"formMethod",m.formMethod,m,null),$t(s,r,"formTarget",m.formTarget,m,null)):($t(s,r,"encType",m.encType,m,null),$t(s,r,"method",m.method,m,null),$t(s,r,"target",m.target,m,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=cl(""+h),s.setAttribute(c,h);break;case"onClick":h!=null&&(s.onclick=es);break;case"onScroll":h!=null&&xt("scroll",s);break;case"onScrollEnd":h!=null&&xt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}c=cl(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""+h):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":h===!0?s.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,h):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(c,h):s.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(c):s.setAttribute(c,h);break;case"popover":xt("beforetoggle",s),xt("toggle",s),al(s,"popover",h);break;case"xlinkActuate":ts(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ts(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ts(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ts(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ts(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ts(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ts(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ts(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ts(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":al(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Mw.get(c)||c,al(s,c,h))}}function vd(s,r,c,h,m,y){switch(c){case"style":Wp(s,h,y);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"children":typeof h=="string"?rr(s,h):(typeof h=="number"||typeof h=="bigint")&&rr(s,""+h);break;case"onScroll":h!=null&&xt("scroll",s);break;case"onScrollEnd":h!=null&&xt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=es);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zp.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),r=c.slice(2,m?c.length-7:void 0),y=s[Ue]||null,y=y!=null?y[c]:null,typeof y=="function"&&s.removeEventListener(r,y,m),typeof h=="function")){typeof y!="function"&&y!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(r,h,m);break t}c in s?s[c]=h:h===!0?s.setAttribute(c,""):al(s,c,h)}}}function xe(s,r,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",s),xt("load",s);var h=!1,m=!1,y;for(y in c)if(c.hasOwnProperty(y)){var S=c[y];if(S!=null)switch(y){case"src":h=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$t(s,r,y,S,c,null)}}m&&$t(s,r,"srcSet",c.srcSet,c,null),h&&$t(s,r,"src",c.src,c,null);return;case"input":xt("invalid",s);var T=y=S=m=null,O=null,U=null;for(h in c)if(c.hasOwnProperty(h)){var V=c[h];if(V!=null)switch(h){case"name":m=V;break;case"type":S=V;break;case"checked":O=V;break;case"defaultChecked":U=V;break;case"value":y=V;break;case"defaultValue":T=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(137,r));break;default:$t(s,r,h,V,c,null)}}Gp(s,y,T,O,U,S,m,!1);return;case"select":xt("invalid",s),h=S=y=null;for(m in c)if(c.hasOwnProperty(m)&&(T=c[m],T!=null))switch(m){case"value":y=T;break;case"defaultValue":S=T;break;case"multiple":h=T;default:$t(s,r,m,T,c,null)}r=y,c=S,s.multiple=!!h,r!=null?nr(s,!!h,r,!1):c!=null&&nr(s,!!h,c,!0);return;case"textarea":xt("invalid",s),y=m=h=null;for(S in c)if(c.hasOwnProperty(S)&&(T=c[S],T!=null))switch(S){case"value":h=T;break;case"defaultValue":m=T;break;case"children":y=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(i(91));break;default:$t(s,r,S,T,c,null)}Xp(s,h,m,y);return;case"option":for(O in c)if(c.hasOwnProperty(O)&&(h=c[O],h!=null))switch(O){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:$t(s,r,O,h,c,null)}return;case"dialog":xt("beforetoggle",s),xt("toggle",s),xt("cancel",s),xt("close",s);break;case"iframe":case"object":xt("load",s);break;case"video":case"audio":for(h=0;h<eo.length;h++)xt(eo[h],s);break;case"image":xt("error",s),xt("load",s);break;case"details":xt("toggle",s);break;case"embed":case"source":case"link":xt("error",s),xt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(U in c)if(c.hasOwnProperty(U)&&(h=c[U],h!=null))switch(U){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$t(s,r,U,h,c,null)}return;default:if(Du(r)){for(V in c)c.hasOwnProperty(V)&&(h=c[V],h!==void 0&&vd(s,r,V,h,c,void 0));return}}for(T in c)c.hasOwnProperty(T)&&(h=c[T],h!=null&&$t(s,r,T,h,c,null))}function sA(s,r,c,h){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,S=null,T=null,O=null,U=null,V=null;for(z in c){var Y=c[z];if(c.hasOwnProperty(z)&&Y!=null)switch(z){case"checked":break;case"value":break;case"defaultValue":O=Y;default:h.hasOwnProperty(z)||$t(s,r,z,null,h,Y)}}for(var F in h){var z=h[F];if(Y=c[F],h.hasOwnProperty(F)&&(z!=null||Y!=null))switch(F){case"type":y=z;break;case"name":m=z;break;case"checked":U=z;break;case"defaultChecked":V=z;break;case"value":S=z;break;case"defaultValue":T=z;break;case"children":case"dangerouslySetInnerHTML":if(z!=null)throw Error(i(137,r));break;default:z!==Y&&$t(s,r,F,z,h,Y)}}Mu(s,S,T,O,U,V,y,m);return;case"select":z=S=T=F=null;for(y in c)if(O=c[y],c.hasOwnProperty(y)&&O!=null)switch(y){case"value":break;case"multiple":z=O;default:h.hasOwnProperty(y)||$t(s,r,y,null,h,O)}for(m in h)if(y=h[m],O=c[m],h.hasOwnProperty(m)&&(y!=null||O!=null))switch(m){case"value":F=y;break;case"defaultValue":T=y;break;case"multiple":S=y;default:y!==O&&$t(s,r,m,y,h,O)}r=T,c=S,h=z,F!=null?nr(s,!!c,F,!1):!!h!=!!c&&(r!=null?nr(s,!!c,r,!0):nr(s,!!c,c?[]:"",!1));return;case"textarea":z=F=null;for(T in c)if(m=c[T],c.hasOwnProperty(T)&&m!=null&&!h.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:$t(s,r,T,null,h,m)}for(S in h)if(m=h[S],y=c[S],h.hasOwnProperty(S)&&(m!=null||y!=null))switch(S){case"value":F=m;break;case"defaultValue":z=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==y&&$t(s,r,S,m,h,y)}Yp(s,F,z);return;case"option":for(var it in c)if(F=c[it],c.hasOwnProperty(it)&&F!=null&&!h.hasOwnProperty(it))switch(it){case"selected":s.selected=!1;break;default:$t(s,r,it,null,h,F)}for(O in h)if(F=h[O],z=c[O],h.hasOwnProperty(O)&&F!==z&&(F!=null||z!=null))switch(O){case"selected":s.selected=F&&typeof F!="function"&&typeof F!="symbol";break;default:$t(s,r,O,F,h,z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in c)F=c[pt],c.hasOwnProperty(pt)&&F!=null&&!h.hasOwnProperty(pt)&&$t(s,r,pt,null,h,F);for(U in h)if(F=h[U],z=c[U],h.hasOwnProperty(U)&&F!==z&&(F!=null||z!=null))switch(U){case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(i(137,r));break;default:$t(s,r,U,F,h,z)}return;default:if(Du(r)){for(var qt in c)F=c[qt],c.hasOwnProperty(qt)&&F!==void 0&&!h.hasOwnProperty(qt)&&vd(s,r,qt,void 0,h,F);for(V in h)F=h[V],z=c[V],!h.hasOwnProperty(V)||F===z||F===void 0&&z===void 0||vd(s,r,V,F,h,z);return}}for(var B in c)F=c[B],c.hasOwnProperty(B)&&F!=null&&!h.hasOwnProperty(B)&&$t(s,r,B,null,h,F);for(Y in h)F=h[Y],z=c[Y],!h.hasOwnProperty(Y)||F===z||F==null&&z==null||$t(s,r,Y,F,h,z)}function Qy(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var m=c[h],y=m.transferSize,S=m.initiatorType,T=m.duration;if(y&&T&&Qy(S)){for(S=0,T=m.responseEnd,h+=1;h<c.length;h++){var O=c[h],U=O.startTime;if(U>T)break;var V=O.transferSize,Y=O.initiatorType;V&&Qy(Y)&&(O=O.responseEnd,S+=V*(O<T?1:(T-U)/(O-U)))}if(--h,r+=8*(y+S)/(m.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var bd=null,_d=null;function nc(s){return s.nodeType===9?s:s.ownerDocument}function Jy(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zy(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function wd(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Sd=null;function rA(){var s=window.event;return s&&s.type==="popstate"?s===Sd?!1:(Sd=s,!0):(Sd=null,!1)}var tv=typeof setTimeout=="function"?setTimeout:void 0,aA=typeof clearTimeout=="function"?clearTimeout:void 0,ev=typeof Promise=="function"?Promise:void 0,oA=typeof queueMicrotask=="function"?queueMicrotask:typeof ev<"u"?function(s){return ev.resolve(null).then(s).catch(lA)}:tv;function lA(s){setTimeout(function(){throw s})}function Xs(s){return s==="head"}function iv(s,r){var c=r,h=0;do{var m=c.nextSibling;if(s.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"||c==="/&"){if(h===0){s.removeChild(m),Br(r);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")so(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,so(c);for(var y=c.firstChild;y;){var S=y.nextSibling,T=y.nodeName;y[wa]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&y.rel.toLowerCase()==="stylesheet"||c.removeChild(y),y=S}}else c==="body"&&so(s.ownerDocument.body);c=m}while(c);Br(r)}function sv(s,r){var c=s;s=0;do{var h=c.nextSibling;if(c.nodeType===1?r?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(r?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=h}while(c)}function Ad(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var c=r;switch(r=r.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Ad(c),xu(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function cA(s,r,c,h){for(;s.nodeType===1;){var m=c;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[wa])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Ei(s.nextSibling),s===null)break}return null}function uA(s,r,c){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Ei(s.nextSibling),s===null))return null;return s}function nv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Ei(s.nextSibling),s===null))return null;return s}function Ed(s){return s.data==="$?"||s.data==="$~"}function Td(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function hA(s,r){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||c.readyState!=="loading")r();else{var h=function(){r(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Ei(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var Cd=null;function rv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(r===0)return Ei(s.nextSibling);r--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||r++}s=s.nextSibling}return null}function av(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(r===0)return s;r--}else c!=="/$"&&c!=="/&"||r++}s=s.previousSibling}return null}function ov(s,r,c){switch(r=nc(c),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function so(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);xu(s)}var Ti=new Map,lv=new Set;function rc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ys=q.d;q.d={f:dA,r:fA,D:pA,C:gA,L:mA,m:yA,X:bA,S:vA,M:_A};function dA(){var s=ys.f(),r=Wl();return s||r}function fA(s){var r=er(s);r!==null&&r.tag===5&&r.type==="form"?Tm(r):ys.r(s)}var Lr=typeof document>"u"?null:document;function cv(s,r,c){var h=Lr;if(h&&typeof r=="string"&&r){var m=yi(r);m='link[rel="'+s+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),lv.has(m)||(lv.add(m),s={rel:s,crossOrigin:c,href:r},h.querySelector(m)===null&&(r=h.createElement("link"),xe(r,"link",s),be(r),h.head.appendChild(r)))}}function pA(s){ys.D(s),cv("dns-prefetch",s,null)}function gA(s,r){ys.C(s,r),cv("preconnect",s,r)}function mA(s,r,c){ys.L(s,r,c);var h=Lr;if(h&&s&&r){var m='link[rel="preload"][as="'+yi(r)+'"]';r==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+yi(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+yi(c.imageSizes)+'"]')):m+='[href="'+yi(s)+'"]';var y=m;switch(r){case"style":y=Pr(s);break;case"script":y=Nr(s)}Ti.has(y)||(s=g({rel:"preload",href:r==="image"&&c&&c.imageSrcSet?void 0:s,as:r},c),Ti.set(y,s),h.querySelector(m)!==null||r==="style"&&h.querySelector(no(y))||r==="script"&&h.querySelector(ro(y))||(r=h.createElement("link"),xe(r,"link",s),be(r),h.head.appendChild(r)))}}function yA(s,r){ys.m(s,r);var c=Lr;if(c&&s){var h=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+yi(h)+'"][href="'+yi(s)+'"]',y=m;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Nr(s)}if(!Ti.has(y)&&(s=g({rel:"modulepreload",href:s},r),Ti.set(y,s),c.querySelector(m)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ro(y)))return}h=c.createElement("link"),xe(h,"link",s),be(h),c.head.appendChild(h)}}}function vA(s,r,c){ys.S(s,r,c);var h=Lr;if(h&&s){var m=ir(h).hoistableStyles,y=Pr(s);r=r||"default";var S=m.get(y);if(!S){var T={loading:0,preload:null};if(S=h.querySelector(no(y)))T.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":r},c),(c=Ti.get(y))&&Rd(s,c);var O=S=h.createElement("link");be(O),xe(O,"link",s),O._p=new Promise(function(U,V){O.onload=U,O.onerror=V}),O.addEventListener("load",function(){T.loading|=1}),O.addEventListener("error",function(){T.loading|=2}),T.loading|=4,ac(S,r,h)}S={type:"stylesheet",instance:S,count:1,state:T},m.set(y,S)}}}function bA(s,r){ys.X(s,r);var c=Lr;if(c&&s){var h=ir(c).hoistableScripts,m=Nr(s),y=h.get(m);y||(y=c.querySelector(ro(m)),y||(s=g({src:s,async:!0},r),(r=Ti.get(m))&&xd(s,r),y=c.createElement("script"),be(y),xe(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(m,y))}}function _A(s,r){ys.M(s,r);var c=Lr;if(c&&s){var h=ir(c).hoistableScripts,m=Nr(s),y=h.get(m);y||(y=c.querySelector(ro(m)),y||(s=g({src:s,async:!0,type:"module"},r),(r=Ti.get(m))&&xd(s,r),y=c.createElement("script"),be(y),xe(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(m,y))}}function uv(s,r,c,h){var m=(m=ot.current)?rc(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(r=Pr(c.href),c=ir(m).hoistableStyles,h=c.get(r),h||(h={type:"style",instance:null,count:0,state:null},c.set(r,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Pr(c.href);var y=ir(m).hoistableStyles,S=y.get(s);if(S||(m=m.ownerDocument||m,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,S),(y=m.querySelector(no(s)))&&!y._p&&(S.instance=y,S.state.loading=5),Ti.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ti.set(s,c),y||wA(m,s,c,S.state))),r&&h===null)throw Error(i(528,""));return S}if(r&&h!==null)throw Error(i(529,""));return null;case"script":return r=c.async,c=c.src,typeof c=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Nr(c),c=ir(m).hoistableScripts,h=c.get(r),h||(h={type:"script",instance:null,count:0,state:null},c.set(r,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Pr(s){return'href="'+yi(s)+'"'}function no(s){return'link[rel="stylesheet"]['+s+"]"}function hv(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function wA(s,r,c,h){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?h.loading=1:(r=s.createElement("link"),h.preload=r,r.addEventListener("load",function(){return h.loading|=1}),r.addEventListener("error",function(){return h.loading|=2}),xe(r,"link",c),be(r),s.head.appendChild(r))}function Nr(s){return'[src="'+yi(s)+'"]'}function ro(s){return"script[async]"+s}function dv(s,r,c){if(r.count++,r.instance===null)switch(r.type){case"style":var h=s.querySelector('style[data-href~="'+yi(c.href)+'"]');if(h)return r.instance=h,be(h),h;var m=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),be(h),xe(h,"style",m),ac(h,c.precedence,s),r.instance=h;case"stylesheet":m=Pr(c.href);var y=s.querySelector(no(m));if(y)return r.state.loading|=4,r.instance=y,be(y),y;h=hv(c),(m=Ti.get(m))&&Rd(h,m),y=(s.ownerDocument||s).createElement("link"),be(y);var S=y;return S._p=new Promise(function(T,O){S.onload=T,S.onerror=O}),xe(y,"link",h),r.state.loading|=4,ac(y,c.precedence,s),r.instance=y;case"script":return y=Nr(c.src),(m=s.querySelector(ro(y)))?(r.instance=m,be(m),m):(h=c,(m=Ti.get(y))&&(h=g({},c),xd(h,m)),s=s.ownerDocument||s,m=s.createElement("script"),be(m),xe(m,"link",h),s.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(h=r.instance,r.state.loading|=4,ac(h,c.precedence,s));return r.instance}function ac(s,r,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=h.length?h[h.length-1]:null,y=m,S=0;S<h.length;S++){var T=h[S];if(T.dataset.precedence===r)y=T;else if(y!==m)break}y?y.parentNode.insertBefore(s,y.nextSibling):(r=c.nodeType===9?c.head:c,r.insertBefore(s,r.firstChild))}function Rd(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function xd(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var oc=null;function fv(s,r,c){if(oc===null){var h=new Map,m=oc=new Map;m.set(c,h)}else m=oc,h=m.get(c),h||(h=new Map,m.set(c,h));if(h.has(s))return h;for(h.set(s,null),c=c.getElementsByTagName(s),m=0;m<c.length;m++){var y=c[m];if(!(y[wa]||y[Ee]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(r)||"";S=s+S;var T=h.get(S);T?T.push(y):h.set(S,[y])}}return h}function pv(s,r,c){s=s.ownerDocument||s,s.head.insertBefore(c,r==="title"?s.querySelector("head > title"):null)}function SA(s,r,c){if(c===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function gv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function AA(s,r,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var m=Pr(h.href),y=r.querySelector(no(m));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=lc.bind(s),r.then(s,s)),c.state.loading|=4,c.instance=y,be(y);return}y=r.ownerDocument||r,h=hv(h),(m=Ti.get(m))&&Rd(h,m),y=y.createElement("link"),be(y);var S=y;S._p=new Promise(function(T,O){S.onload=T,S.onerror=O}),xe(y,"link",h),c.instance=y}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,r),(r=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=lc.bind(s),r.addEventListener("load",c),r.addEventListener("error",c))}}var Od=0;function EA(s,r){return s.stylesheets&&s.count===0&&uc(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var h=setTimeout(function(){if(s.stylesheets&&uc(s,s.stylesheets),s.unsuspend){var y=s.unsuspend;s.unsuspend=null,y()}},6e4+r);0<s.imgBytes&&Od===0&&(Od=62500*nA());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&uc(s,s.stylesheets),s.unsuspend)){var y=s.unsuspend;s.unsuspend=null,y()}},(s.imgBytes>Od?50:800)+r);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(m)}}:null}function lc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)uc(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var cc=null;function uc(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,cc=new Map,r.forEach(TA,s),cc=null,lc.call(s))}function TA(s,r){if(!(r.state.loading&4)){var c=cc.get(s);if(c)var h=c.get(null);else{c=new Map,cc.set(s,c);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var S=m[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(c.set(S.dataset.precedence,S),h=S)}h&&c.set(null,h)}m=r.instance,S=m.getAttribute("data-precedence"),y=c.get(S)||h,y===h&&c.set(null,m),c.set(S,m),this.count++,h=lc.bind(this),m.addEventListener("load",h),m.addEventListener("error",h),y?y.parentNode.insertBefore(m,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),r.state.loading|=4}}var ao={$$typeof:C,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function CA(s,r,c,h,m,y,S,T,O){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Eu(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eu(0),this.hiddenUpdates=Eu(null),this.identifierPrefix=h,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function mv(s,r,c,h,m,y,S,T,O,U,V,Y){return s=new CA(s,r,c,S,O,U,V,Y,T),r=1,y===!0&&(r|=24),y=ei(3,null,null,r),s.current=y,y.stateNode=s,r=lh(),r.refCount++,s.pooledCache=r,r.refCount++,y.memoizedState={element:h,isDehydrated:c,cache:r},dh(y),s}function yv(s){return s?(s=dr,s):dr}function vv(s,r,c,h,m,y){m=yv(m),h.context===null?h.context=m:h.pendingContext=m,h=Is(r),h.payload={element:c},y=y===void 0?null:y,y!==null&&(h.callback=y),c=js(s,h,r),c!==null&&(Ve(c,s,r),ja(c,s,r))}function bv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<r?c:r}}function Md(s,r){bv(s,r),(s=s.alternate)&&bv(s,r)}function _v(s){if(s.tag===13||s.tag===31){var r=yn(s,67108864);r!==null&&Ve(r,s,67108864),Md(s,67108864)}}function wv(s){if(s.tag===13||s.tag===31){var r=ai();r=Tu(r);var c=yn(s,r);c!==null&&Ve(c,s,r),Md(s,r)}}var hc=!0;function RA(s,r,c,h){var m=N.T;N.T=null;var y=q.p;try{q.p=2,kd(s,r,c,h)}finally{q.p=y,N.T=m}}function xA(s,r,c,h){var m=N.T;N.T=null;var y=q.p;try{q.p=8,kd(s,r,c,h)}finally{q.p=y,N.T=m}}function kd(s,r,c,h){if(hc){var m=Dd(h);if(m===null)yd(s,r,h,dc,c),Av(s,h);else if(MA(m,s,r,c,h))h.stopPropagation();else if(Av(s,h),r&4&&-1<OA.indexOf(s)){for(;m!==null;){var y=er(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=dn(y.pendingLanes);if(S!==0){var T=y;for(T.pendingLanes|=2,T.entangledLanes|=2;S;){var O=1<<31-Ze(S);T.entanglements[1]|=O,S&=~O}$i(y),(jt&6)===0&&(Xl=It()+500,to(0))}}break;case 31:case 13:T=yn(y,2),T!==null&&Ve(T,y,2),Wl(),Md(y,2)}if(y=Dd(h),y===null&&yd(s,r,h,dc,c),y===m)break;m=y}m!==null&&h.stopPropagation()}else yd(s,r,h,null,c)}}function Dd(s){return s=Pu(s),Ld(s)}var dc=null;function Ld(s){if(dc=null,s=tr(s),s!==null){var r=a(s);if(r===null)s=null;else{var c=r.tag;if(c===13){if(s=o(r),s!==null)return s;s=null}else if(c===31){if(s=u(r),s!==null)return s;s=null}else if(c===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return dc=s,null}function Sv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qe()){case ya:return 2;case kp:return 8;case el:case gw:return 32;case Dp:return 268435456;default:return 32}default:return 32}}var Pd=!1,Ks=null,Ws=null,Qs=null,oo=new Map,lo=new Map,Js=[],OA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Av(s,r){switch(s){case"focusin":case"focusout":Ks=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Qs=null;break;case"pointerover":case"pointerout":oo.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":lo.delete(r.pointerId)}}function co(s,r,c,h,m,y){return s===null||s.nativeEvent!==y?(s={blockedOn:r,domEventName:c,eventSystemFlags:h,nativeEvent:y,targetContainers:[m]},r!==null&&(r=er(r),r!==null&&_v(r)),s):(s.eventSystemFlags|=h,r=s.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),s)}function MA(s,r,c,h,m){switch(r){case"focusin":return Ks=co(Ks,s,r,c,h,m),!0;case"dragenter":return Ws=co(Ws,s,r,c,h,m),!0;case"mouseover":return Qs=co(Qs,s,r,c,h,m),!0;case"pointerover":var y=m.pointerId;return oo.set(y,co(oo.get(y)||null,s,r,c,h,m)),!0;case"gotpointercapture":return y=m.pointerId,lo.set(y,co(lo.get(y)||null,s,r,c,h,m)),!0}return!1}function Ev(s){var r=tr(s.target);if(r!==null){var c=a(r);if(c!==null){if(r=c.tag,r===13){if(r=o(c),r!==null){s.blockedOn=r,jp(s.priority,function(){wv(c)});return}}else if(r===31){if(r=u(c),r!==null){s.blockedOn=r,jp(s.priority,function(){wv(c)});return}}else if(r===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function fc(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var c=Dd(s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);Lu=h,c.target.dispatchEvent(h),Lu=null}else return r=er(c),r!==null&&_v(r),s.blockedOn=c,!1;r.shift()}return!0}function Tv(s,r,c){fc(s)&&c.delete(r)}function kA(){Pd=!1,Ks!==null&&fc(Ks)&&(Ks=null),Ws!==null&&fc(Ws)&&(Ws=null),Qs!==null&&fc(Qs)&&(Qs=null),oo.forEach(Tv),lo.forEach(Tv)}function pc(s,r){s.blockedOn===r&&(s.blockedOn=null,Pd||(Pd=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,kA)))}var gc=null;function Cv(s){gc!==s&&(gc=s,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){gc===s&&(gc=null);for(var r=0;r<s.length;r+=3){var c=s[r],h=s[r+1],m=s[r+2];if(typeof h!="function"){if(Ld(h||c)===null)continue;break}var y=er(c);y!==null&&(s.splice(r,3),r-=3,Dh(y,{pending:!0,data:m,method:c.method,action:h},h,m))}}))}function Br(s){function r(O){return pc(O,s)}Ks!==null&&pc(Ks,s),Ws!==null&&pc(Ws,s),Qs!==null&&pc(Qs,s),oo.forEach(r),lo.forEach(r);for(var c=0;c<Js.length;c++){var h=Js[c];h.blockedOn===s&&(h.blockedOn=null)}for(;0<Js.length&&(c=Js[0],c.blockedOn===null);)Ev(c),c.blockedOn===null&&Js.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var m=c[h],y=c[h+1],S=m[Ue]||null;if(typeof y=="function")S||Cv(c);else if(S){var T=null;if(y&&y.hasAttribute("formAction")){if(m=y,S=y[Ue]||null)T=S.formAction;else if(Ld(m)!==null)continue}else T=S.action;typeof T=="function"?c[h+1]=T:(c.splice(h,3),h-=3),Cv(c)}}}function Rv(){function s(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return m=S})},focusReset:"manual",scroll:"manual"})}function r(){m!==null&&(m(),m=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),m!==null&&(m(),m=null)}}}function Nd(s){this._internalRoot=s}mc.prototype.render=Nd.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var c=r.current,h=ai();vv(c,h,s,r,null,null)},mc.prototype.unmount=Nd.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;vv(s.current,2,null,s,null,null),Wl(),r[Zn]=null}};function mc(s){this._internalRoot=s}mc.prototype.unstable_scheduleHydration=function(s){if(s){var r=Ip();s={blockedOn:null,target:s,priority:r};for(var c=0;c<Js.length&&r!==0&&r<Js[c].priority;c++);Js.splice(c,0,s),c===0&&Ev(s)}};var xv=t.version;if(xv!=="19.2.0")throw Error(i(527,xv,"19.2.0"));q.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(r),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var DA={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yc.isDisabled&&yc.supportsFiber)try{va=yc.inject(DA),Je=yc}catch{}}return ho.createRoot=function(s,r){if(!n(s))throw Error(i(299));var c=!1,h="",m=Nm,y=Bm,S=Im;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError)),r=mv(s,1,!1,null,null,c,h,null,m,y,S,Rv),s[Zn]=r.current,md(s),new Nd(r)},ho.hydrateRoot=function(s,r,c){if(!n(s))throw Error(i(299));var h=!1,m="",y=Nm,S=Bm,T=Im,O=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(T=c.onRecoverableError),c.formState!==void 0&&(O=c.formState)),r=mv(s,1,!0,r,c??null,h,m,O,y,S,T,Rv),r.context=yv(null),c=r.current,h=ai(),h=Tu(h),m=Is(h),m.callback=null,js(c,m,h),c=h,r.current.lanes=c,_a(r,c),$i(r),s[Zn]=r.current,md(s),new mc(r)},ho.version="19.2.0",ho}var Fv;function zA(){if(Fv)return jd.exports;Fv=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(t){console.error(t)}}return l(),jd.exports=FA(),jd.exports}var HA=zA();const $A=Gf(HA),an="__TSR_index",zv="popstate",Hv="beforeunload";function qA(l){let t=l.getLocation();const e=new Set,i=o=>{t=l.getLocation(),e.forEach(u=>u({location:t,action:o}))},n=o=>{l.notifyOnIndexChange??!0?i(o):t=l.getLocation()},a=async({task:o,navigateOpts:u,...d})=>{if(u?.ignoreBlocker??!1){o();return}const p=l.getBlockers?.()??[],g=d.type==="PUSH"||d.type==="REPLACE";if(typeof document<"u"&&p.length&&g)for(const v of p){const b=Lo(d.path,d.state);if(await v.blockerFn({currentLocation:t,nextLocation:b,action:d.type})){l.onBlocked?.();return}}o()};return{get location(){return t},get length(){return l.getLength()},subscribers:e,subscribe:o=>(e.add(o),()=>{e.delete(o)}),push:(o,u,d)=>{const f=t.state[an];u=$v(f+1,u),a({task:()=>{l.pushState(o,u),i({type:"PUSH"})},navigateOpts:d,type:"PUSH",path:o,state:u})},replace:(o,u,d)=>{const f=t.state[an];u=$v(f,u),a({task:()=>{l.replaceState(o,u),i({type:"REPLACE"})},navigateOpts:d,type:"REPLACE",path:o,state:u})},go:(o,u)=>{a({task:()=>{l.go(o),n({type:"GO",index:o})},navigateOpts:u,type:"GO"})},back:o=>{a({task:()=>{l.back(o?.ignoreBlocker??!1),n({type:"BACK"})},navigateOpts:o,type:"BACK"})},forward:o=>{a({task:()=>{l.forward(o?.ignoreBlocker??!1),n({type:"FORWARD"})},navigateOpts:o,type:"FORWARD"})},canGoBack:()=>t.state[an]!==0,createHref:o=>l.createHref(o),block:o=>{if(!l.setBlockers)return()=>{};const u=l.getBlockers?.()??[];return l.setBlockers([...u,o]),()=>{const d=l.getBlockers?.()??[];l.setBlockers?.(d.filter(f=>f!==o))}},flush:()=>l.flush?.(),destroy:()=>l.destroy?.(),notify:i}}function $v(l,t){t||(t={});const e=Yf();return{...t,key:e,__TSR_key:e,[an]:l}}function p0(l){const t=l?.window??(typeof document<"u"?window:void 0),e=t.history.pushState,i=t.history.replaceState;let n=[];const a=()=>n,o=I=>n=I,u=l?.createHref??(I=>I),d=l?.parseLocation??(()=>Lo(`${t.location.pathname}${t.location.search}${t.location.hash}`,t.history.state));if(!t.history.state?.__TSR_key&&!t.history.state?.key){const I=Yf();t.history.replaceState({[an]:0,key:I,__TSR_key:I},"")}let f=d(),p,g=!1,v=!1,b=!1,w=!1;const _=()=>f;let A,E;const R=()=>{A&&(k._ignoreSubscribers=!0,(A.isPush?t.history.pushState:t.history.replaceState)(A.state,"",A.href),k._ignoreSubscribers=!1,A=void 0,E=void 0,p=void 0)},C=(I,H,X)=>{const W=u(H);E||(p=f),f=Lo(H,X),A={href:W,state:X,isPush:A?.isPush||I==="push"},E||(E=Promise.resolve().then(()=>R()))},x=I=>{f=d(),k.notify({type:I})},D=async()=>{if(v){v=!1;return}const I=d(),H=I.state[an]-f.state[an],X=H===1,W=H===-1,et=!X&&!W||g;g=!1;const mt=et?"GO":W?"BACK":"FORWARD",ft=et?{type:"GO",index:H}:{type:W?"BACK":"FORWARD"};if(b)b=!1;else{const yt=a();if(typeof document<"u"&&yt.length){for(const N of yt)if(await N.blockerFn({currentLocation:f,nextLocation:I,action:mt})){v=!0,t.history.go(1),k.notify(ft);return}}}f=d(),k.notify(ft)},M=I=>{if(w){w=!1;return}let H=!1;const X=a();if(typeof document<"u"&&X.length)for(const W of X){const et=W.enableBeforeUnload??!0;if(et===!0){H=!0;break}if(typeof et=="function"&&et()===!0){H=!0;break}}if(H)return I.preventDefault(),I.returnValue=""},k=qA({getLocation:_,getLength:()=>t.history.length,pushState:(I,H)=>C("push",I,H),replaceState:(I,H)=>C("replace",I,H),back:I=>(I&&(b=!0),w=!0,t.history.back()),forward:I=>{I&&(b=!0),w=!0,t.history.forward()},go:I=>{g=!0,t.history.go(I)},createHref:I=>u(I),flush:R,destroy:()=>{t.history.pushState=e,t.history.replaceState=i,t.removeEventListener(Hv,M,{capture:!0}),t.removeEventListener(zv,D)},onBlocked:()=>{p&&f!==p&&(f=p)},getBlockers:a,setBlockers:o,notifyOnIndexChange:!1});return t.addEventListener(Hv,M,{capture:!0}),t.addEventListener(zv,D),t.history.pushState=function(...I){const H=e.apply(t.history,I);return k._ignoreSubscribers||x("PUSH"),H},t.history.replaceState=function(...I){const H=i.apply(t.history,I);return k._ignoreSubscribers||x("REPLACE"),H},k}function VA(l){const t=typeof document<"u"?window:void 0;return p0({window:t,parseLocation:()=>{const e=t.location.hash.split("#").slice(1),i=e[0]??"/",n=t.location.search,a=e.slice(1),o=a.length===0?"":`#${a.join("#")}`,u=`${i}${n}${o}`;return Lo(u,t.history.state)},createHref:e=>`${t.location.pathname}${t.location.search}#${e}`})}function Lo(l,t){const e=l.indexOf("#"),i=l.indexOf("?"),n=Yf();return{href:l,pathname:l.substring(0,e>0?i>0?Math.min(e,i):e:i>0?i:l.length),hash:e>-1?l.substring(e):"",search:i>-1?l.slice(i,e===-1?void 0:e):"",state:t||{[an]:0,key:n,__TSR_key:n}}}function Yf(){return(Math.random()+1).toString(36).substring(7)}const Qr=new WeakMap,Hc=new WeakMap,Yc={current:[]};let $d=!1,To=0;const _o=new Set,vc=new Map;function g0(l){const t=Array.from(l).sort((e,i)=>e instanceof Jr&&e.options.deps.includes(i)?1:i instanceof Jr&&i.options.deps.includes(e)?-1:0);for(const e of t){if(Yc.current.includes(e))continue;Yc.current.push(e),e.recompute();const i=Hc.get(e);if(i)for(const n of i){const a=Qr.get(n);a&&g0(a)}}}function GA(l){const t={prevVal:l.prevState,currentVal:l.state};for(const e of l.listeners)e(t)}function YA(l){const t={prevVal:l.prevState,currentVal:l.state};for(const e of l.listeners)e(t)}function m0(l){if(To>0&&!vc.has(l)&&vc.set(l,l.prevState),_o.add(l),!(To>0)&&!$d)try{for($d=!0;_o.size>0;){const t=Array.from(_o);_o.clear();for(const e of t){const i=vc.get(e)??e.prevState;e.prevState=i,GA(e)}for(const e of t){const i=Qr.get(e);i&&(Yc.current.push(e),g0(i))}for(const e of t){const i=Qr.get(e);if(i)for(const n of i)YA(n)}}}finally{$d=!1,Yc.current=[],vc.clear()}}function Co(l){To++;try{l()}finally{if(To--,To===0){const t=_o.values().next().value;t&&m0(t)}}}function XA(l){return typeof l=="function"}class vf{constructor(t,e){this.listeners=new Set,this.subscribe=i=>{var n,a;this.listeners.add(i);const o=(a=(n=this.options)==null?void 0:n.onSubscribe)==null?void 0:a.call(n,i,this);return()=>{this.listeners.delete(i),o?.()}},this.prevState=t,this.state=t,this.options=e}setState(t){var e,i,n;this.prevState=this.state,(e=this.options)!=null&&e.updateFn?this.state=this.options.updateFn(this.prevState)(t):XA(t)?this.state=t(this.prevState):this.state=t,(n=(i=this.options)==null?void 0:i.onUpdate)==null||n.call(i),m0(this)}}class Jr{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const e=this.options.deps.length,i=new Array(e),n=new Array(e);for(let a=0;a<e;a++){const o=this.options.deps[a];i[a]=o.prevState,n[a]=o.state}return this.lastSeenDepValues=n,{prevDepVals:i,currDepVals:n,prevVal:this.prevState??void 0}},this.recompute=()=>{var e,i;this.prevState=this.state;const n=this.getDepVals();this.state=this.options.fn(n),(i=(e=this.options).onUpdate)==null||i.call(e)},this.checkIfRecalculationNeededDeeply=()=>{for(const a of this.options.deps)a instanceof Jr&&a.checkIfRecalculationNeededDeeply();let e=!1;const i=this.lastSeenDepValues,{currDepVals:n}=this.getDepVals();for(let a=0;a<n.length;a++)if(n[a]!==i[a]){e=!0;break}e&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const e of this._subscriptions)e()}),this.subscribe=e=>{var i,n;this.listeners.add(e);const a=(n=(i=this.options).onSubscribe)==null?void 0:n.call(i,e,this);return()=>{this.listeners.delete(e),a?.()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const e of t)if(e instanceof Jr)e.registerOnGraph(),this.registerOnGraph(e.options.deps);else if(e instanceof vf){let i=Qr.get(e);i||(i=new Set,Qr.set(e,i)),i.add(this);let n=Hc.get(this);n||(n=new Set,Hc.set(this,n)),n.add(e)}}unregisterFromGraph(t=this.options.deps){for(const e of t)if(e instanceof Jr)this.unregisterFromGraph(e.options.deps);else if(e instanceof vf){const i=Qr.get(e);i&&i.delete(this);const n=Hc.get(this);n&&n.delete(e)}}}function bf(l){return l[l.length-1]}function KA(l){return typeof l=="function"}function zn(l,t){return KA(l)?l(t):l}const WA=Object.prototype.hasOwnProperty;function xi(l,t){if(l===t)return l;const e=t,i=Gv(l)&&Gv(e);if(!i&&!(Xc(l)&&Xc(e)))return e;const n=i?l:qv(l);if(!n)return e;const a=i?e:qv(e);if(!a)return e;const o=n.length,u=a.length,d=i?new Array(u):{};let f=0;for(let p=0;p<u;p++){const g=i?p:a[p],v=l[g],b=e[g];if(v===b){d[g]=v,(i?p<o:WA.call(l,g))&&f++;continue}if(v===null||b===null||typeof v!="object"||typeof b!="object"){d[g]=b;continue}const w=xi(v,b);d[g]=w,w===v&&f++}return o===u&&f===o?l:d}function qv(l){const t=[],e=Object.getOwnPropertyNames(l);for(const n of e){if(!Object.prototype.propertyIsEnumerable.call(l,n))return!1;t.push(n)}const i=Object.getOwnPropertySymbols(l);for(const n of i){if(!Object.prototype.propertyIsEnumerable.call(l,n))return!1;t.push(n)}return t}function Xc(l){if(!Vv(l))return!1;const t=l.constructor;if(typeof t>"u")return!0;const e=t.prototype;return!(!Vv(e)||!e.hasOwnProperty("isPrototypeOf"))}function Vv(l){return Object.prototype.toString.call(l)==="[object Object]"}function Gv(l){return Array.isArray(l)&&l.length===Object.keys(l).length}function Hn(l,t,e){if(l===t)return!0;if(typeof l!=typeof t)return!1;if(Array.isArray(l)&&Array.isArray(t)){if(l.length!==t.length)return!1;for(let i=0,n=l.length;i<n;i++)if(!Hn(l[i],t[i],e))return!1;return!0}if(Xc(l)&&Xc(t)){const i=e?.ignoreUndefined??!0;if(e?.partial){for(const o in t)if((!i||t[o]!==void 0)&&!Hn(l[o],t[o],e))return!1;return!0}let n=0;if(!i)n=Object.keys(l).length;else for(const o in l)l[o]!==void 0&&n++;let a=0;for(const o in t)if((!i||t[o]!==void 0)&&(a++,a>n||!Hn(l[o],t[o],e)))return!1;return n===a}return!1}function na(l){let t,e;const i=new Promise((n,a)=>{t=n,e=a});return i.status="pending",i.resolve=n=>{i.status="resolved",i.value=n,t(n),l?.(n)},i.reject=n=>{i.status="rejected",e(n)},i}function QA(l){return typeof l?.message!="string"?!1:l.message.startsWith("Failed to fetch dynamically imported module")||l.message.startsWith("error loading dynamically imported module")||l.message.startsWith("Importing a module script failed")}function on(l){return!!(l&&typeof l=="object"&&typeof l.then=="function")}var JA="Invariant failed";function As(l,t){if(!l)throw new Error(JA)}const Ke="__root__",Ji=0,Vn=1,ra=2,aa=3;function Ss(l){return Xf(l.filter(t=>t!==void 0).join("/"))}function Xf(l){return l.replace(/\/{2,}/g,"/")}function Kf(l){return l==="/"?l:l.replace(/^\/{1,}/,"")}function ln(l){return l==="/"?l:l.replace(/\/{1,}$/,"")}function $c(l){return ln(Kf(l))}function Kc(l,t){return l?.endsWith("/")&&l!=="/"&&l!==`${t}/`?l.slice(0,-1):l}function ZA(l,t,e){return Kc(l,e)===Kc(t,e)}function tE(l){const{type:t,value:e}=l;if(t===Ji)return e;const{prefixSegment:i,suffixSegment:n}=l;if(t===Vn){const a=e.substring(1);if(i&&n)return`${i}{$${a}}${n}`;if(i)return`${i}{$${a}}`;if(n)return`{$${a}}${n}`}if(t===aa){const a=e.substring(1);return i&&n?`${i}{-$${a}}${n}`:i?`${i}{-$${a}}`:n?`{-$${a}}${n}`:`{-$${a}}`}if(t===ra){if(i&&n)return`${i}{$}${n}`;if(i)return`${i}{$}`;if(n)return`{$}${n}`}return e}function eE({base:l,to:t,trailingSlash:e="never",parseCache:i}){let n=y0(l,i).slice();const a=cu(t,i);n.length>1&&bf(n)?.value==="/"&&n.pop();for(let d=0,f=a.length;d<f;d++){const p=a[d],g=p.value;g==="/"?d?d===f-1&&n.push(p):n=[p]:g===".."?n.pop():g==="."||n.push(p)}n.length>1&&(bf(n).value==="/"?e==="never"&&n.pop():e==="always"&&n.push({type:Ji,value:"/"}));const o=n.map(tE);return Ss(o)}const y0=(l,t)=>v0(l,t,!0),cu=(l,t)=>v0(l,t,!1),v0=(l,t,e)=>{if(!l)return[];const i=t?.get(l);if(i)return i;const n=oE(l,e);return t?.set(l,n),n},iE=/^\$.{1,}$/,sE=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,nE=/^(.*?)\{-(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,rE=/^\$$/,aE=/^(.*?)\{\$\}(.*)$/;function oE(l,t){l=Xf(l);const e=[];if(l.slice(0,1)==="/"&&(l=l.substring(1),e.push({type:Ji,value:"/"})),!l)return e;const i=l.split("/").filter(Boolean);return e.push(...i.map(n=>{const a=!t&&n!==Ke&&n.slice(-1)==="_"?n.slice(0,-1):n,o=a.match(aE);if(o){const f=o[1],p=o[2];return{type:ra,value:"$",prefixSegment:f||void 0,suffixSegment:p||void 0}}const u=a.match(nE);if(u){const f=u[1],p=u[2],g=u[3];return{type:aa,value:p,prefixSegment:f||void 0,suffixSegment:g||void 0}}const d=a.match(sE);if(d){const f=d[1],p=d[2],g=d[3];return{type:Vn,value:""+p,prefixSegment:f||void 0,suffixSegment:g||void 0}}if(iE.test(a)){const f=a.substring(1);return{type:Vn,value:"$"+f,prefixSegment:void 0,suffixSegment:void 0}}return rE.test(a)?{type:ra,value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:Ji,value:a.includes("%25")?a.split("%25").map(f=>decodeURI(f)).join("%25"):decodeURI(a)}})),l.slice(-1)==="/"&&(l=l.substring(1),e.push({type:Ji,value:"/"})),e}function bc({path:l,params:t,leaveWildcards:e,leaveParams:i,decodeCharMap:n,parseCache:a}){const o=cu(l,a);function u(g){const v=t[g],b=typeof v=="string";return g==="*"||g==="_splat"?b?encodeURI(v):v:b?lE(v,n):v}let d=!1;const f={},p=Ss(o.map(g=>{if(g.type===Ji)return g.value;if(g.type===ra){f._splat=t._splat,f["*"]=t._splat;const v=g.prefixSegment||"",b=g.suffixSegment||"";if(!t._splat)return d=!0,e?`${v}${g.value}${b}`:v||b?`${v}${b}`:void 0;const w=u("_splat");return e?`${v}${g.value}${w??""}${b}`:`${v}${w}${b}`}if(g.type===Vn){const v=g.value.substring(1);!d&&!(v in t)&&(d=!0),f[v]=t[v];const b=g.prefixSegment||"",w=g.suffixSegment||"";if(i){const _=u(g.value);return`${b}${g.value}${_??""}${w}`}return`${b}${u(v)??"undefined"}${w}`}if(g.type===aa){const v=g.value.substring(1),b=g.prefixSegment||"",w=g.suffixSegment||"";if(!(v in t)||t[v]==null)return e?`${b}${v}${w}`:b||w?`${b}${w}`:void 0;if(f[v]=t[v],i){const _=u(g.value);return`${b}${g.value}${_??""}${w}`}return e?`${b}${v}${u(v)??""}${w}`:`${b}${u(v)??""}${w}`}return g.value}));return{usedParams:f,interpolatedPath:p,isMissingParams:d}}function lE(l,t){let e=encodeURIComponent(l);if(t)for(const[i,n]of t)e=e.replaceAll(i,n);return e}function _f(l,t,e){const i=cE(l,t,e);if(!(t.to&&!i))return i??{}}function cE(l,{to:t,fuzzy:e,caseSensitive:i},n){const a=t,o=y0(l.startsWith("/")?l:`/${l}`,n),u=cu(a.startsWith("/")?a:`/${a}`,n),d={};return uE(o,u,d,e,i)?d:void 0}function uE(l,t,e,i,n){let a=0,o=0;for(;a<l.length||o<t.length;){const u=l[a],d=t[o];if(d){if(d.type===ra){const f=l.slice(a);let p;if(d.prefixSegment||d.suffixSegment){if(!u)return!1;const g=d.prefixSegment||"",v=d.suffixSegment||"",b=u.value;if("prefixSegment"in d&&!b.startsWith(g)||"suffixSegment"in d&&!l[l.length-1]?.value.endsWith(v))return!1;let w=decodeURI(Ss(f.map(_=>_.value)));g&&w.startsWith(g)&&(w=w.slice(g.length)),v&&w.endsWith(v)&&(w=w.slice(0,w.length-v.length)),p=w}else p=decodeURI(Ss(f.map(g=>g.value)));return e["*"]=p,e._splat=p,!0}if(d.type===Ji){if(d.value==="/"&&!u?.value){o++;continue}if(u){if(n){if(d.value!==u.value)return!1}else if(d.value.toLowerCase()!==u.value.toLowerCase())return!1;a++,o++;continue}else return!1}if(d.type===Vn){if(!u||u.value==="/")return!1;let f="",p=!1;if(d.prefixSegment||d.suffixSegment){const g=d.prefixSegment||"",v=d.suffixSegment||"",b=u.value;if(g&&!b.startsWith(g)||v&&!b.endsWith(v))return!1;let w=b;g&&w.startsWith(g)&&(w=w.slice(g.length)),v&&w.endsWith(v)&&(w=w.slice(0,w.length-v.length)),f=decodeURIComponent(w),p=!0}else f=decodeURIComponent(u.value),p=!0;p&&(e[d.value.substring(1)]=f,a++),o++;continue}if(d.type===aa){if(!u){o++;continue}if(u.value==="/"){o++;continue}let f="",p=!1;if(d.prefixSegment||d.suffixSegment){const g=d.prefixSegment||"",v=d.suffixSegment||"",b=u.value;if((!g||b.startsWith(g))&&(!v||b.endsWith(v))){let w=b;g&&w.startsWith(g)&&(w=w.slice(g.length)),v&&w.endsWith(v)&&(w=w.slice(0,w.length-v.length)),f=decodeURIComponent(w),p=!0}}else{let g=!0;for(let v=o+1;v<t.length;v++){const b=t[v];if(b?.type===Ji&&b.value===u.value){g=!1;break}if(b?.type===Vn||b?.type===ra){l.length<t.length&&(g=!1);break}}g&&(f=decodeURIComponent(u.value),p=!0)}p&&(e[d.value.substring(1)]=f,a++),o++;continue}}if(a<l.length&&o>=t.length)return e["**"]=Ss(l.slice(a).map(f=>f.value)),!!i&&t[t.length-1]?.value!=="/";if(o<t.length&&a>=l.length){for(let f=o;f<t.length;f++)if(t[f]?.type!==aa)return!1;break}break}return!0}const hE=.75,dE=1,fE=.5,pE=.4,gE=.25,mE=.2,yE=.05,vE=.02,bE=.01,Yv=2e-4,Xv=1e-4;function Kv(l,t){return l.prefixSegment&&l.suffixSegment?t+yE+Yv*l.prefixSegment.length+Xv*l.suffixSegment.length:l.prefixSegment?t+vE+Yv*l.prefixSegment.length:l.suffixSegment?t+bE+Xv*l.suffixSegment.length:t}function _E(l){const t=[];return l.forEach((i,n)=>{if(i.isRoot||!i.path)return;const a=Kf(i.fullPath);let o=cu(a),u=0;for(;o.length>u+1&&o[u]?.value==="/";)u++;u>0&&(o=o.slice(u));let d=0,f=!1;const p=o.map((g,v)=>{if(g.value==="/")return hE;if(g.type===Ji)return dE;let b;g.type===Vn?b=fE:g.type===aa?(b=pE,d++):b=gE;for(let w=v+1;w<o.length;w++){const _=o[w];if(_.type===Ji&&_.value!=="/")return f=!0,Kv(g,b+mE)}return Kv(g,b)});t.push({child:i,trimmed:a,parsed:o,index:n,scores:p,optionalParamCount:d,hasStaticAfter:f})}),t.sort((i,n)=>{const a=Math.min(i.scores.length,n.scores.length);for(let o=0;o<a;o++)if(i.scores[o]!==n.scores[o])return n.scores[o]-i.scores[o];if(i.scores.length!==n.scores.length){if(i.optionalParamCount!==n.optionalParamCount){if(i.hasStaticAfter===n.hasStaticAfter)return i.optionalParamCount-n.optionalParamCount;if(i.hasStaticAfter&&!n.hasStaticAfter)return-1;if(!i.hasStaticAfter&&n.hasStaticAfter)return 1}return n.scores.length-i.scores.length}for(let o=0;o<a;o++)if(i.parsed[o].value!==n.parsed[o].value)return i.parsed[o].value>n.parsed[o].value?1:-1;return i.index-n.index}).map((i,n)=>(i.child.rank=n,i.child))}function wE({routeTree:l,initRoute:t}){const e={},i={},n=o=>{o.forEach((u,d)=>{t?.(u,d);const f=e[u.id];if(As(!f,`Duplicate routes found with id: ${String(u.id)}`),e[u.id]=u,!u.isRoot&&u.path){const g=ln(u.fullPath);(!i[g]||u.fullPath.endsWith("/"))&&(i[g]=u)}const p=u.children;p?.length&&n(p)})};n([l]);const a=_E(Object.values(e));return{routesById:e,routesByPath:i,flatRoutes:a}}function ji(l){return!!l?.isNotFound}function SE(){try{if(typeof window<"u"&&typeof window.sessionStorage=="object")return window.sessionStorage}catch{}}const Wc="tsr-scroll-restoration-v1_3",AE=(l,t)=>{let e;return(...i)=>{e||(e=setTimeout(()=>{l(...i),e=null},t))}};function EE(){const l=SE();if(!l)return null;const t=l.getItem(Wc);let e=t?JSON.parse(t):{};return{state:e,set:i=>(e=zn(i,e)||e,l.setItem(Wc,JSON.stringify(e)))}}const _c=EE(),wf=l=>l.state.__TSR_key||l.href;function TE(l){const t=[];let e;for(;e=l.parentNode;)t.push(`${l.tagName}:nth-child(${Array.prototype.indexOf.call(e.children,l)+1})`),l=e;return`${t.reverse().join(" > ")}`.toLowerCase()}let Qc=!1;function b0({storageKey:l,key:t,behavior:e,shouldScrollRestoration:i,scrollToTopSelectors:n,location:a}){let o;try{o=JSON.parse(sessionStorage.getItem(l)||"{}")}catch(f){console.error(f);return}const u=t||window.history.state?.__TSR_key,d=o[u];Qc=!0;t:{if(i&&d&&Object.keys(d).length>0){for(const g in d){const v=d[g];if(g==="window")window.scrollTo({top:v.scrollY,left:v.scrollX,behavior:e});else if(g){const b=document.querySelector(g);b&&(b.scrollLeft=v.scrollX,b.scrollTop=v.scrollY)}}break t}const f=(a??window.location).hash.split("#",2)[1];if(f){const g=window.history.state?.__hashScrollIntoViewOptions??!0;if(g){const v=document.getElementById(f);v&&v.scrollIntoView(g)}break t}const p={top:0,left:0,behavior:e};if(window.scrollTo(p),n)for(const g of n){if(g==="window")continue;const v=typeof g=="function"?g():document.querySelector(g);v&&v.scrollTo(p)}}Qc=!1}function CE(l,t){if(!_c&&!l.isServer||((l.options.scrollRestoration??!1)&&(l.isScrollRestoring=!0),l.isServer||l.isScrollRestorationSetup||!_c))return;l.isScrollRestorationSetup=!0,Qc=!1;const i=l.options.getScrollRestorationKey||wf;window.history.scrollRestoration="manual";const n=a=>{if(Qc||!l.isScrollRestoring)return;let o="";if(a.target===document||a.target===window)o="window";else{const d=a.target.getAttribute("data-scroll-restoration-id");d?o=`[data-scroll-restoration-id="${d}"]`:o=TE(a.target)}const u=i(l.state.location);_c.set(d=>{const f=d[u]||={},p=f[o]||={};if(o==="window")p.scrollX=window.scrollX||0,p.scrollY=window.scrollY||0;else if(o){const g=document.querySelector(o);g&&(p.scrollX=g.scrollLeft||0,p.scrollY=g.scrollTop||0)}return d})};typeof document<"u"&&document.addEventListener("scroll",AE(n,100),!0),l.subscribe("onRendered",a=>{const o=i(a.toLocation);if(!l.resetNextScroll){l.resetNextScroll=!0;return}typeof l.options.scrollRestoration=="function"&&!l.options.scrollRestoration({location:l.latestLocation})||(b0({storageKey:Wc,key:o,behavior:l.options.scrollRestorationBehavior,shouldScrollRestoration:l.isScrollRestoring,scrollToTopSelectors:l.options.scrollToTopSelectors,location:l.history.location}),l.isScrollRestoring&&_c.set(u=>(u[o]||={},u)))})}function RE(l){if(typeof document<"u"&&document.querySelector){const t=l.state.location.state.__hashScrollIntoViewOptions??!0;if(t&&l.state.location.hash!==""){const e=document.getElementById(l.state.location.hash);e&&e.scrollIntoView(t)}}}function xE(l,t=String){const e=new URLSearchParams;for(const i in l){const n=l[i];n!==void 0&&e.set(i,t(n))}return e.toString()}function qd(l){return l?l==="false"?!1:l==="true"?!0:+l*0===0&&+l+""===l?+l:l:""}function OE(l){const t=new URLSearchParams(l),e={};for(const[i,n]of t.entries()){const a=e[i];a==null?e[i]=qd(n):Array.isArray(a)?a.push(qd(n)):e[i]=[a,qd(n)]}return e}const ME=DE(JSON.parse),kE=LE(JSON.stringify,JSON.parse);function DE(l){return t=>{t[0]==="?"&&(t=t.substring(1));const e=OE(t);for(const i in e){const n=e[i];if(typeof n=="string")try{e[i]=l(n)}catch{}}return e}}function LE(l,t){const e=typeof t=="function";function i(n){if(typeof n=="object"&&n!==null)try{return l(n)}catch{}else if(e&&typeof n=="string")try{return t(n),l(n)}catch{}return n}return n=>{const a=xE(n,i);return a?`?${a}`:""}}function PE(l){if(l.statusCode=l.statusCode||l.code||307,!l.reloadDocument&&typeof l.href=="string")try{new URL(l.href),l.reloadDocument=!0}catch{}const t=new Headers(l.headers);l.href&&t.get("Location")===null&&t.set("Location",l.href);const e=new Response(null,{status:l.statusCode,headers:t});if(e.options=l,l.throw)throw e;return e}function Qi(l){return l instanceof Response&&!!l.options}function NE(l){const t=new Map;let e,i;const n=a=>{a.next&&(a.prev?(a.prev.next=a.next,a.next.prev=a.prev,a.next=void 0,i&&(i.next=a,a.prev=i)):(a.next.prev=void 0,e=a.next,a.next=void 0,i&&(a.prev=i,i.next=a)),i=a)};return{get(a){const o=t.get(a);if(o)return n(o),o.value},set(a,o){if(t.size>=l&&e){const d=e;t.delete(d.key),d.next&&(e=d.next,d.next.prev=void 0),d===i&&(i=void 0)}const u=t.get(a);if(u)u.value=o,n(u);else{const d={key:a,value:o,prev:i};i&&(i.next=d),i=d,e||(e=d),t.set(a,d)}}}}const qc=l=>{if(!l.rendered)return l.rendered=!0,l.onReady?.()},uu=(l,t)=>!!(l.preload&&!l.router.state.matches.some(e=>e.id===t)),_0=(l,t)=>{const e=l.router.routesById[t.routeId??""]??l.router.routeTree;!e.options.notFoundComponent&&l.router.options?.defaultNotFoundComponent&&(e.options.notFoundComponent=l.router.options.defaultNotFoundComponent),As(e.options.notFoundComponent);const i=l.matches.find(n=>n.routeId===e.id);As(i,"Could not find match for route: "+e.id),l.updateMatch(i.id,n=>({...n,status:"notFound",error:t,isFetching:!1})),t.routerCode==="BEFORE_LOAD"&&e.parentRoute&&(t.routeId=e.parentRoute.id,_0(l,t))},rn=(l,t,e)=>{if(!(!Qi(e)&&!ji(e))){if(Qi(e)&&e.redirectHandled&&!e.options.reloadDocument)throw e;if(t){t._nonReactive.beforeLoadPromise?.resolve(),t._nonReactive.loaderPromise?.resolve(),t._nonReactive.beforeLoadPromise=void 0,t._nonReactive.loaderPromise=void 0;const i=Qi(e)?"redirected":"notFound";l.updateMatch(t.id,n=>({...n,status:i,isFetching:!1,error:e})),ji(e)&&!e.routeId&&(e.routeId=t.routeId),t._nonReactive.loadPromise?.resolve()}throw Qi(e)?(l.rendered=!0,e.options._fromLocation=l.location,e.redirectHandled=!0,e=l.router.resolveRedirect(e),e):(_0(l,e),e)}},w0=(l,t)=>{const e=l.router.getMatch(t);return!!(!l.router.isServer&&e._nonReactive.dehydrated||l.router.isServer&&e.ssr===!1)},fo=(l,t,e,i)=>{const{id:n,routeId:a}=l.matches[t],o=l.router.looseRoutesById[a];if(e instanceof Promise)throw e;e.routerCode=i,l.firstBadMatchIndex??=t,rn(l,l.router.getMatch(n),e);try{o.options.onError?.(e)}catch(u){e=u,rn(l,l.router.getMatch(n),e)}l.updateMatch(n,u=>(u._nonReactive.beforeLoadPromise?.resolve(),u._nonReactive.beforeLoadPromise=void 0,u._nonReactive.loadPromise?.resolve(),{...u,error:e,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController}))},BE=(l,t,e,i)=>{const n=l.router.getMatch(t),a=l.matches[e-1]?.id,o=a?l.router.getMatch(a):void 0;if(l.router.isShell()){n.ssr=t===Ke;return}if(o?.ssr===!1){n.ssr=!1;return}const u=b=>b===!0&&o?.ssr==="data-only"?"data-only":b,d=l.router.options.defaultSsr??!0;if(i.options.ssr===void 0){n.ssr=u(d);return}if(typeof i.options.ssr!="function"){n.ssr=u(i.options.ssr);return}const{search:f,params:p}=n,g={search:wc(f,n.searchError),params:wc(p,n.paramsError),location:l.location,matches:l.matches.map(b=>({index:b.index,pathname:b.pathname,fullPath:b.fullPath,staticData:b.staticData,id:b.id,routeId:b.routeId,search:wc(b.search,b.searchError),params:wc(b.params,b.paramsError),ssr:b.ssr}))},v=i.options.ssr(g);if(on(v))return v.then(b=>{n.ssr=u(b??d)});n.ssr=u(v??d)},S0=(l,t,e,i)=>{if(i._nonReactive.pendingTimeout!==void 0)return;const n=e.options.pendingMs??l.router.options.defaultPendingMs;if(!!(l.onReady&&!l.router.isServer&&!uu(l,t)&&(e.options.loader||e.options.beforeLoad||T0(e))&&typeof n=="number"&&n!==1/0&&(e.options.pendingComponent??l.router.options?.defaultPendingComponent))){const o=setTimeout(()=>{qc(l)},n);i._nonReactive.pendingTimeout=o}},IE=(l,t,e)=>{const i=l.router.getMatch(t);if(!i._nonReactive.beforeLoadPromise&&!i._nonReactive.loaderPromise)return;S0(l,t,e,i);const n=()=>{const a=l.router.getMatch(t);a.preload&&(a.status==="redirected"||a.status==="notFound")&&rn(l,a,a.error)};return i._nonReactive.beforeLoadPromise?i._nonReactive.beforeLoadPromise.then(n):n()},jE=(l,t,e,i)=>{const n=l.router.getMatch(t),a=n._nonReactive.loadPromise;n._nonReactive.loadPromise=na(()=>{a?.resolve()});const{paramsError:o,searchError:u}=n;o&&fo(l,e,o,"PARSE_PARAMS"),u&&fo(l,e,u,"VALIDATE_SEARCH"),S0(l,t,i,n);const d=new AbortController,f=l.matches[e-1]?.id,v={...(f?l.router.getMatch(f):void 0)?.context??l.router.options.context??void 0,...n.__routeContext};let b=!1;const w=()=>{b||(b=!0,l.updateMatch(t,k=>({...k,isFetching:"beforeLoad",fetchCount:k.fetchCount+1,abortController:d,context:v})))},_=()=>{n._nonReactive.beforeLoadPromise?.resolve(),n._nonReactive.beforeLoadPromise=void 0,l.updateMatch(t,k=>({...k,isFetching:!1}))};if(!i.options.beforeLoad){Co(()=>{w(),_()});return}n._nonReactive.beforeLoadPromise=na();const{search:A,params:E,cause:R}=n,C=uu(l,t),x={search:A,abortController:d,params:E,preload:C,context:v,location:l.location,navigate:k=>l.router.navigate({...k,_fromLocation:l.location}),buildLocation:l.router.buildLocation,cause:C?"preload":R,matches:l.matches,...l.router.options.additionalContext},D=k=>{if(k===void 0){Co(()=>{w(),_()});return}(Qi(k)||ji(k))&&(w(),fo(l,e,k,"BEFORE_LOAD")),Co(()=>{w(),l.updateMatch(t,I=>({...I,__beforeLoadContext:k,context:{...I.context,...k}})),_()})};let M;try{if(M=i.options.beforeLoad(x),on(M))return w(),M.catch(k=>{fo(l,e,k,"BEFORE_LOAD")}).then(D)}catch(k){w(),fo(l,e,k,"BEFORE_LOAD")}D(M)},UE=(l,t)=>{const{id:e,routeId:i}=l.matches[t],n=l.router.looseRoutesById[i],a=()=>{if(l.router.isServer){const d=BE(l,e,t,n);if(on(d))return d.then(u)}return u()},o=()=>jE(l,e,t,n),u=()=>{if(w0(l,e))return;const d=IE(l,e,n);return on(d)?d.then(o):o()};return a()},Ro=(l,t,e)=>{const i=l.router.getMatch(t);if(!i||!e.options.head&&!e.options.scripts&&!e.options.headers)return;const n={matches:l.matches,match:i,params:i.params,loaderData:i.loaderData};return Promise.all([e.options.head?.(n),e.options.scripts?.(n),e.options.headers?.(n)]).then(([a,o,u])=>{const d=a?.meta,f=a?.links,p=a?.scripts,g=a?.styles;return{meta:d,links:f,headScripts:p,headers:u,scripts:o,styles:g}})},A0=(l,t,e,i)=>{const n=l.matchPromises[e-1],{params:a,loaderDeps:o,abortController:u,context:d,cause:f}=l.router.getMatch(t),p=uu(l,t);return{params:a,deps:o,preload:!!p,parentMatchPromise:n,abortController:u,context:d,location:l.location,navigate:g=>l.router.navigate({...g,_fromLocation:l.location}),cause:p?"preload":f,route:i,...l.router.options.additionalContext}},Wv=async(l,t,e,i)=>{try{const n=l.router.getMatch(t);try{(!l.router.isServer||n.ssr===!0)&&E0(i);const a=i.options.loader?.(A0(l,t,e,i)),o=i.options.loader&&on(a);if(!!(o||i._lazyPromise||i._componentsPromise||i.options.head||i.options.scripts||i.options.headers||n._nonReactive.minPendingPromise)&&l.updateMatch(t,g=>({...g,isFetching:"loader"})),i.options.loader){const g=o?await a:a;rn(l,l.router.getMatch(t),g),g!==void 0&&l.updateMatch(t,v=>({...v,loaderData:g}))}i._lazyPromise&&await i._lazyPromise;const d=Ro(l,t,i),f=d?await d:void 0,p=n._nonReactive.minPendingPromise;p&&await p,i._componentsPromise&&await i._componentsPromise,l.updateMatch(t,g=>({...g,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),...f}))}catch(a){let o=a;const u=n._nonReactive.minPendingPromise;u&&await u,ji(a)&&await i.options.notFoundComponent?.preload?.(),rn(l,l.router.getMatch(t),a);try{i.options.onError?.(a)}catch(p){o=p,rn(l,l.router.getMatch(t),p)}const d=Ro(l,t,i),f=d?await d:void 0;l.updateMatch(t,p=>({...p,error:o,status:"error",isFetching:!1,...f}))}}catch(n){const a=l.router.getMatch(t);if(a){const o=Ro(l,t,i);if(o){const u=await o;l.updateMatch(t,d=>({...d,...u}))}a._nonReactive.loaderPromise=void 0}rn(l,a,n)}},FE=async(l,t)=>{const{id:e,routeId:i}=l.matches[t];let n=!1,a=!1;const o=l.router.looseRoutesById[i];if(w0(l,e)){if(l.router.isServer){const f=Ro(l,e,o);if(f){const p=await f;l.updateMatch(e,g=>({...g,...p}))}return l.router.getMatch(e)}}else{const f=l.router.getMatch(e);if(f._nonReactive.loaderPromise){if(f.status==="success"&&!l.sync&&!f.preload)return f;await f._nonReactive.loaderPromise;const p=l.router.getMatch(e);p.error&&rn(l,p,p.error)}else{const p=Date.now()-f.updatedAt,g=uu(l,e),v=g?o.options.preloadStaleTime??l.router.options.defaultPreloadStaleTime??3e4:o.options.staleTime??l.router.options.defaultStaleTime??0,b=o.options.shouldReload,w=typeof b=="function"?b(A0(l,e,t,o)):b,_=!!g&&!l.router.state.matches.some(C=>C.id===e),A=l.router.getMatch(e);A._nonReactive.loaderPromise=na(),_!==A.preload&&l.updateMatch(e,C=>({...C,preload:_}));const{status:E,invalid:R}=A;if(n=E==="success"&&(R||(w??p>v)),!(g&&o.options.preload===!1))if(n&&!l.sync)a=!0,(async()=>{try{await Wv(l,e,t,o);const C=l.router.getMatch(e);C._nonReactive.loaderPromise?.resolve(),C._nonReactive.loadPromise?.resolve(),C._nonReactive.loaderPromise=void 0}catch(C){Qi(C)&&await l.router.navigate(C.options)}})();else if(E!=="success"||n&&l.sync)await Wv(l,e,t,o);else{const C=Ro(l,e,o);if(C){const x=await C;l.updateMatch(e,D=>({...D,...x}))}}}}const u=l.router.getMatch(e);a||(u._nonReactive.loaderPromise?.resolve(),u._nonReactive.loadPromise?.resolve()),clearTimeout(u._nonReactive.pendingTimeout),u._nonReactive.pendingTimeout=void 0,a||(u._nonReactive.loaderPromise=void 0),u._nonReactive.dehydrated=void 0;const d=a?u.isFetching:!1;return d!==u.isFetching||u.invalid!==!1?(l.updateMatch(e,f=>({...f,isFetching:d,invalid:!1})),l.router.getMatch(e)):u};async function Qv(l){const t=Object.assign(l,{matchPromises:[]});!t.router.isServer&&t.router.state.matches.some(e=>e._forcePending)&&qc(t);try{for(let n=0;n<t.matches.length;n++){const a=UE(t,n);on(a)&&await a}const e=t.firstBadMatchIndex??t.matches.length;for(let n=0;n<e;n++)t.matchPromises.push(FE(t,n));await Promise.all(t.matchPromises);const i=qc(t);on(i)&&await i}catch(e){if(ji(e)&&!t.preload){const i=qc(t);throw on(i)&&await i,e}if(Qi(e))throw e}return t.matches}async function E0(l){if(!l._lazyLoaded&&l._lazyPromise===void 0&&(l.lazyFn?l._lazyPromise=l.lazyFn().then(t=>{const{id:e,...i}=t.options;Object.assign(l.options,i),l._lazyLoaded=!0,l._lazyPromise=void 0}):l._lazyLoaded=!0),!l._componentsLoaded&&l._componentsPromise===void 0){const t=()=>{const e=[];for(const i of C0){const n=l.options[i]?.preload;n&&e.push(n())}if(e.length)return Promise.all(e).then(()=>{l._componentsLoaded=!0,l._componentsPromise=void 0});l._componentsLoaded=!0,l._componentsPromise=void 0};l._componentsPromise=l._lazyPromise?l._lazyPromise.then(t):t()}return l._componentsPromise}function wc(l,t){return t?{status:"error",error:t}:{status:"success",value:l}}function T0(l){for(const t of C0)if(l.options[t]?.preload)return!0;return!1}const C0=["component","errorComponent","pendingComponent","notFoundComponent"];function zE(l){return{input:({url:t})=>{for(const e of l)t=R0(e,t);return t},output:({url:t})=>{for(let e=l.length-1;e>=0;e--)t=x0(l[e],t);return t}}}function HE(l){const t=$c(l.basepath),e=`/${t}`,i=`${e}/`,n=l.caseSensitive?e:e.toLowerCase(),a=l.caseSensitive?i:i.toLowerCase();return{input:({url:o})=>{const u=l.caseSensitive?o.pathname:o.pathname.toLowerCase();return u===n?o.pathname="/":u.startsWith(a)&&(o.pathname=o.pathname.slice(e.length)),o},output:({url:o})=>(o.pathname=Ss(["/",t,o.pathname]),o)}}function R0(l,t){const e=l?.input?.({url:t});if(e){if(typeof e=="string")return new URL(e);if(e instanceof URL)return e}return t}function x0(l,t){const e=l?.output?.({url:t});if(e){if(typeof e=="string")return new URL(e);if(e instanceof URL)return e}return t}function $n(l){const t=l.resolvedLocation,e=l.location,i=t?.pathname!==e.pathname,n=t?.href!==e.href,a=t?.hash!==e.hash;return{fromLocation:t,toLocation:e,pathChanged:i,hrefChanged:n,hashChanged:a}}class $E{constructor(t){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=e=>e(),this.update=e=>{e.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const i=this.options,n=this.basepath??i?.basepath??"/",a=this.basepath===void 0,o=i?.rewrite;this.options={...i,...e},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(v=>[encodeURIComponent(v),v])):void 0,(!this.history||this.options.history&&this.options.history!==this.history)&&(this.options.history?this.history=this.options.history:this.isServer||(this.history=p0())),this.origin=this.options.origin,this.origin||(!this.isServer&&window?.origin&&window.origin!=="null"?this.origin=window.origin:this.origin="http://localhost"),this.history&&this.updateLatestLocation(),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),!this.__store&&this.latestLocation&&(this.__store=new vf(VE(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(v=>!["redirected"].includes(v.status))}}}),CE(this));let u=!1;const d=this.options.basepath??"/",f=this.options.rewrite;if(a||n!==d||o!==f){this.basepath=d;const v=[];$c(d)!==""&&v.push(HE({basepath:d})),f&&v.push(f),this.rewrite=v.length===0?void 0:v.length===1?v[0]:zE(v),this.history&&this.updateLatestLocation(),u=!0}u&&this.__store&&(this.__store.state={...this.state,location:this.latestLocation}),typeof window<"u"&&"CSS"in window&&typeof window.CSS?.supports=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.updateLatestLocation=()=>{this.latestLocation=this.parseLocation(this.history.location,this.latestLocation)},this.buildRouteTree=()=>{const{routesById:e,routesByPath:i,flatRoutes:n}=wE({routeTree:this.routeTree,initRoute:(o,u)=>{o.init({originalIndex:u})}});this.routesById=e,this.routesByPath=i,this.flatRoutes=n;const a=this.options.notFoundRoute;a&&(a.init({originalIndex:99999999999}),this.routesById[a.id]=a)},this.subscribe=(e,i)=>{const n={eventType:e,fn:i};return this.subscribers.add(n),()=>{this.subscribers.delete(n)}},this.emit=e=>{this.subscribers.forEach(i=>{i.eventType===e.type&&i.fn(e)})},this.parseLocation=(e,i)=>{const n=({href:d,state:f})=>{const p=new URL(d,this.origin),g=R0(this.rewrite,p),v=this.options.parseSearch(g.search),b=this.options.stringifySearch(v);g.search=b;const w=g.href.replace(g.origin,""),{pathname:_,hash:A}=g;return{href:w,publicHref:d,url:g.href,pathname:_,searchStr:b,search:xi(i?.search,v),hash:A.split("#").reverse()[0]??"",state:xi(i?.state,f)}},a=n(e),{__tempLocation:o,__tempKey:u}=a.state;if(o&&(!u||u===this.tempLocationKey)){const d=n(o);return d.state.key=a.state.key,d.state.__TSR_key=a.state.__TSR_key,delete d.state.__tempLocation,{...d,maskedLocation:a}}return a},this.resolvePathWithBase=(e,i)=>eE({base:e,to:Xf(i),trailingSlash:this.options.trailingSlash,parseCache:this.parsePathnameCache}),this.matchRoutes=(e,i,n)=>typeof e=="string"?this.matchRoutesInternal({pathname:e,search:i},n):this.matchRoutesInternal(e,i),this.parsePathnameCache=NE(1e3),this.getMatchedRoutes=(e,i)=>GE({pathname:e,routePathname:i,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes,parseCache:this.parsePathnameCache}),this.cancelMatch=e=>{const i=this.getMatch(e);i&&(i.abortController.abort(),clearTimeout(i._nonReactive.pendingTimeout),i._nonReactive.pendingTimeout=void 0)},this.cancelMatches=()=>{this.state.pendingMatches?.forEach(e=>{this.cancelMatch(e.id)})},this.buildLocation=e=>{const i=(a={})=>{const o=a._fromLocation||this.latestLocation,u=this.matchRoutes(o,{_buildLocation:!0}),d=bf(u);a.from;const f=a.unsafeRelative==="path"?o.pathname:a.from??d.fullPath,p=this.resolvePathWithBase(f,"."),g=d.search,v={...d.params},b=a.to?this.resolvePathWithBase(p,`${a.to}`):this.resolvePathWithBase(p,"."),w=a.params===!1||a.params===null?{}:(a.params??!0)===!0?v:Object.assign(v,zn(a.params,v)),_=bc({path:b,params:w,parseCache:this.parsePathnameCache}).interpolatedPath,A=this.matchRoutes(_,void 0,{_buildLocation:!0}).map(X=>this.looseRoutesById[X.routeId]);if(Object.keys(w).length>0)for(const X of A){const W=X.options.params?.stringify??X.options.stringifyParams;W&&Object.assign(w,W(w))}const E=bc({path:b,params:w,leaveWildcards:!1,leaveParams:e.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath;let R=g;if(e._includeValidateSearch&&this.options.search?.strict){const X={};A.forEach(W=>{if(W.options.validateSearch)try{Object.assign(X,Sf(W.options.validateSearch,{...X,...R}))}catch{}}),R=X}R=YE({search:R,dest:a,destRoutes:A,_includeValidateSearch:e._includeValidateSearch}),R=xi(g,R);const C=this.options.stringifySearch(R),x=a.hash===!0?o.hash:a.hash?zn(a.hash,o.hash):void 0,D=x?`#${x}`:"";let M=a.state===!0?o.state:a.state?zn(a.state,o.state):{};M=xi(o.state,M);const k=`${E}${C}${D}`,I=new URL(k,this.origin),H=x0(this.rewrite,I);return{publicHref:H.pathname+H.search+H.hash,href:k,url:H.href,pathname:E,search:R,searchStr:C,state:M,hash:x??"",unmaskOnReload:a.unmaskOnReload}},n=(a={},o)=>{const u=i(a);let d=o?i(o):void 0;if(!d){let f={};const p=this.options.routeMasks?.find(g=>{const v=_f(u.pathname,{to:g.from,caseSensitive:!1,fuzzy:!1},this.parsePathnameCache);return v?(f=v,!0):!1});if(p){const{from:g,...v}=p;o={from:e.from,...v,params:f},d=i(o)}}return d&&(u.maskedLocation=d),u};return e.mask?n(e,{from:e.from,...e.mask}):n(e)},this.commitLocation=({viewTransition:e,ignoreBlocker:i,...n})=>{const a=()=>{const d=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];d.forEach(p=>{n.state[p]=this.latestLocation.state[p]});const f=Hn(n.state,this.latestLocation.state);return d.forEach(p=>{delete n.state[p]}),f},o=ln(this.latestLocation.href)===ln(n.href),u=this.commitLocationPromise;if(this.commitLocationPromise=na(()=>{u?.resolve()}),o&&a())this.load();else{let{maskedLocation:d,hashScrollIntoView:f,...p}=n;d&&(p={...d,state:{...d.state,__tempKey:void 0,__tempLocation:{...p,search:p.searchStr,state:{...p.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(p.unmaskOnReload??this.options.unmaskOnReload??!1)&&(p.state.__tempKey=this.tempLocationKey)),p.state.__hashScrollIntoViewOptions=f??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=e,this.history[n.replace?"replace":"push"](p.publicHref,p.state,{ignoreBlocker:i})}return this.resetNextScroll=n.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:e,resetScroll:i,hashScrollIntoView:n,viewTransition:a,ignoreBlocker:o,href:u,...d}={})=>{if(u){const p=this.history.location.state.__TSR_index,g=Lo(u,{__TSR_index:e?p:p+1});d.to=g.pathname,d.search=this.options.parseSearch(g.search),d.hash=g.hash.slice(1)}const f=this.buildLocation({...d,_includeValidateSearch:!0});return this.commitLocation({...f,viewTransition:a,replace:e,resetScroll:i,hashScrollIntoView:n,ignoreBlocker:o})},this.navigate=({to:e,reloadDocument:i,href:n,...a})=>{if(!i&&n)try{new URL(`${n}`),i=!0}catch{}return i?(n||(n=this.buildLocation({to:e,...a}).url),a.replace?window.location.replace(n):window.location.href=n,Promise.resolve()):this.buildAndCommitLocation({...a,href:n,to:e,_isNavigate:!0})},this.beforeLoad=()=>{if(this.cancelMatches(),this.updateLatestLocation(),this.isServer){const i=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0}),n=a=>{try{return encodeURI(decodeURI(a))}catch{return a}};if($c(n(this.latestLocation.href))!==$c(n(i.href))){let a=i.url;throw this.origin&&a.startsWith(this.origin)&&(a=a.replace(this.origin,"")||"/"),PE({href:a})}}const e=this.matchRoutes(this.latestLocation);this.__store.setState(i=>({...i,status:"pending",statusCode:200,isLoading:!0,location:this.latestLocation,pendingMatches:e,cachedMatches:i.cachedMatches.filter(n=>!e.some(a=>a.id===n.id))}))},this.load=async e=>{let i,n,a;for(a=new Promise(u=>{this.startTransition(async()=>{try{this.beforeLoad();const d=this.latestLocation,f=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...$n({resolvedLocation:f,location:d})}),this.emit({type:"onBeforeLoad",...$n({resolvedLocation:f,location:d})}),await Qv({router:this,sync:e?.sync,matches:this.state.pendingMatches,location:d,updateMatch:this.updateMatch,onReady:async()=>{this.startViewTransition(async()=>{let p,g,v;Co(()=>{this.__store.setState(b=>{const w=b.matches,_=b.pendingMatches||b.matches;return p=w.filter(A=>!_.some(E=>E.id===A.id)),g=_.filter(A=>!w.some(E=>E.id===A.id)),v=w.filter(A=>_.some(E=>E.id===A.id)),{...b,isLoading:!1,loadedAt:Date.now(),matches:_,pendingMatches:void 0,cachedMatches:[...b.cachedMatches,...p.filter(A=>A.status!=="error")]}}),this.clearExpiredCache()}),[[p,"onLeave"],[g,"onEnter"],[v,"onStay"]].forEach(([b,w])=>{b.forEach(_=>{this.looseRoutesById[_.routeId].options[w]?.(_)})})})}})}catch(d){Qi(d)?(i=d,this.isServer||this.navigate({...i.options,replace:!0,ignoreBlocker:!0})):ji(d)&&(n=d),this.__store.setState(f=>({...f,statusCode:i?i.status:n?404:f.matches.some(p=>p.status==="error")?500:200,redirect:i}))}this.latestLoadPromise===a&&(this.commitLocationPromise?.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),u()})}),this.latestLoadPromise=a,await a;this.latestLoadPromise&&a!==this.latestLoadPromise;)await this.latestLoadPromise;let o;this.hasNotFoundMatch()?o=404:this.__store.state.matches.some(u=>u.status==="error")&&(o=500),o!==void 0&&this.__store.setState(u=>({...u,statusCode:o}))},this.startViewTransition=e=>{const i=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,i&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let n;if(typeof i=="object"&&this.isViewTransitionTypesSupported){const a=this.latestLocation,o=this.state.resolvedLocation,u=typeof i.types=="function"?i.types($n({resolvedLocation:o,location:a})):i.types;if(u===!1){e();return}n={update:e,types:u}}else n=e;document.startViewTransition(n)}else e()},this.updateMatch=(e,i)=>{const n=this.state.pendingMatches?.some(a=>a.id===e)?"pendingMatches":this.state.matches.some(a=>a.id===e)?"matches":this.state.cachedMatches.some(a=>a.id===e)?"cachedMatches":"";n&&this.__store.setState(a=>({...a,[n]:a[n]?.map(o=>o.id===e?i(o):o)}))},this.getMatch=e=>{const i=n=>n.id===e;return this.state.cachedMatches.find(i)??this.state.pendingMatches?.find(i)??this.state.matches.find(i)},this.invalidate=e=>{const i=n=>e?.filter?.(n)??!0?{...n,invalid:!0,...e?.forcePending||n.status==="error"?{status:"pending",error:void 0}:void 0}:n;return this.__store.setState(n=>({...n,matches:n.matches.map(i),cachedMatches:n.cachedMatches.map(i),pendingMatches:n.pendingMatches?.map(i)})),this.shouldViewTransition=!1,this.load({sync:e?.sync})},this.resolveRedirect=e=>{if(!e.options.href){const i=this.buildLocation(e.options);let n=i.url;this.origin&&n.startsWith(this.origin)&&(n=n.replace(this.origin,"")||"/"),e.options.href=i.href,e.headers.set("Location",n)}return e.headers.get("Location")||e.headers.set("Location",e.options.href),e},this.clearCache=e=>{const i=e?.filter;i!==void 0?this.__store.setState(n=>({...n,cachedMatches:n.cachedMatches.filter(a=>!i(a))})):this.__store.setState(n=>({...n,cachedMatches:[]}))},this.clearExpiredCache=()=>{const e=i=>{const n=this.looseRoutesById[i.routeId];if(!n.options.loader)return!0;const a=(i.preload?n.options.preloadGcTime??this.options.defaultPreloadGcTime:n.options.gcTime??this.options.defaultGcTime)??300*1e3;return i.status==="error"?!0:Date.now()-i.updatedAt>=a};this.clearCache({filter:e})},this.loadRouteChunk=E0,this.preloadRoute=async e=>{const i=this.buildLocation(e);let n=this.matchRoutes(i,{throwOnError:!0,preload:!0,dest:e});const a=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(u=>u.id)),o=new Set([...a,...this.state.cachedMatches.map(u=>u.id)]);Co(()=>{n.forEach(u=>{o.has(u.id)||this.__store.setState(d=>({...d,cachedMatches:[...d.cachedMatches,u]}))})});try{return n=await Qv({router:this,matches:n,location:i,preload:!0,updateMatch:(u,d)=>{a.has(u)?n=n.map(f=>f.id===u?d(f):f):this.updateMatch(u,d)}}),n}catch(u){if(Qi(u))return u.options.reloadDocument?void 0:await this.preloadRoute({...u.options,_fromLocation:i});ji(u)||console.error(u);return}},this.matchRoute=(e,i)=>{const n={...e,to:e.to?this.resolvePathWithBase(e.from||"",e.to):void 0,params:e.params||{},leaveParams:!0},a=this.buildLocation(n);if(i?.pending&&this.state.status!=="pending")return!1;const u=(i?.pending===void 0?!this.state.isLoading:i.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,d=_f(u.pathname,{...i,to:a.pathname},this.parsePathnameCache);return!d||e.params&&!Hn(d,e.params,{partial:!0})?!1:d&&(i?.includeSearch??!0)?Hn(u.search,a.search,{partial:!0})?d:!1:d},this.hasNotFoundMatch=()=>this.__store.state.matches.some(e=>e.status==="notFound"||e.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...t,caseSensitive:t.caseSensitive??!1,notFoundMode:t.notFoundMode??"fuzzy",stringifySearch:t.stringifySearch??kE,parseSearch:t.parseSearch??ME}),typeof document<"u"&&(self.__TSR_ROUTER__=this)}isShell(){return!!this.options.isShell}isPrerendering(){return!!this.options.isPrerendering}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(t,e){const{foundRoute:i,matchedRoutes:n,routeParams:a}=this.getMatchedRoutes(t.pathname,e?.dest?.to);let o=!1;(i?i.path!=="/"&&a["**"]:ln(t.pathname))&&(this.options.notFoundRoute?n.push(this.options.notFoundRoute):o=!0);const u=(()=>{if(o){if(this.options.notFoundMode!=="root")for(let p=n.length-1;p>=0;p--){const g=n[p];if(g.children)return g.id}return Ke}})(),d=[],f=p=>p?.id?p.context??this.options.context??void 0:this.options.context??void 0;return n.forEach((p,g)=>{const v=d[g-1],[b,w,_]=(()=>{const et=v?.search??t.search,mt=v?._strictSearch??void 0;try{const ft=Sf(p.options.validateSearch,{...et})??void 0;return[{...et,...ft},{...mt,...ft},void 0]}catch(ft){let yt=ft;if(ft instanceof Jc||(yt=new Jc(ft.message,{cause:ft})),e?.throwOnError)throw yt;return[et,{},yt]}})(),A=p.options.loaderDeps?.({search:b})??"",E=A?JSON.stringify(A):"",{interpolatedPath:R,usedParams:C}=bc({path:p.fullPath,params:a,decodeCharMap:this.pathParamsDecodeCharMap}),x=bc({path:p.id,params:a,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath+E,D=this.getMatch(x),M=this.state.matches.find(et=>et.routeId===p.id),k=D?._strictParams??C;let I;if(!D){const et=p.options.params?.parse??p.options.parseParams;if(et)try{Object.assign(k,et(k))}catch(mt){if(I=new qE(mt.message,{cause:mt}),e?.throwOnError)throw I}}Object.assign(a,k);const H=M?"stay":"enter";let X;if(D)X={...D,cause:H,params:M?xi(M.params,a):a,_strictParams:k,search:xi(M?M.search:D.search,b),_strictSearch:w};else{const et=p.options.loader||p.options.beforeLoad||p.lazyFn||T0(p)?"pending":"success";X={id:x,index:g,routeId:p.id,params:M?xi(M.params,a):a,_strictParams:k,pathname:R,updatedAt:Date.now(),search:M?xi(M.search,b):b,_strictSearch:w,searchError:void 0,status:et,isFetching:!1,error:void 0,paramsError:I,__routeContext:void 0,_nonReactive:{loadPromise:na()},__beforeLoadContext:void 0,context:{},abortController:new AbortController,fetchCount:0,cause:H,loaderDeps:M?xi(M.loaderDeps,A):A,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:p.options.staticData||{},fullPath:p.fullPath}}e?.preload||(X.globalNotFound=u===p.id),X.searchError=_;const W=f(v);X.context={...W,...X.__routeContext,...X.__beforeLoadContext},d.push(X)}),d.forEach((p,g)=>{const v=this.looseRoutesById[p.routeId];if(!this.getMatch(p.id)&&e?._buildLocation!==!0){const w=d[g-1],_=f(w);if(v.options.context){const A={deps:p.loaderDeps,params:p.params,context:_??{},location:t,navigate:E=>this.navigate({...E,_fromLocation:t}),buildLocation:this.buildLocation,cause:p.cause,abortController:p.abortController,preload:!!p.preload,matches:d};p.__routeContext=v.options.context(A)??void 0}p.context={..._,...p.__routeContext,...p.__beforeLoadContext}}}),d}}class Jc extends Error{}class qE extends Error{}function VE(l){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:l,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function Sf(l,t){if(l==null)return{};if("~standard"in l){const e=l["~standard"].validate(t);if(e instanceof Promise)throw new Jc("Async validation not supported");if(e.issues)throw new Jc(JSON.stringify(e.issues,void 0,2),{cause:e});return e.value}return"parse"in l?l.parse(t):typeof l=="function"?l(t):{}}function GE({pathname:l,routePathname:t,caseSensitive:e,routesByPath:i,routesById:n,flatRoutes:a,parseCache:o}){let u={};const d=ln(l),f=b=>_f(d,{to:b.fullPath,caseSensitive:b.options?.caseSensitive??e,fuzzy:!0},o);let p=t!==void 0?i[t]:void 0;if(p)u=f(p);else{let b;for(const w of a){const _=f(w);if(_)if(w.path!=="/"&&_["**"])b||(b={foundRoute:w,routeParams:_});else{p=w,u=_;break}}!p&&b&&(p=b.foundRoute,u=b.routeParams)}let g=p||n[Ke];const v=[g];for(;g.parentRoute;)g=g.parentRoute,v.push(g);return v.reverse(),{matchedRoutes:v,routeParams:u,foundRoute:p}}function YE({search:l,dest:t,destRoutes:e,_includeValidateSearch:i}){const n=e.reduce((u,d)=>{const f=[];if("search"in d.options)d.options.search?.middlewares&&f.push(...d.options.search.middlewares);else if(d.options.preSearchFilters||d.options.postSearchFilters){const p=({search:g,next:v})=>{let b=g;"preSearchFilters"in d.options&&d.options.preSearchFilters&&(b=d.options.preSearchFilters.reduce((_,A)=>A(_),g));const w=v(b);return"postSearchFilters"in d.options&&d.options.postSearchFilters?d.options.postSearchFilters.reduce((_,A)=>A(_),w):w};f.push(p)}if(i&&d.options.validateSearch){const p=({search:g,next:v})=>{const b=v(g);try{return{...b,...Sf(d.options.validateSearch,b)??void 0}}catch{return b}};f.push(p)}return u.concat(f)},[])??[],a=({search:u})=>t.search?t.search===!0?u:zn(t.search,u):{};n.push(a);const o=(u,d)=>{if(u>=n.length)return d;const f=n[u];return f({search:d,next:g=>o(u+1,g)})};return o(0,l)}const XE="Error preloading route! ";class O0{constructor(t){if(this.init=e=>{this.originalIndex=e.originalIndex;const i=this.options,n=!i?.path&&!i?.id;this.parentRoute=this.options.getParentRoute?.(),n?this._path=Ke:this.parentRoute||As(!1);let a=n?Ke:i?.path;a&&a!=="/"&&(a=Kf(a));const o=i?.id||a;let u=n?Ke:Ss([this.parentRoute.id===Ke?"":this.parentRoute.id,o]);a===Ke&&(a="/"),u!==Ke&&(u=Ss(["/",u]));const d=u===Ke?"/":Ss([this.parentRoute.fullPath,a]);this._path=a,this._id=u,this._fullPath=d,this._to=d},this.clone=e=>{this._path=e._path,this._id=e._id,this._fullPath=e._fullPath,this._to=e._to,this.options.getParentRoute=e.options.getParentRoute,this.children=e.children},this.addChildren=e=>this._addFileChildren(e),this._addFileChildren=e=>(Array.isArray(e)&&(this.children=e),typeof e=="object"&&e!==null&&(this.children=Object.values(e)),this),this._addFileTypes=()=>this,this.updateLoader=e=>(Object.assign(this.options,e),this),this.update=e=>(Object.assign(this.options,e),this),this.lazy=e=>(this.lazyFn=e,this),this.options=t||{},this.isRoot=!t?.getParentRoute,t?.id&&t?.path)throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}}class KE extends O0{constructor(t){super(t)}}var dt=ha();const Po=Gf(dt);function Wf(l){const t=l.errorComponent??hu;return st.jsx(WE,{getResetKey:l.getResetKey,onCatch:l.onCatch,children:({error:e,reset:i})=>e?dt.createElement(t,{error:e,reset:i}):l.children})}class WE extends dt.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(t){return{resetKey:t.getResetKey()}}static getDerivedStateFromError(t){return{error:t}}reset(){this.setState({error:null})}componentDidUpdate(t,e){e.error&&e.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(t,e){this.props.onCatch&&this.props.onCatch(t,e)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function hu({error:l}){const[t,e]=dt.useState(!1);return st.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[st.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[st.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),st.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>e(i=>!i),children:t?"Hide Error":"Show Error"})]}),st.jsx("div",{style:{height:".25rem"}}),t?st.jsx("div",{children:st.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:l.message?st.jsx("code",{children:l.message}):null})}):null]})}function QE({children:l,fallback:t=null}){return JE()?st.jsx(Po.Fragment,{children:l}):st.jsx(Po.Fragment,{children:t})}function JE(){return Po.useSyncExternalStore(ZE,()=>!0,()=>!1)}function ZE(){return()=>{}}var Vd={exports:{}},Gd={},Yd={exports:{}},Xd={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function tT(){if(Jv)return Xd;Jv=1;var l=ha();function t(g,v){return g===v&&(g!==0||1/g===1/v)||g!==g&&v!==v}var e=typeof Object.is=="function"?Object.is:t,i=l.useState,n=l.useEffect,a=l.useLayoutEffect,o=l.useDebugValue;function u(g,v){var b=v(),w=i({inst:{value:b,getSnapshot:v}}),_=w[0].inst,A=w[1];return a(function(){_.value=b,_.getSnapshot=v,d(_)&&A({inst:_})},[g,b,v]),n(function(){return d(_)&&A({inst:_}),g(function(){d(_)&&A({inst:_})})},[g]),o(b),b}function d(g){var v=g.getSnapshot;g=g.value;try{var b=v();return!e(g,b)}catch{return!0}}function f(g,v){return v()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:u;return Xd.useSyncExternalStore=l.useSyncExternalStore!==void 0?l.useSyncExternalStore:p,Xd}var Zv;function eT(){return Zv||(Zv=1,Yd.exports=tT()),Yd.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tb;function iT(){if(tb)return Gd;tb=1;var l=ha(),t=eT();function e(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var i=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,a=l.useRef,o=l.useEffect,u=l.useMemo,d=l.useDebugValue;return Gd.useSyncExternalStoreWithSelector=function(f,p,g,v,b){var w=a(null);if(w.current===null){var _={hasValue:!1,value:null};w.current=_}else _=w.current;w=u(function(){function E(M){if(!R){if(R=!0,C=M,M=v(M),b!==void 0&&_.hasValue){var k=_.value;if(b(k,M))return x=k}return x=M}if(k=x,i(C,M))return k;var I=v(M);return b!==void 0&&b(k,I)?(C=M,k):(C=M,x=I)}var R=!1,C,x,D=g===void 0?null:g;return[function(){return E(p())},D===null?void 0:function(){return E(D())}]},[p,g,v,b]);var A=n(f,w[0],w[1]);return o(function(){_.hasValue=!0,_.value=A},[A]),d(A),A},Gd}var eb;function sT(){return eb||(eb=1,Vd.exports=iT()),Vd.exports}var nT=sT();function rT(l,t=e=>e){return nT.useSyncExternalStoreWithSelector(l.subscribe,()=>l.state,()=>l.state,t,aT)}function aT(l,t){if(Object.is(l,t))return!0;if(typeof l!="object"||l===null||typeof t!="object"||t===null)return!1;if(l instanceof Map&&t instanceof Map){if(l.size!==t.size)return!1;for(const[i,n]of l)if(!t.has(i)||!Object.is(n,t.get(i)))return!1;return!0}if(l instanceof Set&&t instanceof Set){if(l.size!==t.size)return!1;for(const i of l)if(!t.has(i))return!1;return!0}if(l instanceof Date&&t instanceof Date)return l.getTime()===t.getTime();const e=ib(l);if(e.length!==ib(t).length)return!1;for(let i=0;i<e.length;i++)if(!Object.prototype.hasOwnProperty.call(t,e[i])||!Object.is(l[e[i]],t[e[i]]))return!1;return!0}function ib(l){return Object.keys(l).concat(Object.getOwnPropertySymbols(l))}const Kd=dt.createContext(null);function M0(){return typeof document>"u"?Kd:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=Kd,Kd)}function pi(l){const t=dt.useContext(M0());return l?.warn,t}function We(l){const t=pi({warn:l?.router===void 0}),e=l?.router||t,i=dt.useRef(void 0);return rT(e.__store,n=>{if(l?.select){if(l.structuralSharing??e.options.defaultStructuralSharing){const a=xi(i.current,l.select(n));return i.current=a,a}return l.select(n)}return n})}const du=dt.createContext(void 0),oT=dt.createContext(void 0);function Zi(l){const t=dt.useContext(l.from?oT:du);return We({select:i=>{const n=i.matches.find(a=>l.from?l.from===a.routeId:a.id===t);if(As(!((l.shouldThrow??!0)&&!n),`Could not find ${l.from?`an active match from "${l.from}"`:"a nearest match!"}`),n!==void 0)return l.select?l.select(n):n},structuralSharing:l.structuralSharing})}function Qf(l){return Zi({from:l.from,strict:l.strict,structuralSharing:l.structuralSharing,select:t=>l.select?l.select(t.loaderData):t.loaderData})}function Jf(l){const{select:t,...e}=l;return Zi({...e,select:i=>t?t(i.loaderDeps):i.loaderDeps})}function Zf(l){return Zi({from:l.from,shouldThrow:l.shouldThrow,structuralSharing:l.structuralSharing,strict:l.strict,select:t=>{const e=l.strict===!1?t.params:t._strictParams;return l.select?l.select(e):e}})}function tp(l){return Zi({from:l.from,strict:l.strict,shouldThrow:l.shouldThrow,structuralSharing:l.structuralSharing,select:t=>l.select?l.select(t.search):t.search})}function ep(l){const t=pi();return dt.useCallback(e=>t.navigate({...e,from:e.from??l?.from}),[l?.from,t])}var lT=f0();const Sc=typeof window<"u"?dt.useLayoutEffect:dt.useEffect;function Wd(l){const t=dt.useRef({value:l,prev:null}),e=t.current.value;return l!==e&&(t.current={value:l,prev:e}),t.current.prev}function cT(l,t,e={},i={}){dt.useEffect(()=>{if(!l.current||i.disabled||typeof IntersectionObserver!="function")return;const n=new IntersectionObserver(([a])=>{t(a)},e);return n.observe(l.current),()=>{n.disconnect()}},[t,e,i.disabled,l])}function uT(l){const t=dt.useRef(null);return dt.useImperativeHandle(l,()=>t.current,[]),t}function hT(l,t){const e=pi(),[i,n]=dt.useState(!1),a=dt.useRef(!1),o=uT(t),{activeProps:u,inactiveProps:d,activeOptions:f,to:p,preload:g,preloadDelay:v,hashScrollIntoView:b,replace:w,startTransition:_,resetScroll:A,viewTransition:E,children:R,target:C,disabled:x,style:D,className:M,onClick:k,onFocus:I,onMouseEnter:H,onMouseLeave:X,onTouchStart:W,ignoreBlocker:et,params:mt,search:ft,hash:yt,state:N,mask:q,reloadDocument:Q,unsafeRelative:vt,from:Ct,_fromLocation:L,...$}=l,K=We({select:zt=>zt.location.search,structuralSharing:!0}),J=l.from,at=dt.useMemo(()=>({...l,from:J}),[e,K,J,l._fromLocation,l.hash,l.to,l.search,l.params,l.state,l.mask,l.unsafeRelative]),ot=dt.useMemo(()=>e.buildLocation({...at}),[e,at]),lt=dt.useMemo(()=>{if(x)return;let zt=ot.maskedLocation?ot.maskedLocation.url:ot.url,It=!1;return e.origin&&(zt.startsWith(e.origin)?zt=e.history.createHref(zt.replace(e.origin,""))||"/":It=!0),{href:zt,external:It}},[x,ot.maskedLocation,ot.url,e.origin,e.history]),Xt=dt.useMemo(()=>{if(lt?.external)return lt.href;try{return new URL(p),p}catch{}},[p,lt]),Pt=l.reloadDocument||Xt?!1:g??e.options.defaultPreload,Oi=v??e.options.defaultPreloadDelay??0,gi=We({select:zt=>{if(Xt)return!1;if(f?.exact){if(!ZA(zt.location.pathname,ot.pathname,e.basepath))return!1}else{const It=Kc(zt.location.pathname,e.basepath),Qe=Kc(ot.pathname,e.basepath);if(!(It.startsWith(Qe)&&(It.length===Qe.length||It[Qe.length]==="/")))return!1}return(f?.includeSearch??!0)&&!Hn(zt.location.search,ot.search,{partial:!f?.exact,ignoreUndefined:!f?.explicitUndefined})?!1:f?.includeHash?zt.location.hash===ot.hash:!0}}),Ne=dt.useCallback(()=>{e.preloadRoute({...at}).catch(zt=>{console.warn(zt),console.warn(XE)})},[e,at]),hn=dt.useCallback(zt=>{zt?.isIntersecting&&Ne()},[Ne]);cT(o,hn,mT,{disabled:!!x||Pt!=="viewport"}),dt.useEffect(()=>{a.current||!x&&Pt==="render"&&(Ne(),a.current=!0)},[x,Ne,Pt]);const Mi=zt=>{const It=zt.currentTarget.target,Qe=C!==void 0?C:It;if(!x&&!yT(zt)&&!zt.defaultPrevented&&(!Qe||Qe==="_self")&&zt.button===0){zt.preventDefault(),lT.flushSync(()=>{n(!0)});const ya=e.subscribe("onResolved",()=>{ya(),n(!1)});e.navigate({...at,replace:w,resetScroll:A,hashScrollIntoView:b,startTransition:_,viewTransition:E,ignoreBlocker:et})}};if(Xt)return{...$,ref:o,href:Xt,...R&&{children:R},...C&&{target:C},...x&&{disabled:x},...D&&{style:D},...M&&{className:M},...k&&{onClick:k},...I&&{onFocus:I},...H&&{onMouseEnter:H},...X&&{onMouseLeave:X},...W&&{onTouchStart:W}};const Qn=zt=>{x||Pt&&Ne()},ma=Qn,Au=zt=>{if(!(x||!Pt))if(!Oi)Ne();else{const It=zt.target;if(po.has(It))return;const Qe=setTimeout(()=>{po.delete(It),Ne()},Oi);po.set(It,Qe)}},Zo=zt=>{if(x||!Pt||!Oi)return;const It=zt.target,Qe=po.get(It);Qe&&(clearTimeout(Qe),po.delete(It))},Rs=gi?zn(u,{})??dT:Qd,xs=gi?Qd:zn(d,{})??Qd,Jn=[M,Rs.className,xs.className].filter(Boolean).join(" "),tl=(D||Rs.style||xs.style)&&{...D,...Rs.style,...xs.style};return{...$,...Rs,...xs,href:lt?.href,ref:o,onClick:go([k,Mi]),onFocus:go([I,Qn]),onMouseEnter:go([H,Au]),onMouseLeave:go([X,Zo]),onTouchStart:go([W,ma]),disabled:!!x,target:C,...tl&&{style:tl},...Jn&&{className:Jn},...x&&fT,...gi&&pT,...i&&gT}}const Qd={},dT={className:"active"},fT={role:"link","aria-disabled":!0},pT={"data-status":"active","aria-current":"page"},gT={"data-transitioning":"transitioning"},po=new WeakMap,mT={rootMargin:"100px"},go=l=>t=>{for(const e of l)if(e){if(t.defaultPrevented)return;e(t)}},k0=dt.forwardRef((l,t)=>{const{_asChild:e,...i}=l,{type:n,ref:a,...o}=hT(i,t),u=typeof i.children=="function"?i.children({isActive:o["data-status"]==="active"}):i.children;return e===void 0&&delete o.disabled,dt.createElement(e||"a",{...o,ref:a},u)});function yT(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}let vT=class extends O0{constructor(t){super(t),this.useMatch=e=>Zi({select:e?.select,from:this.id,structuralSharing:e?.structuralSharing}),this.useRouteContext=e=>Zi({...e,from:this.id,select:i=>e?.select?e.select(i.context):i.context}),this.useSearch=e=>tp({select:e?.select,structuralSharing:e?.structuralSharing,from:this.id}),this.useParams=e=>Zf({select:e?.select,structuralSharing:e?.structuralSharing,from:this.id}),this.useLoaderDeps=e=>Jf({...e,from:this.id}),this.useLoaderData=e=>Qf({...e,from:this.id}),this.useNavigate=()=>ep({from:this.fullPath}),this.Link=Po.forwardRef((e,i)=>st.jsx(k0,{ref:i,from:this.fullPath,...e})),this.$$typeof=Symbol.for("react.memo")}};function bT(l){return new vT(l)}class _T extends KE{constructor(t){super(t),this.useMatch=e=>Zi({select:e?.select,from:this.id,structuralSharing:e?.structuralSharing}),this.useRouteContext=e=>Zi({...e,from:this.id,select:i=>e?.select?e.select(i.context):i.context}),this.useSearch=e=>tp({select:e?.select,structuralSharing:e?.structuralSharing,from:this.id}),this.useParams=e=>Zf({select:e?.select,structuralSharing:e?.structuralSharing,from:this.id}),this.useLoaderDeps=e=>Jf({...e,from:this.id}),this.useLoaderData=e=>Qf({...e,from:this.id}),this.useNavigate=()=>ep({from:this.fullPath}),this.Link=Po.forwardRef((e,i)=>st.jsx(k0,{ref:i,from:this.fullPath,...e})),this.$$typeof=Symbol.for("react.memo")}}function wT(l){return new _T(l)}function No(l){return typeof l=="object"?new sb(l,{silent:!0}).createRoute(l):new sb(l,{silent:!0}).createRoute}class sb{constructor(t,e){this.path=t,this.createRoute=i=>{this.silent;const n=bT(i);return n.isRoot=!1,n},this.silent=e?.silent}}class nb{constructor(t){this.useMatch=e=>Zi({select:e?.select,from:this.options.id,structuralSharing:e?.structuralSharing}),this.useRouteContext=e=>Zi({from:this.options.id,select:i=>e?.select?e.select(i.context):i.context}),this.useSearch=e=>tp({select:e?.select,structuralSharing:e?.structuralSharing,from:this.options.id}),this.useParams=e=>Zf({select:e?.select,structuralSharing:e?.structuralSharing,from:this.options.id}),this.useLoaderDeps=e=>Jf({...e,from:this.options.id}),this.useLoaderData=e=>Qf({...e,from:this.options.id}),this.useNavigate=()=>{const e=pi();return ep({from:e.routesById[this.options.id].fullPath})},this.options=t,this.$$typeof=Symbol.for("react.memo")}}function rb(l){return typeof l=="object"?new nb(l):t=>new nb({id:l,...t})}function ip(l,t){let e,i,n,a;const o=()=>(e||(e=l().then(d=>{e=void 0,i=d[t]}).catch(d=>{if(n=d,QA(n)&&n instanceof Error&&typeof window<"u"&&typeof sessionStorage<"u"){const f=`tanstack_router_reload:${n.message}`;sessionStorage.getItem(f)||(sessionStorage.setItem(f,"1"),a=!0)}})),e),u=function(f){if(a)throw window.location.reload(),new Promise(()=>{});if(n)throw n;if(!i)throw o();return dt.createElement(i,f)};return u.preload=o,u}function ST(){const l=pi(),t=dt.useRef({router:l,mounted:!1}),[e,i]=dt.useState(!1),{hasPendingMatches:n,isLoading:a}=We({select:g=>({isLoading:g.isLoading,hasPendingMatches:g.matches.some(v=>v.status==="pending")}),structuralSharing:!0}),o=Wd(a),u=a||e||n,d=Wd(u),f=a||n,p=Wd(f);return l.startTransition=g=>{i(!0),dt.startTransition(()=>{g(),i(!1)})},dt.useEffect(()=>{const g=l.history.subscribe(l.load),v=l.buildLocation({to:l.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return ln(l.latestLocation.href)!==ln(v.href)&&l.commitLocation({...v,replace:!0}),()=>{g()}},[l,l.history]),Sc(()=>{if(typeof window<"u"&&l.ssr||t.current.router===l&&t.current.mounted)return;t.current={router:l,mounted:!0},(async()=>{try{await l.load()}catch(v){console.error(v)}})()},[l]),Sc(()=>{o&&!a&&l.emit({type:"onLoad",...$n(l.state)})},[o,l,a]),Sc(()=>{p&&!f&&l.emit({type:"onBeforeRouteMount",...$n(l.state)})},[f,p,l]),Sc(()=>{d&&!u&&(l.emit({type:"onResolved",...$n(l.state)}),l.__store.setState(g=>({...g,status:"idle",resolvedLocation:g.location})),RE(l))},[u,d,l]),null}function AT(l){const t=We({select:e=>`not-found-${e.location.pathname}-${e.status}`});return st.jsx(Wf,{getResetKey:()=>t,onCatch:(e,i)=>{if(ji(e))l.onCatch?.(e,i);else throw e},errorComponent:({error:e})=>{if(ji(e))return l.fallback?.(e);throw e},children:l.children})}function ET(){return st.jsx("p",{children:"Not Found"})}function qr(l){return st.jsx(st.Fragment,{children:l.children})}function D0(l,t,e){return t.options.notFoundComponent?st.jsx(t.options.notFoundComponent,{data:e}):l.options.defaultNotFoundComponent?st.jsx(l.options.defaultNotFoundComponent,{data:e}):st.jsx(ET,{})}function TT({children:l}){const t=pi();return t.isServer?st.jsx("script",{nonce:t.options.ssr?.nonce,className:"$tsr",dangerouslySetInnerHTML:{__html:[l].filter(Boolean).join(`
`)+";$_TSR.c()"}}):null}function CT(){const l=pi();if(!l.isScrollRestoring||!l.isServer||typeof l.options.scrollRestoration=="function"&&!l.options.scrollRestoration({location:l.latestLocation}))return null;const e=(l.options.getScrollRestorationKey||wf)(l.latestLocation),i=e!==wf(l.latestLocation)?e:void 0,n={storageKey:Wc,shouldScrollRestoration:!0};return i&&(n.key=i),st.jsx(TT,{children:`(${b0.toString()})(${JSON.stringify(n)})`})}const L0=dt.memo(function({matchId:t}){const e=pi(),i=We({select:E=>{const R=E.matches.find(C=>C.id===t);return As(R),{routeId:R.routeId,ssr:R.ssr,_displayPending:R._displayPending}},structuralSharing:!0}),n=e.routesById[i.routeId],a=n.options.pendingComponent??e.options.defaultPendingComponent,o=a?st.jsx(a,{}):null,u=n.options.errorComponent??e.options.defaultErrorComponent,d=n.options.onCatch??e.options.defaultOnCatch,f=n.isRoot?n.options.notFoundComponent??e.options.notFoundRoute?.options.component:n.options.notFoundComponent,p=i.ssr===!1||i.ssr==="data-only",g=(!n.isRoot||n.options.wrapInSuspense||p)&&(n.options.wrapInSuspense??a??(n.options.errorComponent?.preload||p))?dt.Suspense:qr,v=u?Wf:qr,b=f?AT:qr,w=We({select:E=>E.loadedAt}),_=We({select:E=>{const R=E.matches.findIndex(C=>C.id===t);return E.matches[R-1]?.routeId}}),A=n.isRoot?n.options.shellComponent??qr:qr;return st.jsxs(A,{children:[st.jsx(du.Provider,{value:t,children:st.jsx(g,{fallback:o,children:st.jsx(v,{getResetKey:()=>w,errorComponent:u||hu,onCatch:(E,R)=>{if(ji(E))throw E;d?.(E,R)},children:st.jsx(b,{fallback:E=>{if(!f||E.routeId&&E.routeId!==i.routeId||!E.routeId&&!n.isRoot)throw E;return dt.createElement(f,E)},children:p||i._displayPending?st.jsx(QE,{fallback:o,children:st.jsx(ab,{matchId:t})}):st.jsx(ab,{matchId:t})})})})}),_===Ke&&e.options.scrollRestoration?st.jsxs(st.Fragment,{children:[st.jsx(RT,{}),st.jsx(CT,{})]}):null]})});function RT(){const l=pi(),t=dt.useRef(void 0);return st.jsx("script",{suppressHydrationWarning:!0,ref:e=>{e&&(t.current===void 0||t.current.href!==l.latestLocation.href)&&(l.emit({type:"onRendered",...$n(l.state)}),t.current=l.latestLocation)}},l.latestLocation.state.__TSR_key)}const ab=dt.memo(function({matchId:t}){const e=pi(),{match:i,key:n,routeId:a}=We({select:d=>{const f=d.matches.find(w=>w.id===t),p=f.routeId,v=(e.routesById[p].options.remountDeps??e.options.defaultRemountDeps)?.({routeId:p,loaderDeps:f.loaderDeps,params:f._strictParams,search:f._strictSearch});return{key:v?JSON.stringify(v):void 0,routeId:p,match:{id:f.id,status:f.status,error:f.error,_forcePending:f._forcePending,_displayPending:f._displayPending}}},structuralSharing:!0}),o=e.routesById[a],u=dt.useMemo(()=>{const d=o.options.component??e.options.defaultComponent;return d?st.jsx(d,{},n):st.jsx(P0,{})},[n,o.options.component,e.options.defaultComponent]);if(i._displayPending)throw e.getMatch(i.id)?._nonReactive.displayPendingPromise;if(i._forcePending)throw e.getMatch(i.id)?._nonReactive.minPendingPromise;if(i.status==="pending"){const d=o.options.pendingMinMs??e.options.defaultPendingMinMs;if(d){const f=e.getMatch(i.id);if(f&&!f._nonReactive.minPendingPromise&&!e.isServer){const p=na();f._nonReactive.minPendingPromise=p,setTimeout(()=>{p.resolve(),f._nonReactive.minPendingPromise=void 0},d)}}throw e.getMatch(i.id)?._nonReactive.loadPromise}if(i.status==="notFound")return As(ji(i.error)),D0(e,o,i.error);if(i.status==="redirected")throw As(Qi(i.error)),e.getMatch(i.id)?._nonReactive.loadPromise;if(i.status==="error"){if(e.isServer){const d=(o.options.errorComponent??e.options.defaultErrorComponent)||hu;return st.jsx(d,{error:i.error,reset:void 0,info:{componentStack:""}})}throw i.error}return u}),P0=dt.memo(function(){const t=pi(),e=dt.useContext(du),i=We({select:f=>f.matches.find(p=>p.id===e)?.routeId}),n=t.routesById[i],a=We({select:f=>{const g=f.matches.find(v=>v.id===e);return As(g),g.globalNotFound}}),o=We({select:f=>{const p=f.matches,g=p.findIndex(v=>v.id===e);return p[g+1]?.id}}),u=t.options.defaultPendingComponent?st.jsx(t.options.defaultPendingComponent,{}):null;if(a)return D0(t,n,void 0);if(!o)return null;const d=st.jsx(L0,{matchId:o});return e===Ke?st.jsx(dt.Suspense,{fallback:u,children:d}):d});function xT(){const l=pi(),e=l.routesById[Ke].options.pendingComponent??l.options.defaultPendingComponent,i=e?st.jsx(e,{}):null,n=l.isServer||typeof document<"u"&&l.ssr?qr:dt.Suspense,a=st.jsxs(n,{fallback:i,children:[!l.isServer&&st.jsx(ST,{}),st.jsx(OT,{})]});return l.options.InnerWrap?st.jsx(l.options.InnerWrap,{children:a}):a}function OT(){const l=pi(),t=We({select:n=>n.matches[0]?.id}),e=We({select:n=>n.loadedAt}),i=t?st.jsx(L0,{matchId:t}):null;return st.jsx(du.Provider,{value:t,children:l.options.disableGlobalCatchBoundary?i:st.jsx(Wf,{getResetKey:()=>e,errorComponent:hu,onCatch:n=>{n.message||n.toString()},children:i})})}const MT=l=>new kT(l);class kT extends $E{constructor(t){super(t)}}typeof globalThis<"u"?(globalThis.createFileRoute=No,globalThis.createLazyFileRoute=rb):typeof window<"u"&&(window.createFileRoute=No,window.createLazyFileRoute=rb);function DT({router:l,children:t,...e}){Object.keys(e).length>0&&l.update({...l.options,...e,context:{...l.options.context,...e.context}});const i=M0(),n=st.jsx(i.Provider,{value:l,children:t});return l.options.Wrap?st.jsx(l.options.Wrap,{children:n}):n}function LT({router:l,...t}){return st.jsx(DT,{router:l,...t,children:st.jsx(xT,{})})}var Jd={exports:{}},Zd={};/**
 * @license React
 * react-compiler-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ob;function PT(){if(ob)return Zd;ob=1;var l=ha().__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;return Zd.c=function(t){return l.H.useMemoCache(t)},Zd}var lb;function NT(){return lb||(lb=1,Jd.exports=PT()),Jd.exports}var N0=NT();const BT=()=>{const l=N0.c(1);let t;return l[0]===Symbol.for("react.memo_cache_sentinel")?(t=st.jsx(st.Fragment,{children:st.jsx(P0,{})}),l[0]=t):t=l[0],t},fu=wT({component:BT}),IT="modulepreload",jT=function(l){return"/me/"+l},cb={},Cs=function(t,e,i){let n=Promise.resolve();if(e&&e.length>0){let d=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=o?.nonce||o?.getAttribute("nonce");n=d(e.map(f=>{if(f=jT(f),f in cb)return;cb[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":IT,p||(v.as="script"),v.crossOrigin="",v.href=f,u&&v.setAttribute("nonce",u),document.head.appendChild(v),p)return new Promise((b,w)=>{v.addEventListener("load",b),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return n.then(o=>{for(const u of o||[])u.status==="rejected"&&a(u.reason);return t().catch(a)})},Ie=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Af=[.001,0,0,.001,0,0],tf=1.35,li={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ws={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Bo="pdfjs_internal_editor_",wt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},kt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},B0={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Oe={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},xo={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ce={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Vr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},qo={ERRORS:0,WARNINGS:1,INFOS:5},oa={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ac={moveTo:0,lineTo:1,curveTo:2,closePath:3},I0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let pu=qo.WARNINGS;function UT(l){Number.isInteger(l)&&(pu=l)}function FT(){return pu}function gu(l){pu>=qo.INFOS&&console.info(`Info: ${l}`)}function St(l){pu>=qo.WARNINGS&&console.warn(`Warning: ${l}`)}function Yt(l){throw new Error(l)}function Lt(l,t){l||Yt(t)}function zT(l){switch(l?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function sp(l,t=null,e=null){if(!l)return null;if(e&&typeof l=="string"&&(e.addDefaultProtocol&&l.startsWith("www.")&&l.match(/\./g)?.length>=2&&(l=`http://${l}`),e.tryConvertEncoding))try{l=GT(l)}catch{}const i=t?URL.parse(l,t):URL.parse(l);return zT(i)?i:null}function np(l,t,e=!1){const i=URL.parse(l);return i?(i.hash=t,i.href):e&&sp(l,"http://example.com")?l.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Tt(l,t,e,i=!1){return Object.defineProperty(l,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const Xn=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class ub extends Xn{constructor(t,e){super(t,"PasswordException"),this.code=e}}class ef extends Xn{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Zc extends Xn{constructor(t){super(t,"InvalidPDFException")}}class Io extends Xn{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class HT extends Xn{constructor(t){super(t,"FormatError")}}class Es extends Xn{constructor(t){super(t,"AbortException")}}function j0(l){(typeof l!="object"||l?.length===void 0)&&Yt("Invalid argument for bytesToString");const t=l.length,e=8192;if(t<e)return String.fromCharCode.apply(null,l);const i=[];for(let n=0;n<t;n+=e){const a=Math.min(n+e,t),o=l.subarray(n,a);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Vo(l){typeof l!="string"&&Yt("Invalid argument for stringToBytes");const t=l.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=l.charCodeAt(i)&255;return e}function $T(l){return String.fromCharCode(l>>24&255,l>>16&255,l>>8&255,l&255)}function qT(){const l=new Uint8Array(4);return l[0]=1,new Uint32Array(l.buffer,0,1)[0]===1}function VT(){try{return new Function(""),!0}catch{return!1}}class Ae{static get isLittleEndian(){return Tt(this,"isLittleEndian",qT())}static get isEvalSupported(){return Tt(this,"isEvalSupported",VT())}static get isOffscreenCanvasSupported(){return Tt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Tt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Tt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Tt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const sf=Array.from(Array(256).keys(),l=>l.toString(16).padStart(2,"0"));class tt{static makeHexColor(t,e,i){return`#${sf[t]}${sf[e]}${sf[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const n=t[i],a=t[i+1];t[i]=n*e[0]+a*e[2]+e[4],t[i+1]=n*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const n=e[0],a=e[1],o=e[2],u=e[3],d=e[4],f=e[5];for(let p=0;p<6;p+=2){const g=t[i+p],v=t[i+p+1];t[i+p]=g*n+v*o+d,t[i+p+1]=g*a+v*u+f}}static applyInverseTransform(t,e){const i=t[0],n=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-n*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-i*e[1]+n*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,i){const n=e[0],a=e[1],o=e[2],u=e[3],d=e[4],f=e[5],p=t[0],g=t[1],v=t[2],b=t[3];let w=n*p+d,_=w,A=n*v+d,E=A,R=u*g+f,C=R,x=u*b+f,D=x;if(a!==0||o!==0){const M=a*p,k=a*v,I=o*g,H=o*b;w+=I,E+=I,A+=H,_+=H,R+=M,D+=M,x+=k,C+=k}i[0]=Math.min(i[0],w,A,_,E),i[1]=Math.min(i[1],R,x,C,D),i[2]=Math.max(i[2],w,A,_,E),i[3]=Math.max(i[3],R,x,C,D)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],n=t[1],a=t[2],o=t[3],u=i**2+n**2,d=i*a+n*o,f=a**2+o**2,p=(u+f)/2,g=Math.sqrt(p**2-(u*f-d**2));e[0]=Math.sqrt(p+g||1),e[1]=Math.sqrt(p-g||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>o?null:[i,a,n,o]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,n,a){a[0]=Math.min(a[0],t,i),a[1]=Math.min(a[1],e,n),a[2]=Math.max(a[2],t,i),a[3]=Math.max(a[3],e,n)}static#t(t,e,i,n,a,o,u,d,f,p){if(f<=0||f>=1)return;const g=1-f,v=f*f,b=v*f,w=g*(g*(g*t+3*f*e)+3*v*i)+b*n,_=g*(g*(g*a+3*f*o)+3*v*u)+b*d;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],_),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],_)}static#e(t,e,i,n,a,o,u,d,f,p,g,v){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,i,n,a,o,u,d,-g/p,v);return}const b=p**2-4*g*f;if(b<0)return;const w=Math.sqrt(b),_=2*f;this.#t(t,e,i,n,a,o,u,d,(-p+w)/_,v),this.#t(t,e,i,n,a,o,u,d,(-p-w)/_,v)}static bezierBoundingBox(t,e,i,n,a,o,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,i,a,u,e,n,o,d,3*(-t+3*(i-a)+u),6*(t-2*i+a),3*(i-t),f),this.#e(t,i,a,u,e,n,o,d,3*(-e+3*(n-o)+d),6*(e-2*n+o),3*(n-e),f)}}function GT(l){return decodeURIComponent(escape(l))}let nf=null,hb=null;function U0(l){return nf||(nf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,hb=new Map([["","t"]])),l.replaceAll(nf,(t,e,i)=>e?e.normalize("NFKC"):hb.get(i))}function rp(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const l=new Uint8Array(32);return crypto.getRandomValues(l),j0(l)}const ap="pdfjs_internal_id_";function YT(l,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,n,...a]=e;if(!l(i)&&!Number.isInteger(i)||!t(n))return!1;const o=a.length;let u=!0;switch(n.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;u=!1;break;default:return!1}for(const d of a)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Pe(l,t,e){return Math.min(Math.max(l,t),e)}function F0(l){return Uint8Array.prototype.toBase64?l.toBase64():btoa(j0(l))}function XT(l){return Uint8Array.fromBase64?Uint8Array.fromBase64(l):Vo(atob(l))}typeof Promise.try!="function"&&(Promise.try=function(l,...t){return new Promise(e=>{e(l(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(l){return l.reduce((t,e)=>t+e,0)});class jo{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function n(a){if(!a)return;let o=null;const u=a.name;if(u==="#text")o=a.value;else if(jo.shouldBuildText(u))a?.attributes?.textContent?o=a.attributes.textContent:a.value&&(o=a.value);else return;if(o!==null&&e.push({str:o}),!!a.children)for(const d of a.children)n(d)}return n(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class op{static setupStorage(t,e,i,n,a){const o=n.getValue(e,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),a==="print")break;t.addEventListener("input",u=>{n.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?t.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",u=>{n.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),a==="print")break;t.addEventListener("input",u=>{n.setValue(e,{value:u.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const u of i.children)u.attributes.value===o.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;n.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:a}){const{attributes:o}=e,u=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${n}`);for(const[d,f]of Object.entries(o))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&a.addLinkAttributes(t,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(t,o.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,a=t.intent||"display",o=document.createElement(n.name);n.attributes&&this.setAttributes({html:o,element:n,intent:a,linkService:i});const u=a!=="richText",d=t.div;if(d.append(o),t.viewport){const g=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=g}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(n.children.length===0){if(n.value){const g=document.createTextNode(n.value);o.append(g),u&&jo.shouldBuildText(n.name)&&f.push(g)}return{textDivs:f}}const p=[[n,-1,o]];for(;p.length>0;){const[g,v,b]=p.at(-1);if(v+1===g.children.length){p.pop();continue}const w=g.children[++p.at(-1)[1]];if(w===null)continue;const{name:_}=w;if(_==="#text"){const E=document.createTextNode(w.value);f.push(E),b.append(E);continue}const A=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,_):document.createElement(_);if(b.append(A),w.attributes&&this.setAttributes({html:A,element:w,storage:e,intent:a,linkService:i}),w.children?.length>0)p.push([w,-1,A]);else if(w.value){const E=document.createTextNode(w.value);u&&jo.shouldBuildText(_)&&f.push(E),A.append(E)}}for(const g of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const vs="http://www.w3.org/2000/svg";class Gn{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function da(l,t="text"){if(wo(l,document.baseURI)){const e=await fetch(l);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const n=new XMLHttpRequest;n.open("GET",l,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}i(new Error(n.statusText))}},n.send(null)})}class Go{constructor({viewBox:t,userUnit:e,scale:i,rotation:n,offsetX:a=0,offsetY:o=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=n,this.offsetX=a,this.offsetY=o,i*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,g,v,b;switch(n%=360,n<0&&(n+=360),n){case 180:p=-1,g=0,v=0,b=1;break;case 90:p=0,g=1,v=1,b=0;break;case 270:p=0,g=-1,v=-1,b=0;break;case 0:p=1,g=0,v=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,b=-b);let w,_,A,E;p===0?(w=Math.abs(f-t[1])*i+a,_=Math.abs(d-t[0])*i+o,A=(t[3]-t[1])*i,E=(t[2]-t[0])*i):(w=Math.abs(d-t[0])*i+a,_=Math.abs(f-t[1])*i+o,A=(t[2]-t[0])*i,E=(t[3]-t[1])*i),this.transform=[p*i,g*i,v*i,b*i,w-p*i*d-v*i*f,_-g*i*d-b*i*f],this.width=A,this.height=E}get rawDims(){const t=this.viewBox;return Tt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:a=!1}={}){return new Go({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:a})}convertToViewportPoint(t,e){const i=[t,e];return tt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];tt.applyTransform(e,this.transform);const i=[t[2],t[3]];return tt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return tt.applyInverseTransform(i,this.transform),i}}class mu extends Xn{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Yo(l){const t=l.length;let e=0;for(;e<t&&l[e].trim()==="";)e++;return l.substring(e,e+5).toLowerCase()==="data:"}function yu(l){return typeof l=="string"&&/\.pdf$/i.test(l)}function z0(l){return[l]=l.split(/[#?]/,1),l.substring(l.lastIndexOf("/")+1)}function H0(l,t="document.pdf"){if(typeof l!="string")return t;if(Yo(l))return St('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(l);if(!i)return t;const n=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},a=/\.pdf$/i,o=i.pathname.split("/").at(-1);if(a.test(o))return n(o);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const f of u)if(a.test(f))return n(f);const d=Array.from(i.searchParams.keys()).reverse();for(const f of d)if(a.test(f))return n(f)}if(i.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(d)return n(d[0])}return t}class db{started=Object.create(null);times=[];time(t){t in this.started&&St(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||St(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:a}of this.times)t.push(`${i.padEnd(e)} ${a-n}ms
`);return t.join("")}}function wo(l,t){const e=t?URL.parse(l,t):URL.parse(l);return e?.protocol==="http:"||e?.protocol==="https:"}function fi(l){l.preventDefault()}function se(l){l.preventDefault(),l.stopPropagation()}function KT(l){console.log("Deprecated API usage: "+l)}class tu{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let g=parseInt(e[9],10)||0;return g=g>=0&&g<=59?g:0,f==="-"?(o+=p,u+=g):f==="+"&&(o-=p,u-=g),new Date(Date.UTC(i,n,a,o,u,d))}}function $0(l,{scale:t=1,rotation:e=0}){const{width:i,height:n}=l.attributes.style,a=[0,0,parseInt(i),parseInt(n)];return new Go({viewBox:a,userUnit:1,scale:t,rotation:e})}function fa(l){if(l.startsWith("#")){const t=parseInt(l.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return l.startsWith("rgb(")?l.slice(4,-1).split(",").map(t=>parseInt(t)):l.startsWith("rgba(")?l.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(St(`Not a valid color format: "${l}"`),[0,0,0])}function WT(l){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of l.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;l.set(e,fa(i))}t.remove()}function ee(l){const{a:t,b:e,c:i,d:n,e:a,f:o}=l.getTransform();return[t,e,i,n,a,o]}function Gi(l){const{a:t,b:e,c:i,d:n,e:a,f:o}=l.getTransform().invertSelf();return[t,e,i,n,a,o]}function cn(l,t,e=!1,i=!0){if(t instanceof Go){const{pageWidth:n,pageHeight:a}=t.rawDims,{style:o}=l,u=Ae.isCSSRoundSupported,d=`var(--total-scale-factor) * ${n}px`,f=`var(--total-scale-factor) * ${a}px`,p=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,g=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(o.width=p,o.height=g):(o.width=g,o.height=p)}i&&l.setAttribute("data-main-rotation",t.rotation)}class Ui{constructor(){const{pixelRatio:t}=Ui;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,n,a=-1){let o=1/0,u=1/0,d=1/0;i=Ui.capPixels(i,a),i>0&&(o=Math.sqrt(i/(t*e))),n!==-1&&(u=n/t,d=n/e);const f=Math.min(o,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const eu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class QT{static get isDarkMode(){return Tt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class q0{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),Tt(this,"commentForegroundColor",fa(i))}}function V0(l,t,e,i){i=Math.min(Math.max(i??1,0),1);const n=255*(1-i);return l=Math.round(l*i+n),t=Math.round(t*i+n),e=Math.round(e*i+n),[l,t,e]}function fb(l,t){const e=l[0]/255,i=l[1]/255,n=l[2]/255,a=Math.max(e,i,n),o=Math.min(e,i,n),u=(a+o)/2;if(a===o)t[0]=t[1]=0;else{const d=a-o;switch(t[1]=u<.5?d/(a+o):d/(2-a-o),a){case e:t[0]=((i-n)/d+(i<n?6:0))*60;break;case i:t[0]=((n-e)/d+2)*60;break;case n:t[0]=((e-i)/d+4)*60;break}}t[2]=u}function Ef(l,t){const e=l[0],i=l[1],n=l[2],a=(1-Math.abs(2*n-1))*i,o=a*(1-Math.abs(e/60%2-1)),u=n-a/2;switch(Math.floor(e/60)){case 0:t[0]=a+u,t[1]=o+u,t[2]=u;break;case 1:t[0]=o+u,t[1]=a+u,t[2]=u;break;case 2:t[0]=u,t[1]=a+u,t[2]=o+u;break;case 3:t[0]=u,t[1]=o+u,t[2]=a+u;break;case 4:t[0]=o+u,t[1]=u,t[2]=a+u;break;case 5:case 6:t[0]=a+u,t[1]=u,t[2]=o+u;break}}function pb(l){return l<=.03928?l/12.92:((l+.055)/1.055)**2.4}function gb(l,t,e){Ef(l,e),e.map(pb);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];Ef(t,e),e.map(pb);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>n?(i+.05)/(n+.05):(n+.05)/(i+.05)}const mb=new Map;function G0(l,t){const e=l[0]+l[1]*256+l[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=mb.get(e);if(i)return i;const n=new Float32Array(9),a=n.subarray(0,3),o=n.subarray(3,6);fb(l,o);const u=n.subarray(6,9);fb(t,u);const d=u[2]<.5,f=d?12:4.5;if(o[2]=d?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),gb(o,u,a)<f){let p,g;d?(p=o[2],g=1):(p=0,g=o[2]);const v=.005;for(;g-p>v;){const b=o[2]=(p+g)/2;d===gb(o,u,a)<f?p=b:g=b}o[2]=d?g:p}return Ef(o,a),i=tt.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),mb.set(e,i),i}function lp({html:l,dir:t,className:e},i){const n=document.createDocumentFragment();if(typeof l=="string"){const a=document.createElement("p");a.dir=t||"auto";const o=l.split(/(?:\r\n?|\n)/);for(let u=0,d=o.length;u<d;++u){const f=o[u];a.append(document.createTextNode(f)),u<d-1&&a.append(document.createElement("br"))}n.append(a)}else op.render({xfaHtml:l,div:n,intent:"richText"});n.firstChild.classList.add("richText",e),i.append(n)}class Oo{#t=null;#e=null;#s;#i=null;#a=null;#n=null;#r=null;#o=null;static#c=null;constructor(t){this.#s=t,Oo.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#s._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",fi,{signal:e}),t.addEventListener("pointerdown",Oo.#l,{signal:e}));const i=this.#i=document.createElement("div");i.className="buttons",t.append(i);const n=this.#s.toolbarPosition;if(n){const{style:a}=t,o=this.#s._uiManager.direction==="ltr"?1-n[0]:n[0];a.insetInlineEnd=`${100*o}%`,a.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#s._focusEventsAllowed=!1,se(t)}#h(t){this.#s._focusEventsAllowed=!0,se(t)}#f(t){const e=this.#s._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",fi,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#n?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#s,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",Oo.#c[t]),this.#f(i)&&i.addEventListener("click",n=>{e.delete()},{signal:e._signal}),this.#i.append(i)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#i.append(e,this.#m),this.#a=t}addComment(t,e=null){if(this.#n)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const n=this.#r=this.#m;e?(this.#i.insertBefore(i,e),this.#i.insertBefore(n,e)):this.#i.append(i,n),this.#n=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#i.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#s);this.#f(e),this.#i.append(e,this.#m)}removeButton(t){switch(t){case"comment":this.#n?.removeToolbarCommentButton(),this.#n=null,this.#r?.remove(),this.#r=null;break}}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}async addButtonBefore(t,e,i){const n=this.#i.querySelector(i);n&&t==="comment"&&this.addComment(e,n)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class JT{#t=null;#e=null;#s;constructor(t){this.#s=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#s._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",fi,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#s.hasCommentManager()&&this.#n("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#s.commentSelection("floating_button")}),this.#n("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#s.highlightSelection("floating_button")}),t}#a(t,e){let i=0,n=0;for(const a of t){const o=a.y+a.height;if(o<i)continue;const u=a.x+(e?a.width:0);if(o>i){n=u,i=o;continue}e?u>n&&(n=u):u<n&&(n=u)}return[e?1-n:n,i]}show(t,e,i){const[n,a]=this.#a(e,i),{style:o}=this.#e||=this.#i();t.append(this.#e),o.insetInlineEnd=`${100*n}%`,o.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#n(t,e,i,n){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const o=document.createElement("span");a.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",i);const u=this.#s._signal;u instanceof AbortSignal&&!u.aborted&&(a.addEventListener("contextmenu",fi,{signal:u}),a.addEventListener("click",n,{signal:u})),this.#t.append(a)}}function Y0(l,t,e){for(const i of e)t.addEventListener(i,l[i].bind(l))}class ZT{#t=0;get id(){return`${Bo}${this.#t++}`}}class cp{#t=rp();#e=0;#s=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const a=n.decode().then(()=>(i.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Tt(this,"_isSVGFittingCanvas",a)}async#i(t,e){this.#s||=new Map;let i=this.#s.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let n;if(typeof e=="string"?(i.url=e,n=await da(e,"blob")):e instanceof File?n=i.file=e:e instanceof Blob&&(n=e),n.type==="image/svg+xml"){const a=cp._isSVGFittingCanvas,o=new FileReader,u=new Image,d=new Promise((f,p)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,f()},o.onload=async()=>{const g=i.svgUrl=o.result;u.src=await a?`${g}#svgView(preserveAspectRatio(none))`:g},u.onerror=o.onerror=p});o.readAsDataURL(n),await d}else i.bitmap=await createImageBitmap(n);i.refCounter=1}catch(n){St(n),i=null}return this.#s.set(t,i),i&&this.#s.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:n,type:a}=t;return this.#i(`${e}_${i}_${n}_${a}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const i=await e;return this.#i(t,i)}async getFromId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#s||=new Map;let i=this.#s.get(t);if(i?.bitmap)return i.refCounter+=1,i;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),i={bitmap:n.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#s.set(t,i),this.#s.set(i.id,i),i}getSvgUrl(t){const e=this.#s.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const n=new OffscreenCanvas(i.width,i.height);n.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=n.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class t1{#t=[];#e=!1;#s;#i=-1;constructor(t=128){this.#s=t}add({cmd:t,undo:e,post:i,mustExec:n,type:a=NaN,overwriteIfSameType:o=!1,keepUndo:u=!1}){if(n&&t(),this.#e)return;const d={cmd:t,undo:e,post:i,type:a};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(d);return}if(o&&this.#t[this.#i].type===a){u&&(d.undo=this.#t[this.#i].undo),this.#t[this.#i]=d;return}const f=this.#i+1;f===this.#s?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class Xo{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Ae.platform;for(const[i,n,a={}]of t)for(const o of i){const u=o.startsWith("mac+");e&&u?(this.callbacks.set(o.slice(4),{callback:n,options:a}),this.allKeys.add(o.split("+").at(-1))):!e&&!u&&(this.callbacks.set(o,{callback:n,options:a}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:n,options:{bubbles:a=!1,args:o=[],checker:u=null}}=i;u&&!u(t,e)||(n.bind(t,...o,e)(),a||se(e))}}class up{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return WT(t),Tt(this,"_colors",t)}convert(t){const e=fa(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,n]of this._colors)if(n.every((a,o)=>a===e[o]))return up._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?tt.makeHexColor(...e):t}}class Ts{#t=new AbortController;#e=null;#s=null;#i=new Map;#a=new Map;#n=null;#r=null;#o=null;#c=new t1;#l=null;#d=null;#h=null;#f=0;#m=new Set;#p=null;#u=null;#g=new Set;_editorUndoBar=null;#y=!1;#b=!1;#v=!1;#T=null;#A=null;#_=null;#R=null;#S=!1;#E=null;#M=new ZT;#x=!1;#O=!1;#I=!1;#D=null;#P=null;#j=null;#N=null;#q=null;#C=wt.NONE;#w=new Set;#L=null;#U=null;#z=null;#Y=null;#G=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#B=null;#V=null;#J=null;#Z=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Ts.prototype,e=o=>o.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},n=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Tt(this,"_keyboardManager",new Xo([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#V.contains(u)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,i,n,a,o,u,d,f,p,g,v,b,w,_,A){const E=this._signal=this.#t.signal;this.#V=t,this.#J=e,this.#Z=i,this.#n=n,this.#l=a,this.#U=o,this.#G=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:E}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),u._on("setpreference",this.onSetPreference.bind(this),{signal:E}),u._on("switchannotationeditorparams",R=>this.updateParams(R.type,R.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#O=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#O=!1},{capture:!0,signal:E}),this.#lt(),this.#dt(),this.#et(),this.#r=d.annotationStorage,this.#T=d.filterFactory,this.#z=f,this.#R=p||null,this.#y=g,this.#b=v,this.#v=b,this.#q=w||null,this.viewParameters={realScale:Gn.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=A!==!1,a?.setSidebarUiManager(this)}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#g.clear(),this.#N?.clear(),this.#e=null,this.#w.clear(),this.#c.destroy(),this.#n?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#E?.hide(),this.#E=null,this.#j?.destroy(),this.#j=null,this.#s=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#B&&(clearTimeout(this.#B),this.#B=null),this._editorUndoBar?.destroy(),this.#G=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Tt(this,"hcmFilter",this.#z?this.#T.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Tt(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Tt(this,"_highlightColors",this.#R?new Map(this.#R.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Tt(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[n,a]of t){const o=n.endsWith("_HCM");if(i&&o){e.set(n.replace("_HCM",""),a);continue}!i&&!o&&e.set(n,a)}return Tt(this,"highlightColors",e)}get highlightColorNames(){return Tt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#j=t}editAltText(t,e=!1){this.#n?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,n){this.#l?.showDialog(this,t,e,i,n)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),n=a=>{a.pageNumber===t&&(this._eventBus._off("editorsrendered",n),e())};this._eventBus.on("editorsrendered",n),await i}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const i of this.#a.values()){const{x:n,y:a,width:o,height:u}=i.div.getBoundingClientRect();if(t>=n&&t<=n+o&&e>=a&&e<=a+u)return i}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Gn.PDF_TO_CSS_UNITS;for(const e of this.#g)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#a.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:n,anchorOffset:a,focusNode:o,focusOffset:u}=i,d=i.toString(),p=this.#Q(i).closest(".textLayer"),g=this.getSelectionBoxes(p);if(!g)return;i.empty();const v=this.#tt(p),b=this.#C===wt.NONE,w=()=>{const _=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:g,anchorNode:n,anchorOffset:a,focusNode:o,focusOffset:u,text:d});b&&this.showAllEditors("highlight",!0,!0),e&&_?.editComment()};if(b){this.switchToMode(wt.HIGHLIGHT,w);return}w()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Q(t).closest(".textLayer"),n=this.getSelectionBoxes(i);n&&(this.#E||=new JT(this),this.#E.show(i,n,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#r)return null;const e=`${Bo}${t}`,i=this.#r.getRawValue(e);return i&&this.#r.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#Z;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#E?.hide(),this.#L=null,this.#k({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#L)return;const n=this.#Q(t).closest(".textLayer");if(!n){this.#L&&(this.#E?.hide(),this.#L=null,this.#k({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#L=e,this.#k({hasSelectedText:!0}),!(this.#C!==wt.HIGHLIGHT&&this.#C!==wt.NONE)&&(this.#C===wt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#C===wt.HIGHLIGHT?this.#tt(n):null;if(a?.toggleDrawing(),this.#O){const o=new AbortController,u=this.combinedSignal(o),d=f=>{f.type==="pointerup"&&f.button!==0||(o.abort(),a?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else a?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#C===wt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#_)return;this.#_=new AbortController;const t=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#w)if(e.div.contains(t)){this.#P=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#P)return;const[t,e]=this.#P;this.#P=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#D)return;this.#D=new AbortController;const t=this.combinedSignal(this.#D);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#D?.abort(),this.#D=null}#it(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#st(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ht(),this.#st()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#w){const n=i.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const o of this.#u)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(a){St(`paste: "${a.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const a=[];for(const d of i){const f=await n.deserialize(d);if(!f)return;a.push(f)}const o=()=>{for(const d of a)this.#nt(d);this.#rt(a)},u=()=>{for(const d of a)d.remove()};this.addCommands({cmd:o,undo:u,mustExec:!0})}catch(a){St(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==wt.NONE&&!this.isEditorHandlingKeyboard&&Ts._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#k(t){Object.entries(t).some(([i,n])=>this.#X[i]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#C===wt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#$([[kt.HIGHLIGHT_FREE,!0]]))}#$(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#k({isEditing:this.#C!==wt.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#st(),this.#k({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#$(e.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#x?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,n=!1,a=!1){if(this.#C!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#C===wt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#C=t,t===wt.NONE){this.setEditingState(!1),this.#pt();for(const o of this.#i.values())o.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#F.resolve();return}for(const o of this.#i.values())o.addStandaloneCommentButton();t===wt.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const o of this.#a.values())o.updateMode(t);if(t===wt.POPUP){this.#s||=await this.#G.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const o=new Set,u=[];for(const d of this.#i.values()){const{annotationElementId:f,hasComment:p,deleted:g}=d;f&&o.add(f),p&&!g&&u.push(d.getData())}for(const d of this.#s){const{id:f,popupRef:p,contentsObj:g}=d;p&&g?.str&&!o.has(f)&&!this.#m.has(f)&&u.push(d)}this.#l?.showSidebar(u)}if(!e){i&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const o of this.#i.values())o.uid===e?(this.setSelected(o),a?o.editComment():n?o.enterInEditMode():o.focus()):o.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case kt.CREATE:this.currentLayer.addNewEditor(e);return;case kt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#w)i.updateParams(t,e);else for(const i of this.#u)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const a of this.#i.values())a.editorType===t&&a.show(e);(this.#Y?.get(kt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#$([[kt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#I!==t){this.#I=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#x){this.#x=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#pt(){if(this.unselectAll(),this.#x){this.#x=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const e of this.#i.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#N?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#$(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#gt===t&&this.#$(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#$(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#k({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#h?.commitOrRemove();for(const e of this.#w)e!==t&&e.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#k({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#k({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#c.add(t),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#c.cleanType(t)}#W(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#w],i=()=>{this._editorUndoBar?.show(n,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},n=()=>{for(const a of e)this.#nt(a)};this.addCommands({cmd:i,undo:n,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#rt(t){for(const e of this.#w)e.unselect();this.#w.clear();for(const e of t)e.isEmpty()||(this.#w.add(e),e.select());this.#k({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#rt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==wt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#k({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[n,a]=this.#H,o=[...this.#w],u=1e3;this.#B&&clearTimeout(this.#B),this.#B=setTimeout(()=>{this.#B=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of o)this.#i.has(d.id)&&(d.translateInPage(n,a),d.translationDone())},undo:()=>{for(const d of o)this.#i.has(d.id)&&(d.translateInPage(-n,-a),d.translationDone())},mustExec:!1})},u);for(const d of o)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#w)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:n,y:a,pageIndex:o},u]of t)u.newX=n,u.newY=a,u.newPageIndex=o,e||=n!==u.savedX||a!==u.savedY||o!==u.savedPageIndex;if(!e)return!1;const i=(n,a,o,u)=>{if(this.#i.has(n.id)){const d=this.#a.get(u);d?n._setParentAndPosition(d,a,o):(n.pageIndex=u,n.x=a,n.y=o)}};return this.addCommands({cmd:()=>{for(const[n,{newX:a,newY:o,newPageIndex:u}]of t)i(n,a,o,u)},undo:()=>{for(const[n,{savedX:a,savedY:o,savedPageIndex:u}]of t)i(n,a,o,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const i of this.#p.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}isEditingMode(){return this.#C!==wt.NONE}get imageManager(){return Tt(this,"imageManager",new cp)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:n,width:a,height:o}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,g,v)=>({x:(p-n)/o,y:1-(f+g-i)/a,width:v/o,height:g/a});break;case"180":u=(f,p,g,v)=>({x:1-(f+g-i)/a,y:1-(p+v-n)/o,width:g/a,height:v/o});break;case"270":u=(f,p,g,v)=>({x:1-(p+v-n)/o,y:(f-i)/a,width:v/o,height:g/a});break;default:u=(f,p,g,v)=>({x:(f-i)/a,y:(p-n)/o,width:g/a,height:v/o});break}const d=[];for(let f=0,p=e.rangeCount;f<p;f++){const g=e.getRangeAt(f);if(!g.collapsed)for(const{x:v,y:b,width:w,height:_}of g.getClientRects())w===0||_===0||d.push(u(v,b,w,_))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#r.getRawValue(e);i&&(this.#C===wt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const n=this.#N?.get(t);n&&(n.setCanvas(e,i),this.#N.delete(t))}addMissingCanvas(t,e){(this.#N||=new Map).set(t,e)}}class Ki{#t=null;#e=!1;#s=null;#i=null;#a=null;#n=null;#r=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Ki.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ki._l10n??=t}async render(){const t=this.#s=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ki.#f.missing),e.setAttribute("data-l10n-id",Ki.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",fi,{signal:i}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const n=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#r=!0,n(a))},{signal:i}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Ki._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:n,cancel:a=!1}){i&&(this.#l=i,this.#d=n),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#s&&(!t&&this.#n&&(clearTimeout(this.#n),this.#n=null),this.#s.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#s?.remove(),this.#s=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#s;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ki.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Ki.#f[`${this.#m}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const n=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#n),this.#n=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#n=setTimeout(()=>{this.#n=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#n&&(clearTimeout(this.#n),this.#n=null),this.#a?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Ec{#t=null;#e=null;#s=!1;#i=null;#a=null;#n=null;#r=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#i.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const n=this.#i.commentButtonColor;n&&(i.backgroundColor=n)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:n,y:a,width:o,height:u}=this.#i.parent.boundingClientRect;return[(t-n)/o,(e+i-a)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const i=this.#i._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",fi,{signal:i}),e&&(t.addEventListener("focusin",a=>{this.#i._focusEventsAllowed=!1,se(a)},{capture:!0,signal:i}),t.addEventListener("focusout",a=>{this.#i._focusEventsAllowed=!0,se(a)},{capture:!0,signal:i})),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const n=a=>{a.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#s=!0,n(a))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,n;if(e)[i,n]=e;else{[i,n]=this.#i.commentButtonPosition;const{width:p,height:g,x:v,y:b}=this.#i;i=v+i*p,n=b+n*g}const a=this.#i.parent.boundingClientRect,{x:o,y:u,width:d,height:f}=a;this.#i._uiManager.editComment(this.#i,o+i*d,u+n*f,{...t,parentDimensions:a})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#s}),this.#s=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#n,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#r&&(this.#n=null),t===null){this.#r="",this.#c=!0;return}this.#r=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#n=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#r="",this.#n=null,this.#o=null,this.#i=null,this.#s=!1,this.#c=!1}}class Ko{#t;#e=!1;#s=null;#i;#a;#n;#r;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:n=null,onPinching:a=null,onPinchEnd:o=null,signal:u}){this.#t=t,this.#s=i,this.#i=e,this.#a=n,this.#n=a,this.#r=o,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ui.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const n=this.#o=new AbortController,a=AbortSignal.any([this.#c,n.signal]),o=this.#t,u={capture:!0,signal:a,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(se(f),d(f))},u),o.addEventListener("pointerup",d,u),o.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const n=AbortSignal.any([this.#c,this.#h.signal]),a=this.#t,o={signal:n,capture:!1,passive:!1};a.addEventListener("touchmove",this.#m.bind(this),o);const u=this.#p.bind(this);a.addEventListener("touchend",u,o),a.addEventListener("touchcancel",u,o),o.capture=!0,a.addEventListener("pointerdown",se,o),a.addEventListener("pointermove",se,o),a.addEventListener("pointercancel",se,o),a.addEventListener("pointerup",se,o),this.#a?.()}if(se(t),t.touches.length!==2||this.#s?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;se(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:n,screenY:a}=e,{screenX:o,screenY:u}=i,d=this.#l,{touch0X:f,touch0Y:p,touch1X:g,touch1Y:v}=d,b=g-f,w=v-p,_=o-n,A=u-a,E=Math.hypot(_,A)||1,R=Math.hypot(b,w)||1;if(!this.#e&&Math.abs(R-E)<=Ko.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=n,d.touch0Y=a,d.touch1X=o,d.touch1Y=u,!this.#e){this.#e=!0;return}const C=[(n+o)/2,(a+u)/2];this.#n?.(C,R,E)}#p(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#r?.()),this.#l&&(se(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class ut{#t=null;#e=null;#s=null;#i=null;#a=null;#n=!1;#r=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#p=!1;#u=null;#g=!1;#y=!1;#b=!1;#v=null;#T=0;#A=0;#_=null;#R=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#E=ut._zIndex++;static _borderLineWidth=-1;static _colorManager=new up;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ut.prototype._resizeWithKeyboard,e=Ts.TRANSLATE_SMALL,i=Ts.TRANSLATE_BIG;return Tt(this,"_resizerKeyboardManager",new Xo([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],ut.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:n,pageX:a,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,n],this.pageTranslation=[a,o];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Tt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new e1({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(ut._l10n??=t,ut._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ut._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ut._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Yt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#B(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[a,o]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/a,this.y=(e+n)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,n]=this.parentDimensions;this.setAt(t*i,e*n,this.width*i,this.height*n),this._onTranslated()}#M([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#M(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#M(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[n,a]}=this;if(this.x+=t/n,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:u}=this;const[d,f]=this.getBaseTranslation();o+=d,u+=f;const{style:p}=i;p.left=`${(100*o).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(o,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=ut,n=i/t,a=i/e;switch(this.rotation){case 90:return[-n,a];case 180:return[n,a];case 270:return[n,-a];default:return[-n,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,n]}=this;let{x:a,y:o,width:u,height:d}=this;if(u*=i,d*=n,a*=i,o*=n,this._mustFixPosition)switch(t){case 0:a=Pe(a,0,i-u),o=Pe(o,0,n-d);break;case 90:a=Pe(a,0,i-d),o=Pe(o,u,n);break;case 180:a=Pe(a,u,i),o=Pe(o,d,n);break;case 270:a=Pe(a,d,i),o=Pe(o,0,n-u);break}this.x=a/=i,this.y=o/=n;const[f,p]=this.getBaseTranslation();a+=f,o+=p,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#x(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return ut.#x(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return ut.#x(t,e,360-this.parentRotation)}#O(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#I(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const n=document.createElement("div");this.#c.append(n),n.classList.add("resizer",i),n.setAttribute("data-resizer-name",i),n.addEventListener("pointerdown",this.#D.bind(this,i),{signal:e}),n.addEventListener("contextmenu",fi,{signal:e}),n.tabIndex=-1}this.div.prepend(this.#c)}#D(t,e){e.preventDefault();const{isMac:i}=Ae.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#s?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const a=new AbortController,o=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#N.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",se,{passive:!1,signal:o}),window.addEventListener("contextmenu",fi,{signal:o}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#j()};window.addEventListener("pointerup",f,{signal:o}),window.addEventListener("blur",f,{signal:o})}#P(t,e,i,n){this.width=i,this.height=n,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#j(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=this.#d;this.#d=null;const a=this.x,o=this.y,u=this.width,d=this.height;a===t&&o===e&&u===i&&d===n||this.addCommands({cmd:this.#P.bind(this,a,o,u,d),undo:this.#P.bind(this,t,e,i,n),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#N(t,e){const[i,n]=this.parentDimensions,a=this.x,o=this.y,u=this.width,d=this.height,f=ut.MIN_SIZE/i,p=ut.MIN_SIZE/n,g=this.#O(this.rotation),v=(N,q)=>[g[0]*N+g[2]*q,g[1]*N+g[3]*q],b=this.#O(360-this.rotation),w=(N,q)=>[b[0]*N+b[2]*q,b[1]*N+b[3]*q];let _,A,E=!1,R=!1;switch(t){case"topLeft":E=!0,_=(N,q)=>[0,0],A=(N,q)=>[N,q];break;case"topMiddle":_=(N,q)=>[N/2,0],A=(N,q)=>[N/2,q];break;case"topRight":E=!0,_=(N,q)=>[N,0],A=(N,q)=>[0,q];break;case"middleRight":R=!0,_=(N,q)=>[N,q/2],A=(N,q)=>[0,q/2];break;case"bottomRight":E=!0,_=(N,q)=>[N,q],A=(N,q)=>[0,0];break;case"bottomMiddle":_=(N,q)=>[N/2,q],A=(N,q)=>[N/2,0];break;case"bottomLeft":E=!0,_=(N,q)=>[0,q],A=(N,q)=>[N,0];break;case"middleLeft":R=!0,_=(N,q)=>[0,q/2],A=(N,q)=>[N,q/2];break}const C=_(u,d),x=A(u,d);let D=v(...x);const M=ut._round(a+D[0]),k=ut._round(o+D[1]);let I=1,H=1,X,W;if(e.fromKeyboard)({deltaX:X,deltaY:W}=e);else{const{screenX:N,screenY:q}=e,[Q,vt]=this.#l;[X,W]=this.screenToPageTranslation(N-Q,q-vt),this.#l[0]=N,this.#l[1]=q}if([X,W]=w(X/i,W/n),E){const N=Math.hypot(u,d);I=H=Math.max(Math.min(Math.hypot(x[0]-C[0]-X,x[1]-C[1]-W)/N,1/u,1/d),f/u,p/d)}else R?I=Pe(Math.abs(x[0]-C[0]-X),f,1)/u:H=Pe(Math.abs(x[1]-C[1]-W),p,1)/d;const et=ut._round(u*I),mt=ut._round(d*H);D=v(...A(et,mt));const ft=M-D[0],yt=k-D[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=et,this.height=mt,this.x=ft,this.y=yt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Oo(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#s?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#s||(Ki.initialize(ut._l10n),this.#s=new Ki(this),this.#t&&(this.#s.data=this.#t,this.#t=null)),this.#s}get altTextData(){return this.#s?.data}set altTextData(t){this.#s&&(this.#s.data=t)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(t){await this.#s?.setGuessedText(t)}serializeAltText(t){return this.#s?.serialize(t)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.#i||=new Ec(this)}addStandaloneCommentButton(){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#i.renderForStandalone(),this.div.append(this.#a))}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:n}}=this.#i;return{text:e,richText:t,date:i,deleted:n,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Ec(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#i||=new Ec(this),this.#i.setInitialText(t,i),!this.annotationElementId))return;const n=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);n&&this.updateFromAnnotationLayer(n)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Ec(this),this.#i.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,n]=t.rect,[a]=this.pageDimensions,[o]=this.pageTranslation,u=o+a+1,d=n-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,n]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#i.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#n?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[n,a]=this.getInitialTranslation();return this.translate(n,a),Y0(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#R||=new Ko({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(t,e,i){let a=.7*(i/e)+1-.7;if(a===1)return;const o=this.#O(this.rotation),u=(M,k)=>[o[0]*M+o[2]*k,o[1]*M+o[3]*k],[d,f]=this.parentDimensions,p=this.x,g=this.y,v=this.width,b=this.height,w=ut.MIN_SIZE/d,_=ut.MIN_SIZE/f;a=Math.max(Math.min(a,1/v,1/b),w/v,_/b);const A=ut._round(v*a),E=ut._round(b*a);if(A===v&&E===b)return;this.#u||=[p,g,v,b];const R=u(v/2,b/2),C=ut._round(p+R[0]),x=ut._round(g+R[1]),D=u(A/2,E/2);this.x=C-D[0],this.y=x-D[1],this.width=A,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#j()}pointerdown(t){const{isMac:e}=Ae.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#U(t);return}this.#L(t)}#L(t){const{isMac:e}=Ae.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const n=new AbortController,a=this._uiManager.combinedSignal(n),o={capture:!0,passive:!1,signal:a},u=f=>{n.abort(),this.#r=null,this.#p=!1,this._uiManager.endDragSession()||this.#L(f),i&&this._onStopDragging()};e&&(this.#T=t.clientX,this.#A=t.clientY,this.#r=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:g,pointerId:v}=f;if(v!==this.#r){se(f);return}const[b,w]=this.screenToPageTranslation(p-this.#T,g-this.#A);this.#T=p,this.#A=g,this._uiManager.dragSelectedEditors(b,w)},o),window.addEventListener("touchmove",se,o),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#R||f.isPrimary)&&u(f),se(f)},o));const d=f=>{if(!this.#r||this.#r===f.pointerId){u(f);return}se(f)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const n=this.parentScale,[a,o]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/n,p=e/n,g=this.x*a,v=this.y*o,b=this.width*a,w=this.height*o;switch(i){case 0:return[g+f+u,o-v-p-w+d,g+f+b+u,o-v-p+d];case 90:return[g+p+u,o-v+f+d,g+p+w+u,o-v+f+b+d];case 180:return[g-f-b+u,o-v+p+d,g-f+u,o-v+p+w+d];case 270:return[g-p-w+u,o-v-f-b+d,g-p+u,o-v-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,a,o]=t,u=a-i,d=o-n;switch(this.rotation){case 0:return[i,e-o,u,d];case 90:return[i,e-n,d,u];case 180:return[a,e-n,u,d];case 270:return[a,e-o,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:n,deleted:a,richText:o},uid:u,pageIndex:d,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:o,contentsObj:{str:t},creationDate:f,modificationDate:i||p,popupRef:!a,color:e,opacity:n}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:n}=this.getClientDimensions(),{innerHeight:a,innerWidth:o}=window;return e<o&&n>0&&t<a&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});n.rotation=t.rotation,n.#t=t.accessibilityData,n._isCopy=t.isCopy||!1;const[a,o]=n.pageDimensions,[u,d,f,p]=n.getRectInCurrentCoords(t.rect,o);return n.x=u/a,n.y=d/o,n.width=f/a,n.height=p/o,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#B(),this.removeEditToolbar(),this.#_){for(const t of this.#_.values())clearTimeout(t);this.#_=null}this.parent=null,this.#R?.destroy(),this.#R=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#I(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,n,a,o]=this.getPDFRect();return[ut._round(i+(a-i)*t),ut._round(n+(o-n)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const o=this.#Y.bind(this),u=this.#G.bind(this),d=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",o,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,p),{signal:d}),f.setAttribute("data-l10n-id",ut._l10nResizer[p])}}const i=this.#e[0];let n=0;for(const o of e){if(o===i)break;n++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==n){if(a<n)for(let u=0;u<n-a;u++)this.#c.append(this.#c.firstChild);else if(a>n)for(let u=0;u<a-n;u++)this.#c.firstChild.before(this.#c.lastChild);let o=0;for(const u of e){const f=this.#e[o++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ut._l10nResizer[f])}}this.#H(0),this.#b=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){ut._resizerKeyboardManager.exec(this,t)}#G(t){this.#b&&t.relatedTarget?.parentNode!==this.#c&&this.#B()}#X(t){this.#m=this.#b?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#N(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#b=!1,this.#H(-1),this.#j()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#_||=new Map;const{action:i}=t;let n=this.#_.get(i);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),this.#_.delete(i),this.#_.size===0&&(this.#_=null)},ut._telemetryTimeout),this.#_.set(i,n);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class e1 extends ut{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const yb=3285377520,Ci=4294901760,Yi=65535;class X0{constructor(t){this.h1=t?t&4294967295:yb,this.h2=t?t&4294967295:yb}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let _=0,A=t.length;_<A;_++){const E=t.charCodeAt(_);E<=255?e[i++]=E:(e[i++]=E>>>8,e[i++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=i>>2,a=i-n*4,o=new Uint32Array(e.buffer,0,n);let u=0,d=0,f=this.h1,p=this.h2;const g=3432918353,v=461845907,b=g&Yi,w=v&Yi;for(let _=0;_<n;_++)_&1?(u=o[_],u=u*g&Ci|u*b&Yi,u=u<<15|u>>>17,u=u*v&Ci|u*w&Yi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=o[_],d=d*g&Ci|d*b&Yi,d=d<<15|d>>>17,d=d*v&Ci|d*w&Yi,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,a){case 3:u^=e[n*4+2]<<16;case 2:u^=e[n*4+1]<<8;case 1:u^=e[n*4],u=u*g&Ci|u*b&Yi,u=u<<15|u>>>17,u=u*v&Ci|u*w&Yi,n&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ci|t*36045&Yi,e=e*4283543511&Ci|((e<<16|t>>>16)*2950163797&Ci)>>>16,t^=e>>>1,t=t*444984403&Ci|t*60499&Yi,e=e*3301882366&Ci|((e<<16|t>>>16)*3120437893&Ci)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Tf=Object.freeze({map:null,hash:"",transfer:void 0});class hp{#t=!1;#e=null;#s=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#i.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#i.get(t)}remove(t){const e=this.#i.get(t);if(e!==void 0&&(e instanceof ut&&this.#s.delete(e.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#i.values())if(i instanceof ut)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#i.get(t);let n=!1;if(i!==void 0)for(const[a,o]of Object.entries(e))i[a]!==o&&(n=!0,i[a]=o);else n=!0,this.#i.set(t,e);n&&this.#a(),e instanceof ut&&((this.#s||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new K0(this)}get serializable(){if(this.#i.size===0)return Tf;const t=new Map,e=new X0,i=[],n=Object.create(null);let a=!1;for(const[o,u]of this.#i){const d=u instanceof ut?u.serialize(!1,n):u;d&&(t.set(o,d),e.update(`${o}:${JSON.stringify(d)}`),a||=!!d.bitmap)}if(a)for(const o of t.values())o.bitmap&&i.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Tf}get editorStats(){let t=null;const e=new Map;let i=0,n=0;for(const a of this.#i.values()){if(!(a instanceof ut)){a.popup&&(a.popup.deleted?n+=1:i+=1);continue}a.isCommentDeleted?n+=1:a.hasEditedComment&&(i+=1);const o=a.telemetryFinalData;if(!o)continue;const{type:u}=o;e.has(u)||e.set(u,Object.getPrototypeOf(a).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,p]of Object.entries(o)){if(f==="type")continue;let g=d.get(f);g||(g=new Map,d.set(f,g));const v=g.get(p)??0;g.set(p,v+1)}}if((n>0||i>0)&&(t||=Object.create(null),t.comments={deleted:n,edited:i}),!t)return null;for(const[a,o]of e)t[a]=o.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#s?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#s?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#s)for(const e of this.#s.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class K0 extends hp{#t;constructor(t){super();const{map:e,hash:i,transfer:n}=t.serializable,a=structuredClone(e,n?{transfer:n}:null);this.#t={map:a,hash:i,transfer:n}}get print(){Yt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Tt(this,"modifiedIds",{ids:new Set,hash:""})}}class i1{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Lt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:a,style:o}=t,u=new FontFace(n,a,o);this.addNativeFontFace(u);try{await u.load(),this.#t.add(n),i?.(t)}catch{St(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Yt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(n){throw St(`Failed to load font '${i.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const n=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Tt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Tt(this,"isSyncFontLoadingSupported",Ie||Ae.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Lt(!n.done,"completeRequest() cannot be called twice."),n.done=!0;i.length>0&&i[0].done;){const a=i.shift();setTimeout(a.callback,0)}}const{loadingRequests:i}=this,n={done:!1,complete:e,callback:t};return i.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Tt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(x,D){return x.charCodeAt(D)<<24|x.charCodeAt(D+1)<<16|x.charCodeAt(D+2)<<8|x.charCodeAt(D+3)&255}function n(x,D,M,k){const I=x.substring(0,D),H=x.substring(D+M);return I+k+H}let a,o;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function p(x,D){if(++f>30){St("Load test font never loaded."),D();return}if(d.font="30px "+x,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(p.bind(null,x,D))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=n(v,976,g.length,g);const w=16,_=1482184792;let A=i(v,w);for(a=0,o=g.length-3;a<o;a+=4)A=A-_+i(g,a)|0;a<g.length&&(A=A-_+i(g+"XXX",a)|0),v=n(v,w,4,$T(A));const E=`url(data:font/opentype;base64,${btoa(v)});`,R=`@font-face {font-family:"${g}";src:${E}}`;this.insertRule(R);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const x of[t.loadedName,g]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=x,C.append(D)}this._document.body.append(C),p(g,()=>{C.remove(),e.complete()})}}class s1{#t;constructor(t,e=null,i,n){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),n&&(this.charProcOperatorList=n)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${F0(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let n;try{n=t.get(i)}catch(o){St(`getPathGenerator - ignoring character: "${o}".`)}const a=new Path2D(n||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=a}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}function n1(l){if(l instanceof URL)return l.href;if(typeof l=="string"){if(Ie)return l;const t=URL.parse(l,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function r1(l){if(Ie&&typeof Buffer<"u"&&l instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength)return l;if(typeof l=="string")return Vo(l);if(l instanceof ArrayBuffer||ArrayBuffer.isView(l)||typeof l=="object"&&!isNaN(l?.length))return new Uint8Array(l);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Tc(l){if(typeof l!="string")return null;if(l.endsWith("/"))return l;throw new Error(`Invalid factory url: "${l}" must include trailing slash.`)}const Cf=l=>typeof l=="object"&&Number.isInteger(l?.num)&&l.num>=0&&Number.isInteger(l?.gen)&&l.gen>=0,a1=l=>typeof l=="object"&&typeof l?.name=="string",W0=YT.bind(null,Cf,a1);class o1{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[n]of this.#t)n.call(this,i)})}addEventListener(t,e,i=null){let n=null;if(i?.signal instanceof AbortSignal){const{signal:a}=i;if(a.aborted){St("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);n=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}this.#t.set(e,n)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Cc={DATA:1,ERROR:2},ge={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function vb(){}function Ye(l){if(l instanceof Es||l instanceof Zc||l instanceof ub||l instanceof Io||l instanceof ef)return l;switch(l instanceof Error||typeof l=="object"&&l!==null||Yt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),l.name){case"AbortException":return new Es(l.message);case"InvalidPDFException":return new Zc(l.message);case"PasswordException":return new ub(l.message,l.code);case"ResponseException":return new Io(l.message,l.status,l.missing);case"UnknownErrorException":return new ef(l.message,l.details)}return new ef(l.message,l.toString())}class So{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const i=t.callbackId,n=this.callbackCapabilities[i];if(!n)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Cc.DATA)n.resolve(t.data);else if(t.callback===Cc.ERROR)n.reject(Ye(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,n=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(o){a.postMessage({sourceName:i,targetName:n,callback:Cc.DATA,callbackId:t.callbackId,data:o})},function(o){a.postMessage({sourceName:i,targetName:n,callback:Cc.ERROR,callbackId:t.callbackId,reason:Ye(o)})});return}if(t.streamId){this.#s(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[n]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(o){a.reject(o)}return a.promise}sendWithStream(t,e,i,n){const a=this.streamId++,o=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:o,targetName:u,action:t,streamId:a,data:e,desiredSize:f.desiredSize},n),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,d.postMessage({sourceName:o,targetName:u,stream:ge.PULL,streamId:a,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Lt(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,d.postMessage({sourceName:o,targetName:u,stream:ge.CANCEL,streamId:a,reason:Ye(f)}),p.promise}},i)}#s(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,a=this.comObj,o=this,u=this.actionHandler[t.action],d={enqueue(f,p=1,g){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:i,targetName:n,stream:ge.ENQUEUE,streamId:e,chunk:f},g)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:n,stream:ge.CLOSE,streamId:e}),delete o.streamSinks[e])},error(f){Lt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:n,stream:ge.ERROR,streamId:e,reason:Ye(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){a.postMessage({sourceName:i,targetName:n,stream:ge.START_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:i,targetName:n,stream:ge.START_COMPLETE,streamId:e,reason:Ye(f)})})}#i(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,a=this.comObj,o=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case ge.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(Ye(t.reason));break;case ge.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(Ye(t.reason));break;case ge.PULL:if(!u){a.postMessage({sourceName:i,targetName:n,stream:ge.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||vb).then(function(){a.postMessage({sourceName:i,targetName:n,stream:ge.PULL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:i,targetName:n,stream:ge.PULL_COMPLETE,streamId:e,reason:Ye(f)})});break;case ge.ENQUEUE:if(Lt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case ge.CLOSE:if(Lt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,e);break;case ge.ERROR:Lt(o,"error should have stream controller"),o.controller.error(Ye(t.reason)),this.#a(o,e);break;case ge.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(Ye(t.reason)),this.#a(o,e);break;case ge.CANCEL:if(!u)break;const d=Ye(t.reason);Promise.try(u.onCancel||vb,d).then(function(){a.postMessage({sourceName:i,targetName:n,stream:ge.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:i,targetName:n,stream:ge.CANCEL_COMPLETE,streamId:e,reason:Ye(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Q0{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Yt("Abstract method `_createCanvas` called.")}}class l1 extends Q0{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class J0{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Yt("Abstract method `_fetch` called.")}}class bb extends J0{async _fetch(t){const e=await da(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Vo(e)}}class Z0{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,a){return"none"}destroy(t=!1){}}class c1 extends Z0{#t;#e;#s;#i;#a;#n;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#n||=new Map}get#l(){if(!this.#s){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#a.createElementNS(vs,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#s=this.#a.createElementNS(vs,"defs"),t.append(i),i.append(this.#s),this.#a.body.append(t)}return this.#s}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let g=0;g<256;g++)f[g]=d[g]/255;const p=f.join(",");return[p,p,p]}const[e,i,n]=t,a=new Array(256),o=new Array(256),u=new Array(256);for(let d=0;d<256;d++)a[d]=e[d]/255,o[d]=i[d]/255,u[d]=n[d]/255;return[a.join(","),o.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Yo(e)?St('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=np(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,n,a]=this.#d(t),o=t.length===1?i:`${i}${n}${a}`;if(e=this.#o.get(o),e)return this.#o.set(t,e),e;const u=`g_${this.#i}_transfer_map_${this.#r++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(o,d);const f=this.#p(u);return this.#g(i,n,a,f),d}addHCMFilter(t,e){const i=`${t}-${e}`,n="base";let a=this.#c.get(n);if(a?.key===i||(a?(a.filter?.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},this.#c.set(n,a)),!t||!e))return a.url;const o=this.#b(t);t=tt.makeHexColor(...o);const u=this.#b(e);if(e=tt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const d=new Array(256);for(let b=0;b<=255;b++){const w=b/255;d[b]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const f=d.join(","),p=`g_${this.#i}_hcm_filter`,g=a.filter=this.#p(p);this.#g(f,f,f,g),this.#m(g);const v=(b,w)=>{const _=o[b]/255,A=u[b]/255,E=new Array(w+1);for(let R=0;R<=w;R++)E[R]=_+R/w*(A-_);return E.join(",")};return this.#g(v(0,5),v(1,5),v(2,5),g),a.url=this.#h(p),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),n=`alpha_${i}`;if(e=this.#o.get(n),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_alpha_map_${this.#r++}`,o=this.#h(a);this.#o.set(t,o),this.#o.set(n,o);const u=this.#p(a);return this.#y(i,u),o}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,n;if(t?([i]=this.#d([t]),n=`luminosity_${i}`):n="luminosity",e=this.#o.get(n),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_luminosity_map_${this.#r++}`,o=this.#h(a);this.#o.set(t,o),this.#o.set(n,o);const u=this.#p(a);return this.#f(u),t&&this.#y(i,u),o}addHighlightHCMFilter(t,e,i,n,a){const o=`${e}-${i}-${n}-${a}`;let u=this.#c.get(t);if(u?.key===o||(u?(u.filter?.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},this.#c.set(t,u)),!e||!i))return u.url;const[d,f]=[e,i].map(this.#b.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),g=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[v,b]=[n,a].map(this.#b.bind(this));g<p&&([p,g,v,b]=[g,p,b,v]),this.#l.style.color="";const w=(E,R,C)=>{const x=new Array(256),D=(g-p)/C,M=E/255,k=(R-E)/(255*C);let I=0;for(let H=0;H<=C;H++){const X=Math.round(p+H*D),W=M+H*k;for(let et=I;et<=X;et++)x[et]=W;I=X+1}for(let H=I;H<256;H++)x[H]=x[I-1];return x.join(",")},_=`g_${this.#i}_hcm_${t}_filter`,A=u.filter=this.#p(_);return this.#m(A),this.#g(w(v[0],b[0],5),w(v[1],b[1],5),w(v[2],b[2],5),A),u.url=this.#h(_),u.url}destroy(t=!1){t&&this.#n?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#e?.clear(),this.#e=null,this.#n?.clear(),this.#n=null,this.#r=0)}#f(t){const e=this.#a.createElementNS(vs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(vs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#a.createElementNS(vs,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,i){const n=this.#a.createElementNS(vs,e);n.setAttribute("type","discrete"),n.setAttribute("tableValues",i),t.append(n)}#g(t,e,i,n){const a=this.#a.createElementNS(vs,"feComponentTransfer");n.append(a),this.#u(a,"feFuncR",t),this.#u(a,"feFuncG",e),this.#u(a,"feFuncB",i)}#y(t,e){const i=this.#a.createElementNS(vs,"feComponentTransfer");e.append(i),this.#u(i,"feFuncA",t)}#b(t){return this.#l.style.color=t,fa(getComputedStyle(this.#l).getPropertyValue("color"))}}class t_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Yt("Abstract method `_fetch` called.")}}class _b extends t_{async _fetch(t){const e=await da(t,"arraybuffer");return new Uint8Array(e)}}class e_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Yt("Abstract method `_fetch` called.")}}class wb extends e_{async _fetch(t){const e=await da(t,"arraybuffer");return new Uint8Array(e)}}Ie&&St("Please use the `legacy` build in Node.js environments.");async function dp(l){const e=await process.getBuiltinModule("fs").promises.readFile(l);return new Uint8Array(e)}class u1 extends Z0{}class h1 extends Q0{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class d1 extends J0{async _fetch(t){return dp(t)}}class f1 extends t_{async _fetch(t){return dp(t)}}class p1 extends e_{async _fetch(t){return dp(t)}}const Ir="__forcedDependency",{floor:Sb,ceil:Ab}=Math;function Rc(l,t,e,i,n,a){l[t*4+0]=Math.min(l[t*4+0],e),l[t*4+1]=Math.min(l[t*4+1],i),l[t*4+2]=Math.max(l[t*4+2],n),l[t*4+3]=Math.max(l[t*4+3],a)}const Rf=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class g1{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Rf}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const xc=(l,t)=>{if(!l)return;let e=l.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},l.set(t,e)),e};class m1{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Ir]:[]};#s=new Map;#i=[];#a=[];#n=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#p;#u;#g;constructor(t,e,i=!1){this.#f=t.width,this.#m=t.height,this.#y(e),i&&(this.#g=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const i=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(i),this.#u=new Uint32Array(i),e&&e.length>0?(this.#u.set(e),this.#u.fill(Rf,e.length)):this.#u.fill(Rf)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Ir]:{__proto__:this.#e[Ir]}},this.#r={__proto__:this.#r},this.#i.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const i=this.#i.pop();return i!==void 0&&(xc(this.#g,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(xc(this.#g,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(xc(this.#g,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#n.push(tt.multiplyByDOMMatrix(this.#n.at(-1),t.getTransform())),this}popBaseTransform(){return this.#n.length>1&&this.#n.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#s.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#s.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Ir,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Ir,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,n,a,o){const u=tt.multiplyByDOMMatrix(this.#n.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];tt.axialAlignedBoundingBox([i,a,n,o],u,d);const f=tt.intersect(this.#r,d);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,i,n,a,o){const u=this.#r;if(u[0]===1/0)return this;const d=tt.multiplyByDOMMatrix(this.#n.at(-1),e.getTransform());if(u[0]===-1/0)return tt.axialAlignedBoundingBox([i,a,n,o],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return tt.axialAlignedBoundingBox([i,a,n,o],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,i,n=1,a=0,o=0,u){const d=i.bbox;let f,p;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(i),f!==!1&&(p=[0,0,0,0],tt.axialAlignedBoundingBox(d,i.fontMatrix,p),(n!==1||a!==0||o!==0)&&tt.scaleMinMax([n,0,0,-n,a,o],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const g=u();return d&&p&&f===void 0&&(f=p[0]<=a-g.actualBoundingBoxLeft&&p[2]>=a+g.actualBoundingBoxRight&&p[1]<=o-g.actualBoundingBoxAscent&&p[3]>=o+g.actualBoundingBoxDescent,this.#h.set(i,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,a-g.actualBoundingBoxLeft,a+g.actualBoundingBoxRight,o-g.actualBoundingBoxAscent,o+g.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,n=this.#t,a=this.#e;for(const o of e)o in this.#t?i.add(n[o]):o in a&&a[o].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#s.has(e)&&this.#l.add(this.#s.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Ir]),this.#g){const i=xc(this.#g,t),{dependencies:n}=i;this.#l.forEach(n.add,n),this.#i.forEach(n.add,n),this.#a.forEach(n.add,n),n.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=Sb(this.#o[0]*256/this.#f),n=Sb(this.#o[1]*256/this.#m),a=Ab(this.#o[2]*256/this.#f),o=Ab(this.#o[3]*256/this.#m);Rc(this.#p,t,i,n,a,o);for(const u of this.#l)u!==t&&Rc(this.#p,u,i,n,a,o);for(const u of this.#i)u!==t&&Rc(this.#p,u,i,n,a,o);for(const u of this.#a)u!==t&&Rc(this.#p,u,i,n,a,o);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const n of i)this.recordIncrementalData("sameLineText",n);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new g1(this.#u,this.#p)}takeDebugMetadata(){return this.#g}}class iu{#t;#e;#s;#i=0;#a=0;constructor(t,e,i){if(t instanceof iu&&t.#s===!!i)return t;this.#t=t,this.#e=e,this.#s=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#s||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,n,a,o){return this.#s||this.#t.recordClipBox(this.#e,e,i,n,a,o),this}recordBBox(t,e,i,n,a,o){return this.#s||this.#t.recordBBox(this.#e,e,i,n,a,o),this}recordCharacterBBox(t,e,i,n,a,o,u){return this.#s||this.#t.recordCharacterBBox(this.#e,e,i,n,a,o,u),this}recordFullPageBBox(t){return this.#s||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#s||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Ri={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Me={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function xf(l,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,i),l.clip(n)}class fp{isModifyingCurrentTransform(){return!1}getPattern(){Yt("Abstract method `getPattern` called.")}}class y1 extends fp{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,n){let a;if(n===Me.STROKE||n===Me.FILL){const o=e.current.getClippedPathBoundingBox(n,ee(t))||[0,0,0,0],u=Math.ceil(o[2]-o[0])||1,d=Math.ceil(o[3]-o[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),i=tt.transform(i,[1,0,0,1,o[0],o[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),xf(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=t.createPattern(f.canvas,"no-repeat");const g=new DOMMatrix(i);a.setTransform(g)}else xf(t,this._bbox),a=this._createGradient(t);return a}}function rf(l,t,e,i,n,a,o,u){const d=t.coords,f=t.colors,p=l.data,g=l.width*4;let v;d[e+1]>d[i+1]&&(v=e,e=i,i=v,v=a,a=o,o=v),d[i+1]>d[n+1]&&(v=i,i=n,n=v,v=o,o=u,u=v),d[e+1]>d[i+1]&&(v=e,e=i,i=v,v=a,a=o,o=v);const b=(d[e]+t.offsetX)*t.scaleX,w=(d[e+1]+t.offsetY)*t.scaleY,_=(d[i]+t.offsetX)*t.scaleX,A=(d[i+1]+t.offsetY)*t.scaleY,E=(d[n]+t.offsetX)*t.scaleX,R=(d[n+1]+t.offsetY)*t.scaleY;if(w>=R)return;const C=f[a],x=f[a+1],D=f[a+2],M=f[o],k=f[o+1],I=f[o+2],H=f[u],X=f[u+1],W=f[u+2],et=Math.round(w),mt=Math.round(R);let ft,yt,N,q,Q,vt,Ct,L;for(let $=et;$<=mt;$++){if($<A){const lt=$<w?0:(w-$)/(w-A);ft=b-(b-_)*lt,yt=C-(C-M)*lt,N=x-(x-k)*lt,q=D-(D-I)*lt}else{let lt;$>R?lt=1:A===R?lt=0:lt=(A-$)/(A-R),ft=_-(_-E)*lt,yt=M-(M-H)*lt,N=k-(k-X)*lt,q=I-(I-W)*lt}let K;$<w?K=0:$>R?K=1:K=(w-$)/(w-R),Q=b-(b-E)*K,vt=C-(C-H)*K,Ct=x-(x-X)*K,L=D-(D-W)*K;const J=Math.round(Math.min(ft,Q)),at=Math.round(Math.max(ft,Q));let ot=g*$+J*4;for(let lt=J;lt<=at;lt++)K=(ft-lt)/(ft-Q),K<0?K=0:K>1&&(K=1),p[ot++]=yt-(yt-vt)*K|0,p[ot++]=N-(N-Ct)*K|0,p[ot++]=q-(q-L)*K|0,p[ot++]=255}}function v1(l,t,e){const i=t.coords,n=t.colors;let a,o;switch(t.type){case"lattice":const u=t.verticesPerRow,d=Math.floor(i.length/u)-1,f=u-1;for(a=0;a<d;a++){let p=a*u;for(let g=0;g<f;g++,p++)rf(l,e,i[p],i[p+1],i[p+u],n[p],n[p+1],n[p+u]),rf(l,e,i[p+u+1],i[p+1],i[p+u],n[p+u+1],n[p+1],n[p+u])}break;case"triangles":for(a=0,o=i.length;a<o;a+=3)rf(l,e,i[a],i[a+1],i[a+2],n[a],n[a+1],n[a+2]);break;default:throw new Error("illegal figure")}}class b1 extends fp{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,g=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),b=f/g,w=p/v,_={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/b,scaleY:1/w},A=g+4,E=v+4,R=i.getCanvas("mesh",A,E),C=R.context,x=C.createImageData(g,v);if(e){const M=x.data;for(let k=0,I=M.length;k<I;k+=4)M[k]=e[0],M[k+1]=e[1],M[k+2]=e[2],M[k+3]=255}for(const M of this._figures)v1(x,M,_);return C.putImageData(x,2,2),{canvas:R.canvas,offsetX:u-2*b,offsetY:d-2*w,scaleX:b,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,n){xf(t,this._bbox);const a=new Float32Array(2);if(n===Me.SHADING)tt.singularValueDecompose2dScale(ee(t),a);else if(this.matrix){tt.singularValueDecompose2dScale(this.matrix,a);const[u,d]=a;tt.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=u,a[1]*=d}else tt.singularValueDecompose2dScale(e.baseTransform,a);const o=this._createMeshCanvas(a,n===Me.SHADING?null:this._background,e.cachedCanvases);return n!==Me.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class _1 extends fp{getPattern(){return"hotpink"}}function w1(l){switch(l[0]){case"RadialAxial":return new y1(l);case"Mesh":return new b1(l);case"Dummy":return new _1}throw new Error(`Unknown IR type: ${l[0]}`)}const Eb={COLORED:1,UNCOLORED:2};class pp{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,n){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(t,e){const{bbox:i,operatorList:n,paintType:a,tilingType:o,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),gu("TilingType: "+o);const g=i[0],v=i[1],b=i[2],w=i[3],_=b-g,A=w-v,E=new Float32Array(2);tt.singularValueDecompose2dScale(this.matrix,E);const[R,C]=E;tt.singularValueDecompose2dScale(this.baseTransform,E);const x=R*E[0],D=C*E[1];let M=_,k=A,I=!1,H=!1;const X=Math.ceil(f*x),W=Math.ceil(p*D),et=Math.ceil(_*x),mt=Math.ceil(A*D);X>=et?M=f:I=!0,W>=mt?k=p:H=!0;const ft=this.getSizeAndScale(M,this.ctx.canvas.width,x),yt=this.getSizeAndScale(k,this.ctx.canvas.height,D),N=t.cachedCanvases.getCanvas("pattern",ft.size,yt.size),q=N.context,Q=d.createCanvasGraphics(q,e);if(Q.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Q,a,u),q.translate(-ft.scale*g,-yt.scale*v),Q.transform(0,ft.scale,0,0,yt.scale,0,0),q.save(),Q.dependencyTracker?.save(),this.clipBbox(Q,g,v,b,w),Q.baseTransform=ee(Q.ctx),Q.executeOperatorList(n),Q.endDrawing(),Q.dependencyTracker?.restore(),q.restore(),I||H){const vt=N.canvas;I&&(M=f),H&&(k=p);const Ct=this.getSizeAndScale(M,this.ctx.canvas.width,x),L=this.getSizeAndScale(k,this.ctx.canvas.height,D),$=Ct.size,K=L.size,J=t.cachedCanvases.getCanvas("pattern-workaround",$,K),at=J.context,ot=I?Math.floor(_/f):0,lt=H?Math.floor(A/p):0;for(let Xt=0;Xt<=ot;Xt++)for(let Pt=0;Pt<=lt;Pt++)at.drawImage(vt,$*Xt,K*Pt,$,K,0,0,$,K);return{canvas:J.canvas,scaleX:Ct.scale,scaleY:L.scale,offsetX:g,offsetY:v}}return{canvas:N.canvas,scaleX:ft.scale,scaleY:yt.scale,offsetX:g,offsetY:v}}getSizeAndScale(t,e,i){const n=Math.max(pp.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*i);return a>=n?a=n:i=a/t,{scale:i,size:a}}clipBbox(t,e,i,n,a){const o=n-e,u=a-i;t.ctx.rect(e,i,o,u),tt.axialAlignedBoundingBox([e,i,n,a],ee(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,a=t.current;switch(e){case Eb.COLORED:const{fillStyle:o,strokeStyle:u}=this.ctx;n.fillStyle=a.fillColor=o,n.strokeStyle=a.strokeColor=u;break;case Eb.UNCOLORED:n.fillStyle=n.strokeStyle=i,a.fillColor=a.strokeColor=i;break;default:throw new HT(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,n,a){let o=i;n!==Me.SHADING&&(o=tt.transform(o,e.baseTransform),this.matrix&&(o=tt.transform(o,this.matrix)));const u=this.createPatternCanvas(e,a);let d=new DOMMatrix(o);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function S1({src:l,srcPos:t=0,dest:e,width:i,height:n,nonBlackColor:a=4294967295,inverseDecode:o=!1}){const u=Ae.isLittleEndian?4278190080:255,[d,f]=o?[a,u]:[u,a],p=i>>3,g=i&7,v=l.length;e=new Uint32Array(e.buffer);let b=0;for(let w=0;w<n;w++){for(const A=t+p;t<A;t++){const E=t<v?l[t]:255;e[b++]=E&128?f:d,e[b++]=E&64?f:d,e[b++]=E&32?f:d,e[b++]=E&16?f:d,e[b++]=E&8?f:d,e[b++]=E&4?f:d,e[b++]=E&2?f:d,e[b++]=E&1?f:d}if(g===0)continue;const _=t<v?l[t++]:255;for(let A=0;A<g;A++)e[b++]=_&1<<7-A?f:d}return{srcPos:t,destPos:b}}const Tb=16,Cb=100,A1=15,Rb=10,Xe=16,af=new DOMMatrix,ui=new Float32Array(2),Kr=new Float32Array([1/0,1/0,-1/0,-1/0]);function E1(l,t){if(l._removeMirroring)throw new Error("Context is already forwarding operations.");l.__originalSave=l.save,l.__originalRestore=l.restore,l.__originalRotate=l.rotate,l.__originalScale=l.scale,l.__originalTranslate=l.translate,l.__originalTransform=l.transform,l.__originalSetTransform=l.setTransform,l.__originalResetTransform=l.resetTransform,l.__originalClip=l.clip,l.__originalMoveTo=l.moveTo,l.__originalLineTo=l.lineTo,l.__originalBezierCurveTo=l.bezierCurveTo,l.__originalRect=l.rect,l.__originalClosePath=l.closePath,l.__originalBeginPath=l.beginPath,l._removeMirroring=()=>{l.save=l.__originalSave,l.restore=l.__originalRestore,l.rotate=l.__originalRotate,l.scale=l.__originalScale,l.translate=l.__originalTranslate,l.transform=l.__originalTransform,l.setTransform=l.__originalSetTransform,l.resetTransform=l.__originalResetTransform,l.clip=l.__originalClip,l.moveTo=l.__originalMoveTo,l.lineTo=l.__originalLineTo,l.bezierCurveTo=l.__originalBezierCurveTo,l.rect=l.__originalRect,l.closePath=l.__originalClosePath,l.beginPath=l.__originalBeginPath,delete l._removeMirroring},l.save=function(){t.save(),this.__originalSave()},l.restore=function(){t.restore(),this.__originalRestore()},l.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},l.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},l.transform=function(e,i,n,a,o,u){t.transform(e,i,n,a,o,u),this.__originalTransform(e,i,n,a,o,u)},l.setTransform=function(e,i,n,a,o,u){t.setTransform(e,i,n,a,o,u),this.__originalSetTransform(e,i,n,a,o,u)},l.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},l.rotate=function(e){t.rotate(e),this.__originalRotate(e)},l.clip=function(e){t.clip(e),this.__originalClip(e)},l.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},l.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},l.bezierCurveTo=function(e,i,n,a,o,u){t.bezierCurveTo(e,i,n,a,o,u),this.__originalBezierCurveTo(e,i,n,a,o,u)},l.rect=function(e,i,n,a){t.rect(e,i,n,a),this.__originalRect(e,i,n,a)},l.closePath=function(){t.closePath(),this.__originalClosePath()},l.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class T1{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Oc(l,t,e,i,n,a,o,u,d,f){const[p,g,v,b,w,_]=ee(l);if(g===0&&v===0){const R=o*p+w,C=Math.round(R),x=u*b+_,D=Math.round(x),M=(o+d)*p+w,k=Math.abs(Math.round(M)-C)||1,I=(u+f)*b+_,H=Math.abs(Math.round(I)-D)||1;return l.setTransform(Math.sign(p),0,0,Math.sign(b),C,D),l.drawImage(t,e,i,n,a,0,0,k,H),l.setTransform(p,g,v,b,w,_),[k,H]}if(p===0&&b===0){const R=u*v+w,C=Math.round(R),x=o*g+_,D=Math.round(x),M=(u+f)*v+w,k=Math.abs(Math.round(M)-C)||1,I=(o+d)*g+_,H=Math.abs(Math.round(I)-D)||1;return l.setTransform(0,Math.sign(g),Math.sign(v),0,C,D),l.drawImage(t,e,i,n,a,0,0,H,k),l.setTransform(p,g,v,b,w,_),[H,k]}l.drawImage(t,e,i,n,a,o,u,d,f);const A=Math.hypot(p,g),E=Math.hypot(v,b);return[A*d,E*f]}class xb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Af;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Oe.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Kr.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Me.FILL,e=null){const i=this.minMax.slice();if(t===Me.STROKE){e||Yt("Stroke bounding box must include transform."),tt.singularValueDecompose2dScale(e,ui);const n=ui[0]*this.lineWidth/2,a=ui[1]*this.lineWidth/2;i[0]-=n,i[1]-=a,i[2]+=n,i[3]+=a}return i}updateClipFromPath(){const t=tt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Kr,0)}getClippedPathBoundingBox(t=Me.FILL,e=null){return tt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Ob(l,t){if(t instanceof ImageData){l.putImageData(t,0,0);return}const e=t.height,i=t.width,n=e%Xe,a=(e-n)/Xe,o=n===0?a:a+1,u=l.createImageData(i,Xe);let d=0,f;const p=t.data,g=u.data;let v,b,w,_;if(t.kind===xo.GRAYSCALE_1BPP){const A=p.byteLength,E=new Uint32Array(g.buffer,0,g.byteLength>>2),R=E.length,C=i+7>>3,x=4294967295,D=Ae.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(w=v<a?Xe:n,f=0,b=0;b<w;b++){const M=A-d;let k=0;const I=M>C?i:M*8-7,H=I&-8;let X=0,W=0;for(;k<H;k+=8)W=p[d++],E[f++]=W&128?x:D,E[f++]=W&64?x:D,E[f++]=W&32?x:D,E[f++]=W&16?x:D,E[f++]=W&8?x:D,E[f++]=W&4?x:D,E[f++]=W&2?x:D,E[f++]=W&1?x:D;for(;k<I;k++)X===0&&(W=p[d++],X=128),E[f++]=W&X?x:D,X>>=1}for(;f<R;)E[f++]=0;l.putImageData(u,0,v*Xe)}}else if(t.kind===xo.RGBA_32BPP){for(b=0,_=i*Xe*4,v=0;v<a;v++)g.set(p.subarray(d,d+_)),d+=_,l.putImageData(u,0,b),b+=Xe;v<o&&(_=i*n*4,g.set(p.subarray(d,d+_)),l.putImageData(u,0,b))}else if(t.kind===xo.RGB_24BPP)for(w=Xe,_=i*w,v=0;v<o;v++){for(v>=a&&(w=n,_=i*w),f=0,b=_;b--;)g[f++]=p[d++],g[f++]=p[d++],g[f++]=p[d++],g[f++]=255;l.putImageData(u,0,v*Xe)}else throw new Error(`bad image kind: ${t.kind}`)}function Mb(l,t){if(t.bitmap){l.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,n=e%Xe,a=(e-n)/Xe,o=n===0?a:a+1,u=l.createImageData(i,Xe);let d=0;const f=t.data,p=u.data;for(let g=0;g<o;g++){const v=g<a?Xe:n;({srcPos:d}=S1({src:f,srcPos:d,dest:p,width:i,height:v,nonBlackColor:0})),l.putImageData(u,0,g*Xe)}}function mo(l,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)l[i]!==void 0&&(t[i]=l[i]);l.setLineDash!==void 0&&(t.setLineDash(l.getLineDash()),t.lineDashOffset=l.lineDashOffset)}function Mc(l){l.strokeStyle=l.fillStyle="#000000",l.fillRule="nonzero",l.globalAlpha=1,l.lineWidth=1,l.lineCap="butt",l.lineJoin="miter",l.miterLimit=10,l.globalCompositeOperation="source-over",l.font="10px sans-serif",l.setLineDash!==void 0&&(l.setLineDash([]),l.lineDashOffset=0);const{filter:t}=l;t!=="none"&&t!==""&&(l.filter="none")}function kb(l,t){if(t)return!0;tt.singularValueDecompose2dScale(l,ui);const e=Math.fround(Ui.pixelRatio*Gn.PDF_TO_CSS_UNITS);return ui[0]<=e&&ui[1]<=e}const C1=["butt","round","square"],R1=["miter","round","bevel"],x1={},Db={};class Zr{constructor(t,e,i,n,a,{optionalContentConfig:o,markedContentStack:u=null},d,f,p){this.ctx=t,this.current=new xb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=o,this.cachedCanvases=new T1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const a=this.ctx.canvas.width,o=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,a,o),this.ctx.fillStyle=u,i){const d=this.cachedCanvases.getCanvas("transparent",a,o);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...ee(this.compositeCtx))}this.ctx.save(),Mc(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ee(this.ctx)}executeOperatorList(t,e,i,n,a){const o=t.argsArray,u=t.fnArray;let d=e||0;const f=o.length;if(f===d)return d;const p=f-d>Rb&&typeof i=="function",g=p?Date.now()+A1:0;let v=0;const b=this.commonObjs,w=this.objs;let _,A;for(;;){if(n!==void 0&&d===n.nextBreakPoint)return n.breakIt(d,i),d;if(!a||a(d))if(_=u[d],A=o[d]??null,_!==oa.dependency)A===null?this[_](d):this[_](d,...A);else for(const E of A){this.dependencyTracker?.recordNamedData(E,d);const R=E.startsWith("g_")?b:w;if(!R.has(E))return R.get(E,i),d}if(d++,d===f)return d;if(p&&++v>Rb){if(Date.now()>g)return i(),d;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,n=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),u=i,d=n,f="prescale1",p,g;for(;a>2&&u>1||o>2&&d>1;){let v=u,b=d;a>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),a/=u/v),o>2&&d>1&&(b=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,o/=d/b),p=this.cachedCanvases.getCanvas(f,v,b),g=p.context,g.clearRect(0,0,v,b),g.drawImage(t,0,0,u,d,0,0,v,b),t=p.canvas,u=v,d=b,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const i=this.ctx,{width:n,height:a}=e,o=this.current.fillColor,u=this.current.patternFill,d=ee(i);let f,p,g,v;if((e.bitmap||e.data)&&e.count>1){const X=e.bitmap||e.data.buffer;p=JSON.stringify(u?d:[d.slice(0,4),o]),f=this._cachedBitmapsMap.get(X),f||(f=new Map,this._cachedBitmapsMap.set(X,f));const W=f.get(p);if(W&&!u){const et=Math.round(Math.min(d[0],d[2])+d[4]),mt=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Ri.transformAndFill),{canvas:W,offsetX:et,offsetY:mt}}g=W}g||(v=this.cachedCanvases.getCanvas("maskCanvas",n,a),Mb(v.context,e));let b=tt.transform(d,[1/n,0,0,-1/a,0,0]);b=tt.transform(b,[1,0,0,1,0,-a]);const w=Kr.slice();tt.axialAlignedBoundingBox([0,0,n,a],b,w);const[_,A,E,R]=w,C=Math.round(E-_)||1,x=Math.round(R-A)||1,D=this.cachedCanvases.getCanvas("fillCanvas",C,x),M=D.context,k=_,I=A;M.translate(-k,-I),M.transform(...b),g||(g=this._scaleImage(v.canvas,Gi(M)),g=g.img,f&&u&&f.set(p,g)),M.imageSmoothingEnabled=kb(ee(M),e.interpolate),Oc(M,g,0,0,g.width,g.height,0,0,n,a),M.globalCompositeOperation="source-in";const H=tt.transform(Gi(M),[1,0,0,1,-k,-I]);return M.fillStyle=u?o.getPattern(i,this,H,Me.FILL,t):o,M.fillRect(0,0,n,a),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,D.canvas)),this.dependencyTracker?.recordDependencies(t,Ri.transformAndFill),{canvas:D.canvas,offsetX:Math.round(k),offsetY:Math.round(I)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=C1[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=R1[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,n]of e)switch(i){case"LW":this.setLineWidth(t,n);break;case"LC":this.setLineCap(t,n);break;case"LJ":this.setLineJoin(t,n);break;case"ML":this.setMiterLimit(t,n);break;case"D":this.setDash(t,n[0],n[1]);break;case"RI":this.setRenderingIntent(t,n);break;case"FL":this.setFlatness(t,n);break;case"Font":this.setFont(t,n[0],n[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=n;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=n;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(n,e,i);this.suspendedCtx=this.ctx;const o=this.ctx=a.context;o.setTransform(this.suspendedCtx.getTransform()),mo(this.suspendedCtx,o),E1(o,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),mo(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const a=n[0],o=n[1],u=n[2]-a,d=n[3]-o;u===0||d===0||(this.genericComposeSMask(e.context,i,u,d,e.subtype,e.backdrop,e.transferMap,a,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,a,o,u,d,f,p,g){let v=t.canvas,b=d-p,w=f-g;if(o)if(b<0||w<0||b+i>v.width||w+n>v.height){const A=this.cachedCanvases.getCanvas("maskExtension",i,n),E=A.context;E.drawImage(v,-b,-w),E.globalCompositeOperation="destination-atop",E.fillStyle=o,E.fillRect(0,0,i,n),E.globalCompositeOperation="source-over",v=A.canvas,b=w=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(b,w,i,n),t.clip(A),t.globalCompositeOperation="destination-atop",t.fillStyle=o,t.fillRect(b,w,i,n),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const _=new Path2D;_.rect(d,f,i,n),e.clip(_),e.globalCompositeOperation="destination-in",e.drawImage(v,b,w,i,n,d,f,i,n),e.restore()}save(t){this.inSMaskMode&&mo(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&mo(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,n,a,o,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,n,a,o,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,n){let[a]=i;if(!n){a||=i[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const o=e===oa.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,n[0]-o,n[2]+o,n[1]-o,n[3]+o).recordDependencies(t,["transform"])}if(!(a instanceof Path2D)){const o=i[0]=new Path2D;for(let u=0,d=a.length;u<d;)switch(a[u++]){case Ac.moveTo:o.moveTo(a[u++],a[u++]);break;case Ac.lineTo:o.lineTo(a[u++],a[u++]);break;case Ac.curveTo:o.bezierCurveTo(a[u++],a[u++],a[u++],a[u++],a[u++],a[u++]);break;case Ac.closePath:o.closePath();break;default:St(`Unrecognized drawing path operator: ${a[u-1]}`);break}a=o}tt.axialAlignedBoundingBox(n,ee(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const n=this.ctx,a=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const o=a.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=a.getPattern(n,this,Gi(n),Me.STROKE,t),o){const u=new Path2D;u.addPath(e,n.getTransform().invertSelf().multiplySelf(o)),e=u}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Ri.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Me.STROKE,ee(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const n=this.ctx,a=this.current.fillColor,o=this.current.patternFill;let u=!1;if(o){const f=a.isModifyingCurrentTransform()?n.getTransform():null;if(this.dependencyTracker?.save(t),n.save(),n.fillStyle=a.getPattern(n,this,Gi(n),Me.FILL,t),f){const p=new Path2D;p.addPath(e,n.getTransform().invertSelf().multiplySelf(f)),e=p}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),this.dependencyTracker?.recordDependencies(t,Ri.fill),u&&(n.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Ri.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=x1}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Db}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;e!==void 0&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",t),n.recordCloseMarker(t)}if(e!==void 0){const n=new Path2D,a=i.getTransform().invertSelf();for(const{transform:o,x:u,y:d,fontSize:f,path:p}of e)p&&n.addPath(p,new DOMMatrix(o).preMultiplySelf(a).translate(u,d).scale(f,-f));i.clip(n)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const n=this.commonObjs.get(e),a=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=n.fontMatrix||Af,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&St("Invalid font matrix for font "+e),i<0?(i=-i,a.fontDirection=-1):a.fontDirection=1,this.current.font=n,this.current.fontSize=i,n.isType3Font)return;const o=n.loadedName||"sans-serif",u=n.systemFontInfo?.css||`"${o}", ${n.fallbackName}`;let d="normal";n.black?d="900":n.bold&&(d="bold");const f=n.italic?"italic":"normal";let p=i;i<Tb?p=Tb:i>Cb&&(p=Cb),this.current.fontSizeScale=i/p,this.ctx.font=`${f} ${d} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#s(t,e,i){const n=new Path2D;return n.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),n}paintChar(t,e,i,n,a,o){const u=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,g=d.fontSize/d.fontSizeScale,v=p&Oe.FILL_STROKE_MASK,b=!!(p&Oe.ADD_TO_PATH_FLAG),w=d.patternFill&&!f.missingFile,_=d.patternStroke&&!f.missingFile;let A;if((f.disableFontFace||b||w||_)&&!f.missingFile&&(A=f.getPathGenerator(this.commonObjs,e)),A&&(f.disableFontFace||w||_)){u.save(),u.translate(i,n),u.scale(g,-g),this.dependencyTracker?.recordCharacterBBox(t,u,f);let E;if(v===Oe.FILL||v===Oe.FILL_STROKE)if(a){E=u.getTransform(),u.setTransform(...a);const R=this.#s(A,E,a);u.fill(R)}else u.fill(A);if(v===Oe.STROKE||v===Oe.FILL_STROKE)if(o){E||=u.getTransform(),u.setTransform(...o);const{a:R,b:C,c:x,d:D}=E,M=tt.inverseTransform(o),k=tt.transform([R,C,x,D,0,0],M);tt.singularValueDecompose2dScale(k,ui),u.lineWidth*=Math.max(ui[0],ui[1])/g,u.stroke(this.#s(A,E,o))}else u.lineWidth/=g,u.stroke(A);u.restore()}else(v===Oe.FILL||v===Oe.FILL_STROKE)&&(u.fillText(e,i,n),this.dependencyTracker?.recordCharacterBBox(t,u,f,g,i,n,()=>u.measureText(e))),(v===Oe.STROKE||v===Oe.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,g,i,n,()=>u.measureText(e)).recordDependencies(t,Ri.stroke),u.strokeText(e,i,n));b&&((this.pendingTextPaths||=[]).push({transform:ee(u),x:i,y:n,fontSize:g,path:A}),this.dependencyTracker?.recordCharacterBBox(t,u,f,g,i,n))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return Tt(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Ri.showText).resetBBox(t),this.current.textRenderingMode&Oe.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,n=i.font;if(n.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const a=i.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const o=this.ctx,u=i.fontSizeScale,d=i.charSpacing,f=i.wordSpacing,p=i.fontDirection,g=i.textHScale*p,v=e.length,b=n.vertical,w=b?1:-1,_=n.defaultVMetrics,A=a*i.fontMatrix[0],E=i.textRenderingMode===Oe.FILL&&!n.disableFontFace&&!i.patternFill;o.save(),i.textMatrix&&o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),p>0?o.scale(g,-1):o.scale(g,1);let R,C;if(i.patternFill){o.save();const I=i.fillColor.getPattern(o,this,Gi(o),Me.FILL,t);R=ee(o),o.restore(),o.fillStyle=I}if(i.patternStroke){o.save();const I=i.strokeColor.getPattern(o,this,Gi(o),Me.STROKE,t);C=ee(o),o.restore(),o.strokeStyle=I}let x=i.lineWidth;const D=i.textMatrixScale;if(D===0||x===0){const I=i.textRenderingMode&Oe.FILL_STROKE_MASK;(I===Oe.STROKE||I===Oe.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=D;if(u!==1&&(o.scale(u,u),x/=u),o.lineWidth=x,n.isInvalidPDFjsFont){const I=[];let H=0;for(const W of e)I.push(W.unicode),H+=W.width;const X=I.join("");if(o.fillText(X,0,0),this.dependencyTracker!==null){const W=o.measureText(X);this.dependencyTracker.recordBBox(t,this.ctx,-W.actualBoundingBoxLeft,W.actualBoundingBoxRight,-W.actualBoundingBoxAscent,W.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=H*A*g,o.restore(),this.compose();return}let M=0,k;for(k=0;k<v;++k){const I=e[k];if(typeof I=="number"){M+=w*I*a/1e3;continue}let H=!1;const X=(I.isSpace?f:0)+d,W=I.fontChar,et=I.accent;let mt,ft,yt=I.width;if(b){const Q=I.vmetric||_,vt=-(I.vmetric?Q[1]:yt*.5)*A,Ct=Q[2]*A;yt=Q?-Q[0]:yt,mt=vt/u,ft=(M+Ct)/u}else mt=M/u,ft=0;let N;if(n.remeasure&&yt>0){N=o.measureText(W);const Q=N.width*1e3/a*u;if(yt<Q&&this.isFontSubpixelAAEnabled){const vt=yt/Q;H=!0,o.save(),o.scale(vt,1),mt/=vt}else yt!==Q&&(mt+=(yt-Q)/2e3*a/u)}if(this.contentVisible&&(I.isInFont||n.missingFile)){if(E&&!et)o.fillText(W,mt,ft),this.dependencyTracker?.recordCharacterBBox(t,o,N?{bbox:null}:n,a/u,mt,ft,()=>N??o.measureText(W));else if(this.paintChar(t,W,mt,ft,R,C),et){const Q=mt+a*et.offset.x/u,vt=ft-a*et.offset.y/u;this.paintChar(t,et.fontChar,Q,vt,R,C)}}const q=b?yt*A-X*p:yt*A+X*p;M+=q,H&&o.restore()}b?i.y-=M:i.x+=M*g,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,n=this.current,a=n.font,o=n.fontSize,u=n.fontDirection,d=a.vertical?1:-1,f=n.charSpacing,p=n.wordSpacing,g=n.textHScale*u,v=n.fontMatrix||Af,b=e.length,w=n.textRenderingMode===Oe.INVISIBLE;let _,A,E,R;if(w||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),n.textMatrix&&i.transform(...n.textMatrix),i.translate(n.x,n.y+n.textRise),i.scale(g,u);const C=this.dependencyTracker;for(this.dependencyTracker=C?new iu(C,t):null,_=0;_<b;++_){if(A=e[_],typeof A=="number"){R=d*A*o/1e3,this.ctx.translate(R,0),n.x+=R*g;continue}const x=(A.isSpace?p:0)+f,D=a.charProcOperatorList[A.operatorListId];D?this.contentVisible&&(this.save(),i.scale(o,o),i.transform(...v),this.executeOperatorList(D),this.restore()):St(`Type3 character "${A.operatorListId}" is not available.`);const M=[A.width,0];tt.applyTransform(M,v),E=M[0]*o+x,i.translate(E,0),n.x+=E*g}i.restore(),C&&(this.dependencyTracker=C)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,n,a,o,u){const d=new Path2D;d.rect(n,a,o-n,u-a),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,n,o,a,u).recordClipBox(t,this.ctx,n,o,a,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const n=this.baseTransform||ee(this.ctx),a={createCanvasGraphics:(o,u)=>new Zr(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new iu(this.dependencyTracker,u,!0):null)};i=new pp(e,this.ctx,a,n)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=w1(this.getObject(t,e)),this.cachedPatterns.set(e,n)),i&&(n.matrix=i),n}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const n=this._getPattern(t,e);i.fillStyle=n.getPattern(i,this,Gi(i),Me.SHADING,t);const a=Gi(i);if(a){const{width:o,height:u}=i.canvas,d=Kr.slice();tt.axialAlignedBoundingBox([0,0,o,u],a,d);const[f,p,g,v]=d;this.ctx.fillRect(f,p,g-f,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Ri.transform).recordDependencies(t,Ri.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Yt("Should not call beginInlineImage")}beginImageData(){Yt("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ee(this.ctx),i)){tt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[n,a,o,u]=i,d=new Path2D;d.rect(n,a,o-n,u-a),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,n,o,a,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||gu("TODO: Support non-isolated groups."),e.knockout&&St("Knockout groups not supported.");const n=ee(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=Kr.slice();tt.axialAlignedBoundingBox(e.bbox,ee(i),a);const o=[0,0,i.canvas.width,i.canvas.height];a=tt.intersect(a,o)||[0,0,0,0];const u=Math.floor(a[0]),d=Math.floor(a[1]),f=Math.max(Math.ceil(a[2])-u,1),p=Math.max(Math.ceil(a[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let g="groupAt"+this.groupLevel;e.smask&&(g+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(g,f,p),b=v.context;b.translate(-u,-d),b.transform(...n);let w=new Path2D;const[_,A,E,R]=e.bbox;if(w.rect(_,A,E-_,R-A),e.matrix){const C=new Path2D;C.addPath(w,new DOMMatrix(e.matrix)),w=C}b.clip(w),e.smask&&this.smaskStack.push({canvas:v.canvas,context:b,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,d),i.save()),mo(i,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=ee(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const o=Kr.slice();tt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],a,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,i,n,a,o){if(this.#t(),Mc(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],d=i[3]-i[1];if(o&&this.annotationCanvasMap){n=n.slice(),n[4]-=i[0],n[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=d,tt.singularValueDecompose2dScale(ee(this.ctx),ui);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),g=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,g);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(ui[0],0,0,-ui[1],0,d*ui[1]),Mc(this.ctx)}else{Mc(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],u,d),this.ctx.clip(f)}}this.current=new xb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...n),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const n=this.ctx,a=this._createMaskCanvas(t,e),o=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+o.width,a.offsetY,a.offsetY+o.height).recordOperation(t),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,n=0,a=0,o,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=ee(d);d.transform(i,n,a,o,0,0);const p=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let g=0,v=u.length;g<v;g+=2){const b=tt.transform(f,[i,n,a,o,u[g],u[g+1]]);d.drawImage(p.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+p.canvas.width,b[5],b[5]+p.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,n=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Ri.transformAndFill);for(const o of e){const{data:u,width:d,height:f,transform:p}=o,g=this.cachedCanvases.getCanvas("maskCanvas",d,f),v=g.context;v.save();const b=this.getObject(t,u,o);Mb(v,b),v.globalCompositeOperation="source-in",v.fillStyle=a?n.getPattern(v,this,Gi(i),Me.FILL,t):n,v.fillRect(0,0,d,f),v.restore(),i.save(),i.transform(...p),i.scale(1,-1),Oc(i,g.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,d,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){St("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,n,a){if(!this.contentVisible)return;const o=this.getObject(t,e);if(!o){St("Dependent image isn't ready yet");return}const u=o.width,d=o.height,f=[];for(let p=0,g=a.length;p<g;p+=2)f.push({transform:[i,0,0,n,a[p],a[p+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,o,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:n}=t,a=this.cachedCanvases.getCanvas("inlineImage",i,n),o=a.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,n=e.height,a=this.ctx;this.save(t);const{filter:o}=a;o!=="none"&&o!==""&&(a.filter="none"),a.scale(1/i,-1/n);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,n).context;Ob(p,e),u=this.applyTransferMapsToCanvas(p)}const d=this._scaleImage(u,Gi(a));a.imageSmoothingEnabled=kb(ee(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,i,-n,0).recordDependencies(t,Ri.imageXObject).recordOperation(t),Oc(a,d.img,0,0,d.paintWidth,d.paintHeight,0,-n,i,n),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const n=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const o=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",o,u).context;Ob(f,e),a=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const o of i)n.save(),n.transform(...o.transform),n.scale(1,-1),Oc(n,a,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,1,-1,0),n.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Ri.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const a=this.ctx;this.pendingClip?(n||(this.pendingClip===Db?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ee(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:a}=this.ctx.getTransform();let o,u;if(i===0&&n===0){const d=Math.abs(e),f=Math.abs(a);if(d===f)if(t===0)o=u=1/d;else{const p=d*t;o=u=p<1?1/p:1}else if(t===0)o=1/d,u=1/f;else{const p=d*t,g=f*t;o=p<1?1/p:1,u=g<1?1/g:1}}else{const d=Math.abs(e*a-i*n),f=Math.hypot(e,i),p=Math.hypot(n,a);if(t===0)o=p/d,u=f/d;else{const g=t*d;o=p>g?p/g:1,u=f>g?f/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:n}}=this,[a,o]=this.getScaleForStroking();if(a===o){i.lineWidth=(n||1)*a,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(a,o),af.a=1/a,af.d=1/o;const d=new Path2D;if(d.addPath(t,af),u.length>0){const f=Math.max(a,o);i.setLineDash(u.map(p=>p/f)),i.lineDashOffset/=f}i.lineWidth=n||1,i.stroke(d),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const l in oa)Zr.prototype[l]!==void 0&&(Zr.prototype[oa[l]]=Zr.prototype[l]);class ta{#t;#e;#s;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let n=0;for(const f of ta.strings){const p=e.encode(t[f]);i[f]=p,n+=4+p.length}const a=new ArrayBuffer(n),o=new Uint8Array(a),u=new DataView(a);let d=0;for(const f of ta.strings){const p=i[f],g=p.length;u.setUint32(d,g),o.set(p,d+4),d+=4+g}return Lt(d===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}#i(t){Lt(t<ta.strings.length,"Invalid string index");let e=0;for(let n=0;n<t;n++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#s.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ea{#t;#e;#s;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let n=0;for(const v of ea.strings){const b=e.encode(t[v]);i[v]=b,n+=4+b.length}n+=4;let a,o,u=1+n;t.style&&(a=e.encode(t.style.style),o=e.encode(t.style.weight),u+=4+a.length+4+o.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let g=0;p.setUint8(g++,t.guessFallback?1:0),p.setUint32(g,0),g+=4,n=0;for(const v of ea.strings){const b=i[v],w=b.length;n+=4+w,p.setUint32(g,w),f.set(b,g+4),g+=4+w}return p.setUint32(g-n-4,n),t.style&&(p.setUint32(g,a.length),f.set(a,g+4),g+=4+a.length,p.setUint32(g,o.length),f.set(o,g+4),g+=4+o.length),Lt(g<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(g)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Lt(t<ea.strings.length,"Invalid string index");let e=5;for(let n=0;n<t;n++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#s.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#s.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const n=this.#e.getUint32(t),a=this.#s.decode(new Uint8Array(this.#t,t+4,n));return{style:i,weight:a}}}class Vt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#s=this.#e+1+8;static#i=this.#s+1+48;static#a=this.#i+1+6;#n;#r;#o;constructor({data:t,extra:e}){this.#n=t,this.#r=new TextDecoder,this.#o=new DataView(this.#n),e&&Object.assign(this,e)}#c(t){Lt(t<Vt.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,n=this.#o.getUint8(e)>>i&3;return n===0?void 0:n===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Lt(t<Vt.numbers.length,"Invalid number index"),this.#o.getFloat64(Vt.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Vt.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<4;n++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Vt.#s;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<6;n++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Vt.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<3;n++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Lt(t<Vt.strings.length,"Invalid string index");let e=Vt.#a+4;for(let a=0;a<t;a++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),n=new Uint8Array(i);return n.set(new Uint8Array(this.#n,e+4,i)),this.#r.decode(n)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Vt.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);t+=4+n;const a=this.#o.getUint32(t);if(a!==0)return new Uint8Array(this.#n,t+4,a)}clearData(){let t=Vt.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);t+=4+n;const a=this.#o.getUint32(t);new Uint8Array(this.#n,t+4,a).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Vt.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);if(n===0)return null;const a=new Uint8Array(n);return a.set(new Uint8Array(this.#n,t+4,n)),new ta(a.buffer)}get systemFontInfo(){let t=Vt.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const n=new Uint8Array(i);return n.set(new Uint8Array(this.#n,t+4,i)),new ea(n.buffer)}static write(t){const e=t.systemFontInfo?ea.write(t.systemFontInfo):null,i=t.cssFontInfo?ta.write(t.cssFontInfo):null,n=new TextEncoder,a={};let o=0;for(const _ of Vt.strings)a[_]=n.encode(t[_]),o+=4+a[_].length;const u=Vt.#a+4+o+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let g=0;const v=Vt.bools.length;let b=0,w=0;for(let _=0;_<v;_++){const A=t[Vt.bools[_]];b|=(A===void 0?0:A?2:1)<<w,w+=2,(w===8||_===v-1)&&(p.setUint8(g++,b),b=0,w=0)}Lt(g===Vt.#t,"FontInfo.write: Boolean properties offset mismatch");for(const _ of Vt.numbers)p.setFloat64(g,t[_]),g+=8;if(Lt(g===Vt.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(g++,4);for(const _ of t.bbox)p.setInt16(g,_,!0),g+=2}else p.setUint8(g++,0),g+=8;if(Lt(g===Vt.#s,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(g++,6);for(const _ of t.fontMatrix)p.setFloat64(g,_,!0),g+=8}else p.setUint8(g++,0),g+=48;if(Lt(g===Vt.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(g++,1);for(const _ of t.defaultVMetrics)p.setInt16(g,_,!0),g+=2}else p.setUint8(g++,0),g+=6;Lt(g===Vt.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Vt.#a,0),g+=4;for(const _ of Vt.strings){const A=a[_],E=A.length;p.setUint32(g,E),f.set(A,g+4),g+=4+E}if(p.setUint32(Vt.#a,g-Vt.#a-4),!e)p.setUint32(g,0),g+=4;else{const _=e.byteLength;p.setUint32(g,_),Lt(g+4+_<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),g+4),g+=4+_}if(!i)p.setUint32(g,0),g+=4;else{const _=i.byteLength;p.setUint32(g,_),Lt(g+4+_<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),g+4),g+=4+_}return t.data===void 0?(p.setUint32(g,0),g+=4):(p.setUint32(g,t.data.length),f.set(t.data,g+4),g+=4+t.data.length),Lt(g<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(g)}}class qn{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class O1{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Gr=Symbol("INTERNAL");class M1{#t=!1;#e=!1;#s=!1;#i=!0;constructor(t,{name:e,intent:i,usage:n,rbGroups:a}){this.#t=!!(t&li.DISPLAY),this.#e=!!(t&li.PRINT),this.name=e,this.intent=i,this.usage=n,this.rbGroups=a}get visible(){if(this.#s)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Gr&&Yt("Internal method `_setVisible` called."),this.#s=i,this.#i=e}}class k1{#t=null;#e=new Map;#s=null;#i=null;constructor(t,e=li.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const i of t.groups)this.#e.set(i.id,new M1(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Gr,!1);for(const i of t.on)this.#e.get(i)._setVisible(Gr,!0);for(const i of t.off)this.#e.get(i)._setVisible(Gr,!1);this.#s=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const a=t[n];let o;if(Array.isArray(a))o=this.#a(a);else if(this.#e.has(a))o=this.#e.get(a).visible;else return St(`Optional content group not found: ${a}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return gu("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(St(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return St(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return St(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return St(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return St(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return St(`Unknown optional content policy ${t.policy}.`),!0}return St(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const n=this.#e.get(t);if(!n){St(`Optional content group not found: ${t}`);return}if(i&&e&&n.rbGroups.length)for(const a of n.rbGroups)for(const o of a)o!==t&&this.#e.get(o)?._setVisible(Gr,!1,!0);n._setVisible(Gr,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const a=this.#e.get(n);if(a)switch(i){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new X0;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class D1{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Lt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:a,progressiveDone:o,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=u,a?.length>0){const d=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((d,f)=>{this._onReceiveData({begin:d,chunk:f})}),t.addProgressListener((d,f)=>{this._onProgress({loaded:d,total:f})}),t.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const n=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(i),!0)});Lt(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Lt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new L1(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new P1(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class L1{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=yu(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class P1{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function N1(l){let t=!0,e=i("filename\\*","i").exec(l);if(e){e=e[1];let p=u(e);return p=unescape(p),p=d(p),p=f(p),a(p)}if(e=o(l),e){const p=f(e);return a(p)}if(e=i("filename","i").exec(l),e){e=e[1];let p=u(e);return p=f(p),a(p)}function i(p,g){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function n(p,g){if(p){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const v=new TextDecoder(p,{fatal:!0}),b=Vo(g);g=v.decode(b),t=!1}catch{}}return g}function a(p){return t&&/[\x80-\xff]/.test(p)&&(p=n("utf-8",p),t&&(p=n("iso-8859-1",p))),p}function o(p){const g=[];let v;const b=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=b.exec(p))!==null;){let[,_,A,E]=v;if(_=parseInt(_,10),_ in g){if(_===0)break;continue}g[_]=[A,E]}const w=[];for(let _=0;_<g.length&&_ in g;++_){let[A,E]=g[_];E=u(E),A&&(E=unescape(E),_===0&&(E=d(E))),w.push(E)}return w.join("")}function u(p){if(p.startsWith('"')){const g=p.slice(1).split('\\"');for(let v=0;v<g.length;++v){const b=g[v].indexOf('"');b!==-1&&(g[v]=g[v].slice(0,b),g.length=v+1),g[v]=g[v].replaceAll(/\\(.)/g,"$1")}p=g.join('"')}return p}function d(p){const g=p.indexOf("'");if(g===-1)return p;const v=p.slice(0,g),w=p.slice(g+1).replace(/^[^']*'/,"");return n(v,w)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,v,b,w){if(b==="q"||b==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,A){return String.fromCharCode(parseInt(A,16))}),n(v,w);try{w=atob(w)}catch{}return n(v,w)})}return""}function i_(l,t){const e=new Headers;if(!l||!t||typeof t!="object")return e;for(const i in t){const n=t[i];n!==void 0&&e.append(i,n)}return e}function vu(l){return URL.parse(l)?.origin??null}function s_({responseHeaders:l,isHttp:t,rangeChunkSize:e,disableRange:i}){const n={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(l.get("Content-Length"),10);return!Number.isInteger(a)||(n.suggestedLength=a,a<=2*e)||i||!t||l.get("Accept-Ranges")!=="bytes"||(l.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function n_(l){const t=l.get("Content-Disposition");if(t){let e=N1(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(yu(e))return e}return null}function Wo(l,t){return new Io(`Unexpected server response (${l}) while retrieving PDF "${t}".`,l,l===404||l===0&&t.startsWith("file:"))}function r_(l){return l===200||l===206}function a_(l,t,e){return{method:"GET",headers:l,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function o_(l){return l instanceof Uint8Array?l.buffer:l instanceof ArrayBuffer?l:(St(`getArrayBuffer - unexpected data format: ${l}`),new Uint8Array(l).buffer)}class B1{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=i_(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Lt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new I1(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new j1(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class I1{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),n=e.url;fetch(n,a_(i,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=vu(a.url),!r_(a.status))throw Wo(a.status,n);this._reader=a.body.getReader(),this._headersCapability.resolve();const o=a.headers,{allowRangeRequests:u,suggestedLength:d}=s_({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=d||this._contentLength,this._filename=n_(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Es("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:o_(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class j1{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${i-1}`);const o=n.url;fetch(o,a_(a,this._withCredentials,this._abortController)).then(u=>{const d=vu(u.url);if(d!==t._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${t._responseOrigin}".`);if(!r_(u.status))throw Wo(u.status,o);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:o_(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const of=200,lf=206;function U1(l){const t=l.response;return typeof t!="string"?t:Vo(t).buffer}class F1{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=i_(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,o]of this.headers)e.setRequestHeader(a,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=lf):n.expectedStatus=of,e.responseType="arraybuffer",Lt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){i.onError(n.status);return}const a=n.status||of;if(!(a===of&&i.expectedStatus===lf)&&a!==i.expectedStatus){i.onError(n.status);return}const u=U1(n);if(a===lf){const d=n.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);f?i.onDone({begin:parseInt(f[1],10),chunk:u}):(St('Missing or invalid "Content-Range" header.'),i.onError(0))}else u?i.onDone({begin:0,chunk:u}):i.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class z1{constructor(t){this._source=t,this._manager=new F1(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Lt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new H1(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new $1(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class H1{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=vu(e.responseURL);const i=e.getAllResponseHeaders(),n=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[d,...f]=u.split(": ");return[d,f.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:o}=s_({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=n_(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Wo(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class $1{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=vu(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Wo(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const q1=/^[a-z][a-z0-9\-+.]+:/i;function V1(l){if(q1.test(l))return new URL(l);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(l))}class G1{constructor(t){this.source=t,this.url=V1(t.url),Lt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Lt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Y1(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new X1(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Y1{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=Wo(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Es("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class X1{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const yo=Symbol("INITIAL_DATA");class l_{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:yo}}get(t,e=null){if(e){const n=this.#e(t);return n.promise.then(()=>e(n.data)),null}const i=this.#t[t];if(!i||i.data===yo)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==yo}delete(t){const e=this.#t[t];return!e||e.data===yo?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==yo&&(yield[t,e])}}}const K1=1e5,Lb=30;class Le{#t=Promise.withResolvers();#e=null;#s=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#n=null;#r=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#p=null;#u=[];#g=new WeakMap;#y=null;static#b=new Map;static#v=new Map;static#T=new WeakMap;static#A=null;static#_=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=i.scale*Ui.pixelRatio,this.#d=i.rotation,this.#n={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:a,pageX:o,pageY:u}=i.rawDims;this.#y=[1,0,0,-1,-o,u+a],this.#o=n,this.#r=a,Le.#O(),cn(e,i),this.#t.promise.finally(()=>{Le.#_.delete(this),this.#n=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Ae.platform;return Tt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#R(e.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),Le.#_.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Ui.pixelRatio,n=t.rotation;if(n!==this.#d&&(e?.(),this.#d=n,cn(this.#l,{rotation:n})),i!==this.#h){e?.(),this.#h=i;const a={div:null,properties:null,ctx:Le.#M(this.#a)};for(const o of this.#u)a.properties=this.#g.get(o),a.div=o,this.#E(a)}}cancel(){const t=new Es("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#R(t){if(this.#s)return;this.#n.ctx??=Le.#M(this.#a);const e=this.#u,i=this.#m;for(const n of t){if(e.length>K1){St("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),n.id&&this.#e.setAttribute("id",`${n.id}`),a.append(this.#e)}else n.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(n.str),this.#S(n)}}#S(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const n=tt.transform(this.#y,t.transform);let a=Math.atan2(n[1],n[0]);const o=this.#f[t.fontName];o.vertical&&(a+=Math.PI/2);let u=this.#i&&o.fontSubstitution||o.fontFamily;u=Le.fontFamilyMap.get(u)||u;const d=Math.hypot(n[2],n[3]),f=d*Le.#I(u,o,this.#a);let p,g;a===0?(p=n[4],g=n[5]-f):(p=n[4]+f*Math.sin(a),g=n[5]-f*Math.cos(a));const v="calc(var(--total-scale-factor) *",b=e.style;this.#e===this.#l?(b.left=`${(100*p/this.#o).toFixed(2)}%`,b.top=`${(100*g/this.#r).toFixed(2)}%`):(b.left=`${v}${p.toFixed(2)}px)`,b.top=`${v}${g.toFixed(2)}px)`),b.fontSize=`${v}${(Le.#A*d).toFixed(2)}px)`,b.fontFamily=u,i.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),a!==0&&(i.angle=a*(180/Math.PI));let w=!1;if(t.str.length>1)w=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),A=Math.abs(t.transform[3]);_!==A&&Math.max(_,A)/Math.min(_,A)>1.5&&(w=!0)}if(w&&(i.canvasWidth=o.vertical?t.height:t.width),this.#g.set(e,i),this.#n.div=e,this.#n.properties=i,this.#E(this.#n),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#E(t){const{div:e,properties:i,ctx:n}=t,{style:a}=e;let o="";if(Le.#A>1&&(o=`scale(${1/Le.#A})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:u}=a,{canvasWidth:d,fontSize:f}=i;Le.#x(n,f*this.#h,u);const{width:p}=n.measureText(e.textContent);p>0&&(o=`scaleX(${d*this.#h/p}) ${o}`)}i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(a.transform=o)}static cleanup(){if(!(this.#_.size>0)){this.#b.clear();for(const{canvas:t}of this.#v.values())t.remove();this.#v.clear()}}static#M(t=null){let e=this.#v.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(t,e),this.#T.set(e,{size:0,family:""})}return e}static#x(t,e,i){const n=this.#T.get(t);e===n.size&&i===n.family||(t.font=`${e}px ${i}`,n.size=e,n.family=i)}static#O(){if(this.#A!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#A=t.getBoundingClientRect().height,t.remove()}static#I(t,e,i){const n=this.#b.get(t);if(n)return n;const a=this.#M(i);a.canvas.width=a.canvas.height=Lb,this.#x(a,Lb,t);const o=a.measureText(""),u=o.fontBoundingBoxAscent,d=Math.abs(o.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let f=.8;return u?f=u/(u+d):(Ae.platform.isFirefox&&St("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#b.set(t,f),f}}const W1=100;function c_(l={}){typeof l=="string"||l instanceof URL?l={url:l}:(l instanceof ArrayBuffer||ArrayBuffer.isView(l))&&(l={data:l});const t=new gp,{docId:e}=t,i=l.url?n1(l.url):null,n=l.data?r1(l.data):null,a=l.httpHeaders||null,o=l.withCredentials===!0,u=l.password??null,d=l.range instanceof mp?l.range:null,f=Number.isInteger(l.rangeChunkSize)&&l.rangeChunkSize>0?l.rangeChunkSize:2**16;let p=l.worker instanceof la?l.worker:null;const g=l.verbosity,v=typeof l.docBaseUrl=="string"&&!Yo(l.docBaseUrl)?l.docBaseUrl:null,b=Tc(l.cMapUrl),w=l.cMapPacked!==!1,_=l.CMapReaderFactory||(Ie?d1:bb),A=Tc(l.iccUrl),E=Tc(l.standardFontDataUrl),R=l.StandardFontDataFactory||(Ie?f1:_b),C=Tc(l.wasmUrl),x=l.WasmFactory||(Ie?p1:wb),D=l.stopAtErrors!==!0,M=Number.isInteger(l.maxImageSize)&&l.maxImageSize>-1?l.maxImageSize:-1,k=l.isEvalSupported!==!1,I=typeof l.isOffscreenCanvasSupported=="boolean"?l.isOffscreenCanvasSupported:!Ie,H=typeof l.isImageDecoderSupported=="boolean"?l.isImageDecoderSupported:!Ie&&(Ae.platform.isFirefox||!globalThis.chrome),X=Number.isInteger(l.canvasMaxAreaInBytes)?l.canvasMaxAreaInBytes:-1,W=typeof l.disableFontFace=="boolean"?l.disableFontFace:Ie,et=l.fontExtraProperties===!0,mt=l.enableXfa===!0,ft=l.ownerDocument||globalThis.document,yt=l.disableRange===!0,N=l.disableStream===!0,q=l.disableAutoFetch===!0,Q=l.pdfBug===!0,vt=l.CanvasFactory||(Ie?h1:l1),Ct=l.FilterFactory||(Ie?u1:c1),L=l.enableHWA===!0,$=l.useWasm!==!1,K=d?d.length:l.length??NaN,J=typeof l.useSystemFonts=="boolean"?l.useSystemFonts:!Ie&&!W,at=typeof l.useWorkerFetch=="boolean"?l.useWorkerFetch:!!(_===bb&&R===_b&&x===wb&&b&&E&&C&&wo(b,document.baseURI)&&wo(E,document.baseURI)&&wo(C,document.baseURI)),ot=null;UT(g);const lt={canvasFactory:new vt({ownerDocument:ft,enableHWA:L}),filterFactory:new Ct({docId:e,ownerDocument:ft}),cMapReaderFactory:at?null:new _({baseUrl:b,isCompressed:w}),standardFontDataFactory:at?null:new R({baseUrl:E}),wasmFactory:at?null:new x({baseUrl:C})};p||(p=la.create({verbosity:g,port:qn.workerPort}),t._worker=p);const Xt={docId:e,apiVersion:"5.4.296",data:n,password:u,disableAutoFetch:q,rangeChunkSize:f,length:K,docBaseUrl:v,enableXfa:mt,evaluatorOptions:{maxImageSize:M,disableFontFace:W,ignoreErrors:D,isEvalSupported:k,isOffscreenCanvasSupported:I,isImageDecoderSupported:H,canvasMaxAreaInBytes:X,fontExtraProperties:et,useSystemFonts:J,useWasm:$,useWorkerFetch:at,cMapUrl:b,iccUrl:A,standardFontDataUrl:E,wasmUrl:C}},Pt={ownerDocument:ft,pdfBug:Q,styleElement:ot,loadingParams:{disableAutoFetch:q,enableXfa:mt}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Oi=p.messageHandler.sendWithPromise("GetDocRequest",Xt,n?[n.buffer]:null);let gi;if(d)gi=new D1(d,{disableRange:yt,disableStream:N});else if(!n){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Ne=wo(i)?B1:Ie?G1:z1;gi=new Ne({url:i,length:K,httpHeaders:a,withCredentials:o,rangeChunkSize:f,disableRange:yt,disableStream:N})}return Oi.then(Ne=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const hn=new So(e,Ne,p.port),Mi=new Z1(hn,t,gi,Pt,lt,L);t._transport=Mi,hn.send("Ready",null)})}).catch(t._capability.reject),t}class gp{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${gp.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class mp{#t=Promise.withResolvers();#e=[];#s=[];#i=[];#a=[];constructor(t,e,i=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#s.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#a)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#i)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#s)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Yt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Q1{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Tt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class J1{#t=!1;constructor(t,e,i,n=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new db:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new l_,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:a=!1}={}){return new Go({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Tt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:n="display",annotationMode:a=ws.ENABLE,transform:o=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:g=null,isEditing:v=!1,recordOperations:b=!1,operationsFilter:w=null}){this._stats?.time("Overall");const _=this._transport.getRenderingIntent(n,a,g,v),{renderingIntent:A,cacheKey:E}=_;this.#t=!1,d||=this._transport.getOptionalContentConfig(A);let R=this._intentStates.get(E);R||(R=Object.create(null),this._intentStates.set(E,R)),R.streamReaderCancelTimeout&&(clearTimeout(R.streamReaderCancelTimeout),R.streamReaderCancelTimeout=null);const C=!!(A&li.PRINT);R.displayReadyCapability||(R.displayReadyCapability=Promise.withResolvers(),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const x=!!(this._pdfBug&&globalThis.StepperManager?.enabled),D=!this.recordedBBoxes&&(b||x),M=H=>{if(R.renderTasks.delete(k),D){const X=k.gfx?.dependencyTracker.take();X&&(k.stepper&&k.stepper.setOperatorBBoxes(X,k.gfx.dependencyTracker.takeDebugMetadata()),b&&(this.recordedBBoxes=X))}C&&(this.#t=!0),this.#e(),H?(k.capability.reject(H),this._abortOperatorList({intentState:R,reason:H instanceof Error?H:new Error(H)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new Wr({callback:M,params:{canvas:e,canvasContext:t,dependencyTracker:D?new m1(e,R.operatorList.length,x):null,viewport:i,transform:o,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:R.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:w});(R.renderTasks||=new Set).add(k);const I=k.task;return Promise.all([R.displayReadyCapability.promise,d]).then(([H,X])=>{if(this.destroyed){M();return}if(this._stats?.time("Rendering"),!(X.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:H,optionalContentConfig:X}),k.operatorListChanged()}).catch(M),I}getOperatorList({intent:t="display",annotationMode:e=ws.ENABLE,printAnnotationStorage:i=null,isEditing:n=!1}={}){function a(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const o=this._transport.getRenderingIntent(t,e,i,n,!0);let u=this._intentStates.get(o.cacheKey);u||(u=Object.create(null),this._intentStates.set(o.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=a,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>jo.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,n){function a(){o.read().then(function({value:d,done:f}){if(f){i(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),a()},n)}const o=e.getReader(),u={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new db),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:n}){const{map:a,transfer:o}=i,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:n},o).getReader(),f=this._intentStates.get(e);f.streamReader=d;const p=()=>{d.read().then(({value:g,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,f),p())},g=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(g);else if(f.opListReadCapability)f.opListReadCapability.reject(g);else throw g}})};p()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof mu){let n=W1;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new Es(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,a]of this._intentStates)if(a===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}var nn,Bi,_s,jn,lu,Un,Fn,je,Vc,u_,h_,Ao,sa,Gc;const te=class te{constructor({name:t=null,port:e=null,verbosity:i=FT()}={}){qi(this,je);qi(this,nn,Promise.withResolvers());qi(this,Bi,null);qi(this,_s,null);qi(this,jn,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Zt(te,Fn).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Zt(te,Fn).set(e,this),Vi(this,je,u_).call(this,e)}else Vi(this,je,h_).call(this)}get promise(){return Zt(this,nn).promise}get port(){return Zt(this,_s)}get messageHandler(){return Zt(this,Bi)}destroy(){this.destroyed=!0,Zt(this,jn)?.terminate(),Ge(this,jn,null),Zt(te,Fn).delete(Zt(this,_s)),Ge(this,_s,null),Zt(this,Bi)?.destroy(),Ge(this,Bi,null)}static create(t){const e=Zt(this,Fn).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new te(t)}static get workerSrc(){if(qn.workerSrc)return qn.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Tt(this,"_setupFakeWorkerGlobal",(async()=>Zt(this,sa,Gc)?Zt(this,sa,Gc):(await import(this.workerSrc)).WorkerMessageHandler)())}};nn=new WeakMap,Bi=new WeakMap,_s=new WeakMap,jn=new WeakMap,lu=new WeakMap,Un=new WeakMap,Fn=new WeakMap,je=new WeakSet,Vc=function(){Zt(this,nn).resolve(),Zt(this,Bi).send("configure",{verbosity:this.verbosity})},u_=function(t){Ge(this,_s,t),Ge(this,Bi,new So("main","worker",t)),Zt(this,Bi).on("ready",()=>{}),Vi(this,je,Vc).call(this)},h_=function(){if(Zt(te,Un)||Zt(te,sa,Gc)){Vi(this,je,Ao).call(this);return}let{workerSrc:t}=te;try{te._isSameOrigin(window.location,t)||(t=te._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new So("main","worker",e),n=()=>{a.abort(),i.destroy(),e.terminate(),this.destroyed?Zt(this,nn).reject(new Error("Worker was destroyed")):Vi(this,je,Ao).call(this)},a=new AbortController;e.addEventListener("error",()=>{Zt(this,jn)||n()},{signal:a.signal}),i.on("test",u=>{if(a.abort(),this.destroyed||!u){n();return}Ge(this,Bi,i),Ge(this,_s,e),Ge(this,jn,e),Vi(this,je,Vc).call(this)}),i.on("ready",u=>{if(a.abort(),this.destroyed){n();return}try{o()}catch{Vi(this,je,Ao).call(this)}});const o=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};o();return}catch{gu("The worker has been disabled.")}Vi(this,je,Ao).call(this)},Ao=function(){Zt(te,Un)||(St("Setting up fake worker."),Ge(te,Un,!0)),te._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Zt(this,nn).reject(new Error("Worker was destroyed"));return}const e=new o1;Ge(this,_s,e);const i=`fake${Mv(te,lu)._++}`,n=new So(i+"_worker",i,e);t.setup(n,e),Ge(this,Bi,new So(i,i+"_worker",e)),Vi(this,je,Vc).call(this)}).catch(t=>{Zt(this,nn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},sa=new WeakSet,Gc=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},qi(te,sa),qi(te,lu,0),qi(te,Un,!1),qi(te,Fn,new WeakMap),Ie&&(Ge(te,Un,!0),qn.workerSrc||="./pdf.worker.mjs"),te._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const n=new URL(e,i);return i.origin===n.origin},te._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},te.fromPort=t=>{if(KT("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return te.create(t)};let la=te;class Z1{#t=new Map;#e=new Map;#s=new Map;#i=new Map;#a=null;constructor(t,e,i,n,a,o){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new l_,this.fontLoader=new i1({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#n(t,e=null){const i=this.#t.get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,n),n}get annotationStorage(){return Tt(this,"annotationStorage",new hp)}getRenderingIntent(t,e=ws.ENABLE,i=null,n=!1,a=!1){let o=li.DISPLAY,u=Tf;switch(t){case"any":o=li.ANY;break;case"display":break;case"print":o=li.PRINT;break;default:St(`getRenderingIntent - invalid intent: ${t}`)}const d=o&li.PRINT&&i instanceof K0?i:this.annotationStorage;switch(e){case ws.DISABLE:o+=li.ANNOTATIONS_DISABLE;break;case ws.ENABLE:break;case ws.ENABLE_FORMS:o+=li.ANNOTATIONS_FORMS;break;case ws.ENABLE_STORAGE:o+=li.ANNOTATIONS_STORAGE,u=d.serializable;break;default:St(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(o+=li.IS_EDITING),a&&(o+=li.OPLIST);const{ids:f,hash:p}=d.modifiedIds,g=[o,u.hash,p];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#s.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Le.cleanup(),this._networkStream?.cancelAllRequests(new Es("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,n)=>{Lt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},n.onPull=()=>{this._fullReader.read().then(function({value:a,done:o}){if(o){n.close();return}Lt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{this._fullReader.cancel(a),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:a,contentLength:o}=this._fullReader;return(!n||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:n,isRangeSupported:a,contentLength:o}}),t.on("GetRangeReader",(i,n)=>{Lt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(i.begin,i.end);if(!a){n.close();return}n.onPull=()=>{a.read().then(function({value:o,done:u}){if(u){n.close();return}Lt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{n.error(o)})},n.onCancel=o=>{a.cancel(o),n.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new Q1(i,this))}),t.on("DocException",i=>{e._capability.reject(Ye(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw Ye(i);const n=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};e.onPassword(n,i.code)}catch(n){this.#a.reject(n)}return this.#a.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,n,a])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(n){case"Font":if("error"in a){const p=a.error;St(`Error during font loading: ${p}`),this.commonObjs.resolve(i,p);break}const o=new Vt(a),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,d=new s1(o,u,a.extra,a.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:f}=a;Lt(f,"The imageRef must be defined.");for(const p of this.#e.values())for(const[,g]of p.objs)if(g?.ref===f)return g.dataLen?(this.commonObjs.resolve(i,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,a);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([i,n,a,o])=>{if(this.destroyed)return;const u=this.#e.get(n);if(!u.objs.has(i)){if(u._intentStates.size===0){o?.bitmap?.close();return}switch(a){case"Image":case"Pattern":u.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[i.type];if(!n)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&St("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#s.get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#i.set(a.refStr,t);const o=new J1(e,a,this,this._params.pdfBug);return this.#e.set(e,o),o});return this.#s.set(e,n),n}getPageIndex(t){return Cf(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#n("GetOptionalContentConfig").then(e=>new k1(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(n=>({info:n[0],metadata:n[1]?new O1(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Le.cleanup()}}cachedPageNumber(t){if(!Cf(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class tC{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Wr{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:a,operatorList:o,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:g=!1,pageColors:v=null,enableHWA:b=!1,operationsFilter:w=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=g,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new tC(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=b,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Wr.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Wr.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:n,background:a,dependencyTracker:o}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Zr(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:n,viewport:i,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Wr.#e.delete(this._canvas),t||=new mu(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Wr.#e.delete(this._canvas),this.callback())))}}const d_="5.4.296",f_="f56dc8601";class ci{#t=null;#e=null;#s;#i=null;#a=!1;#n=!1;#r=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Tt(this,"_keyboardManager",new Xo([[["Escape","mac+Escape"],ci.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ci.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ci.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ci.prototype._moveToPrevious],[["Home","mac+Home"],ci.prototype._moveToBeginning],[["End","mac+End"],ci.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#n=!1,this.#r=t):this.#n=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#s=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",ci.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#s,t.append(i),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",fi,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[i,n]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",n),a.title=i,a.setAttribute("data-l10n-id",ci.#d[i]);const o=document.createElement("span");a.append(o),o.className="swatch",o.style.backgroundColor=n,a.ariaSelected=n===this.#s,a.addEventListener("click",this.#f.bind(this,n),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:kt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#i.lastChild?.focus()}#m(t){ci._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#h();this.#t.append(e)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#n){if(!this.#g){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#l.highlightColors.values();for(const i of this.#i.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Uo{#t=null;#e=null;#s=null;static#i=null;constructor(t){this.#e=t,this.#s=t._uiManager,Uo.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:i}=this.#e,n=this.#t=document.createElement("input");return n.type="color",n.value=i||"#000000",n.className="basicColorPicker",n.tabIndex=0,n.setAttribute("data-l10n-id",Uo.#i[t]),n.addEventListener("input",()=>{this.#s.updateParams(e,n.value)},{signal:this.#s._signal}),n}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Pb(l){return Math.floor(Math.max(0,Math.min(1,l))*255).toString(16).padStart(2,"0")}function vo(l){return Math.max(0,Math.min(255,255*l))}class Nb{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=vo(t),[t,t,t]}static G_HTML([t]){const e=Pb(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(vo)}static RGB_HTML(t){return`#${t.map(Pb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[vo(1-Math.min(1,t+n)),vo(1-Math.min(1,i+n)),vo(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,a=1-e,o=1-i,u=Math.min(n,a,o);return["CMYK",n,a,o,u]}}class eC{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Yt("Abstract method `_createSVG` called.")}}class Fo extends eC{_createSVG(t){return document.createElementNS(vs,t)}}const iC=9,Yn=new WeakSet,sC=new Date().getTimezoneOffset()*60*1e3;class Bb{static create(t){switch(t.data.annotationType){case ce.LINK:return new yp(t);case ce.TEXT:return new rC(t);case ce.WIDGET:switch(t.data.fieldType){case"Tx":return new aC(t);case"Btn":return t.data.radioButton?new p_(t):t.data.checkBox?new lC(t):new cC(t);case"Ch":return new uC(t);case"Sig":return new oC(t)}return new Kn(t);case ce.POPUP:return new Of(t);case ce.FREETEXT:return new g_(t);case ce.LINE:return new dC(t);case ce.SQUARE:return new fC(t);case ce.CIRCLE:return new pC(t);case ce.POLYLINE:return new m_(t);case ce.CARET:return new mC(t);case ce.INK:return new vp(t);case ce.POLYGON:return new gC(t);case ce.HIGHLIGHT:return new y_(t);case ce.UNDERLINE:return new yC(t);case ce.SQUIGGLY:return new vC(t);case ce.STRIKEOUT:return new bC(t);case ce.STAMP:return new v_(t);case ce.FILEATTACHMENT:return new _C(t);default:return new ne(t)}}}class ne{#t=null;#e=!1;#s=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ne._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:n}=this.data;let a=-1/0,o=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>o?(o=e[u+1],a=e[u+2]):e[u+1]===o&&(a=Math.max(a,e[u+2]));return[a,o]}if(i?.length>=1){for(const u of i)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>o?(o=u[d+1],a=u[d]):u[d+1]===o&&(a=Math.max(a,u[d]));if(a!==1/0)return[a,o]}return n?[n[2],n[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:a,pageY:o}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/i,t[1]=100*(t[1]-o)/n,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Bo}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Bo}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#s?.popup||this.popup)?.remove(),this.#s=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#i(e);let n=this.#s?.popup||this.popup;!n&&i?.text&&(this._createPopup(i),n=this.#s.popup),n&&(n.updateEdited(t),i?.deleted&&(n.remove(),this.#s=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#s?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:o,pageX:u,pageY:d}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/a}%`,e.top=`${100*(o-t[3]+d)/o}%`,n===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(n)}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof Kn)&&!(this instanceof yp)&&(a.tabIndex=0);const{style:o}=a;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof Of){const{rotation:_}=e;return!e.hasOwnCanvas&&_!==0&&this.setRotation(_,a),a}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const _=e.borderStyle.horizontalCornerRadius,A=e.borderStyle.verticalCornerRadius;if(_>0||A>0){const R=`calc(${_}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;o.borderRadius=R}else if(this instanceof p_){const R=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;o.borderRadius=R}switch(e.borderStyle.style){case Vr.SOLID:o.borderStyle="solid";break;case Vr.DASHED:o.borderStyle="dashed";break;case Vr.BEVELED:St("Unimplemented border style: beveled");break;case Vr.INSET:St("Unimplemented border style: inset");break;case Vr.UNDERLINE:o.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,o.borderColor=tt.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):o.borderWidth=0}const f=tt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:g,pageX:v,pageY:b}=n.rawDims;o.left=`${100*(f[0]-v)/p}%`,o.top=`${100*(f[1]-b)/g}%`;const{rotation:w}=e;return e.hasOwnCanvas||w===0?(o.width=`${100*u/p}%`,o.height=`${100*d/g}%`):this.setRotation(w,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims;let{width:a,height:o}=this;t%180!==0&&([a,o]=[o,a]),e.style.width=`${100*a/i}%`,e.style.height=`${100*o/n}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,n)=>{const a=n.detail[e],o=a[0],u=a.slice(1);n.target.style[i]=Nb[`${o}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:Nb[`${o}_rgb`](u)})};return Tt(this,"_commonActions",{display:e=>{const{display:i}=e.detail,n=i%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail))(t[n]||i[n])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,a]of Object.entries(e)){const o=i[n];if(o){const u={detail:{[n]:a},target:t};o(u),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,a]=this.data.rect.map(_=>Math.fround(_));if(t.length===8){const[_,A,E,R]=t.subarray(2,6);if(n===_&&a===A&&e===E&&i===R)return}const{style:o}=this.container;let u;if(this.#e){const{borderColor:_,borderWidth:A}=o;o.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const d=n-e,f=a-i,{svgFactory:p}=this,g=p.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0),g.role="none";const v=p.createElement("defs");g.append(v);const b=p.createElement("clipPath"),w=`clippath_${this.data.id}`;b.setAttribute("id",w),b.setAttribute("clipPathUnits","objectBoundingBox"),v.append(b);for(let _=2,A=t.length;_<A;_+=8){const E=t[_],R=t[_+1],C=t[_+2],x=t[_+3],D=p.createElement("rect"),M=(C-e)/d,k=(a-R)/f,I=(E-C)/d,H=(R-x)/f;D.setAttribute("x",M),D.setAttribute("y",k),D.setAttribute("width",I),D.setAttribute("height",H),b.append(D),u?.push(`<rect vector-effect="non-scaling-stroke" x="${M}" y="${k}" width="${I}" height="${H}"/>`)}this.#e&&(u.push("</g></svg>')"),o.backgroundImage=u.join("")),this.container.append(g),this.container.style.clipPath=`url(#${w})`}_createPopup(t=null){const{data:e}=this;let i,n;t?(i={str:t.text},n=t.date):(i=e.contentsObj,n=e.modificationDate);const a=this.#s=new Of({data:{color:e.color,titleObj:e.titleObj,modificationDate:n,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(a.render())}get hasPopupElement(){return!!(this.#s||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#s}render(){Yt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:a,id:o,exportValues:u}of n){if(a===-1||o===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${o}"]`);if(f&&!Yn.has(f)){St(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:d,domElement:f})}return i}for(const n of document.getElementsByName(t)){const{exportValue:a}=n,o=n.getAttribute("data-element-id");o!==e&&Yn.has(n)&&i.push({id:o,exportValue:a,domElement:n})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class nC extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class yp extends ne{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),n=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),n=!0):t.setOCGState?(this.#s(i,t.setOCGState,t.overlaidText),n=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",n=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,n),!1),this.#t()}#s(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const a=i.get(n);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){St('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:n,refs:a,include:o}=e,u=[];if(n.length!==0||a.length!==0){const p=new Set(a);for(const g of n){const v=this._fieldObjects[g]||[];for(const{id:b}of v)p.add(b)}for(const g of Object.values(this._fieldObjects))for(const v of g)p.has(v.id)===o&&u.push(v)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,f=[];for(const p of u){const{id:g}=p;switch(f.push(g),p.type){case"text":{const b=p.defaultValue||"";d.setValue(g,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;d.setValue(g,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";d.setValue(g,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${g}"]`);if(v){if(!Yn.has(v)){St(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class rC extends ne{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Kn extends ne{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ae.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,a){i.includes("mouse")?t.addEventListener(i,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:a(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(i,o=>{if(i==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:a(o)}})})}_setEventListeners(t,e,i,n){for(const[a,o]of i)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,o,n),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":tt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||iC,a=t.style;let o;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(tf*n))||1,g=f/p;o=Math.min(n,d(g/tf))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);o=Math.min(n,d(f/tf))}a.fontSize=`calc(${o}px * var(--total-scale-factor))`,a.color=tt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class aC extends Kn{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,n){const a=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=i),a.setValue(o.id,{[n]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let a=n.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let u=n.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Yn.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:g}=this.data,v=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",w=>{t.setValue(e,{value:w.target.value}),this.setPropertyOnSiblings(i,"value",w.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",w=>{const _=this.data.defaultFieldValue??"";i.value=d.userValue=_,d.formattedValue=null});let b=w=>{const{formattedValue:_}=d;_!=null&&(w.target.value=_),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",_=>{if(d.focused)return;const{target:A}=_;if(v&&(A.type=p,g&&(A.step=g)),d.userValue){const E=d.userValue;if(v)if(p==="time"){const R=new Date(E),C=[R.getHours(),R.getMinutes(),R.getSeconds()];A.value=C.map(x=>x.toString().padStart(2,"0")).join(":")}else A.value=new Date(E-sC).toISOString().split(p==="date"?"T":".",1)[0];else A.value=E}d.lastCommittedValue=A.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const A={value(E){d.userValue=E.detail.value??"",v||t.setValue(e,{value:d.userValue.toString()}),E.target.value=d.userValue},formattedValue(E){const{formattedValue:R}=E.detail;d.formattedValue=R,R!=null&&E.target!==document.activeElement&&(E.target.value=R);const C={formattedValue:R};v&&(C.value=R),t.setValue(e,C)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:R}=E.detail,{target:C}=E;if(R===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",R);let x=d.userValue;!x||x.length<=R||(x=x.slice(0,R),C.value=d.userValue=x,t.setValue(e,{value:x}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(A,_)}),i.addEventListener("keydown",_=>{d.commitKey=1;let A=-1;if(_.key==="Escape"?A=0:_.key==="Enter"&&!this.data.multiLine?A=2:_.key==="Tab"&&(d.commitKey=3),A===-1)return;const{value:E}=_.target;d.lastCommittedValue!==E&&(d.lastCommittedValue=E,d.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:A,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const w=b;b=null,i.addEventListener("blur",_=>{if(!d.focused||!_.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:A}=_;let{value:E}=A;if(v){if(E&&p==="time"){const R=E.split(":").map(C=>parseInt(C,10));E=new Date(2e3,0,1,R[0],R[1],R[2]||0).valueOf(),A.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();A.type="text"}d.userValue=E,d.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:d.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}),w(_)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",_=>{d.lastCommittedValue=null;const{data:A,target:E}=_,{value:R,selectionStart:C,selectionEnd:x}=E;let D=C,M=x;switch(_.inputType){case"deleteWordBackward":{const k=R.substring(0,C).match(/\w*[^\w]*$/);k&&(D-=k[0].length);break}case"deleteWordForward":{const k=R.substring(C).match(/^[^\w]*\w*/);k&&(M+=k[0].length);break}case"deleteContentBackward":C===x&&(D-=1);break;case"deleteContentForward":C===x&&(M+=1);break}_.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,change:A||"",willCommit:!1,selStart:D,selEnd:M}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(b&&i.addEventListener("blur",b),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class oC extends Kn{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class lC extends Kn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return Yn.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,n&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const f of this._getElementsByName(u,i)){const p=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(i,{value:d})}),a.addEventListener("resetform",o=>{const u=e.defaultFieldValue||"Off";o.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",o=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(i,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,o)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class p_ extends Kn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const o of this._getElementsByName(e.fieldName,i))t.setValue(o.id,{value:!1});const a=document.createElement("input");if(Yn.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,n&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const f of this._getElementsByName(u,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:d})}),a.addEventListener("resetform",o=>{const u=e.defaultFieldValue;o.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;a.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const p=o===f.detail.value;for(const g of this._getElementsByName(f.target.name)){const v=p&&g.id===i;g.domElement&&(g.domElement.checked=v),t.setValue(g.id,{value:v})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class cC extends yp{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class uC extends Kn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");Yn.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue;for(const v of n.options)v.selected=v.value===g});for(const p of this.data.options){const g=document.createElement("option");g.textContent=p.displayValue,g.value=p.exportValue,i.value.includes(p.exportValue)&&(g.setAttribute("selected",!0),a=!1),n.append(g)}let o=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),n.prepend(p),o=()=>{p.remove(),n.removeEventListener("input",o),o=null},n.addEventListener("input",o)}const u=p=>{const g=p?"value":"textContent",{options:v,multiple:b}=n;return b?Array.prototype.filter.call(v,w=>w.selected).map(w=>w[g]):v.selectedIndex===-1?null:v[v.selectedIndex][g]};let d=u(!1);const f=p=>{const g=p.target.options;return Array.prototype.map.call(g,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",p=>{const g={value(v){o?.();const b=v.detail.value,w=new Set(Array.isArray(b)?b:[b]);for(const _ of n.options)_.selected=w.has(_.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(v){n.multiple=!0},remove(v){const b=n.options,w=v.detail.remove;b[w].selected=!1,n.remove(w),b.length>0&&Array.prototype.findIndex.call(b,A=>A.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},clear(v){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(v){const{index:b,displayValue:w,exportValue:_}=v.detail.insert,A=n.children[b],E=document.createElement("option");E.textContent=w,E.value=_,A?A.before(E):n.append(E),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},items(v){const{items:b}=v.detail;for(;n.length!==0;)n.remove(0);for(const w of b){const{displayValue:_,exportValue:A}=w,E=document.createElement("option");E.textContent=_,E.value=A,n.append(E)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},indices(v){const b=new Set(v.detail.indices);for(const w of v.target.options)w.selected=b.has(w.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(g,p)}),n.addEventListener("input",p=>{const g=u(!0),v=u(!1);t.setValue(e,{value:g}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:v,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):n.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Of extends ne{constructor(t){const{data:e,elements:i,parent:n}=t,a=!!n._commentManager;if(super(t,{isRenderable:!a&&ne._hasPopupData(e)}),this.elements=i,a&&ne._hasPopupData(e)){const o=this.popup=this.#t();for(const u of i)u.popup=o}else this.popup=null}#t(){return new hC({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",i.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(n=>`${ap}${n}`).join(",")),this.container}}class hC{#t=null;#e=this.#q.bind(this);#s=this.#U.bind(this);#i=this.#L.bind(this);#a=this.#w.bind(this);#n=null;#r=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#p=null;#u=null;#g=null;#y=null;#b=null;#v=null;#T=null;#A=null;#_=null;#R=!1;#S=null;#E=null;constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:a,contentsObj:o,richText:u,parent:d,rect:f,parentRect:p,open:g,commentManager:v=null}){this.#r=t,this.#A=n,this.#o=o,this.#T=u,this.#d=d,this.#n=e,this.#v=f,this.#h=p,this.#l=i,this.#t=v,this.#S=i[0],this.#c=tu.toDateObject(a),this.trigger=i.flatMap(b=>b.getElementsToTriggerPopup()),v?this.renderCommentButton():(this.#M(),this.#r.hidden=!0,g&&this.#w())}#M(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#i,{signal:t}),e.addEventListener("pointerleave",this.#s,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#x(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g||(this.#y||this.#x(),!this.#y))return;const{signal:t}=this.#p=new AbortController,e=!!this.#S.extraPopupElement,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},n=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#g=this.#S.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",n,{signal:t}),o.addEventListener("pointerleave",a,{signal:t}),o.classList.add("popupTriggerArea")}else{const o=this.#g=document.createElement("button");o.className="annotationCommentButton";const u=this.#S.container;o.style.zIndex=u.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#I(),this.#O(),o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",n,{signal:t}),o.addEventListener("pointerleave",a,{signal:t}),u.after(o)}}#O(){if(this.#S.extraPopupElement&&!this.#S.editor)return;this.renderCommentButton();const[t,e]=this.#y,{style:i}=this.#g;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#I(){this.#S.extraPopupElement||(this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#S.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:n,modificationDate:a}=this.#S.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:n,modificationDate:a}}get elementBeforePopup(){return this.#g}get comment(){return this.#E||=this.#S.commentText,this.#E}set comment(t){t!==this.comment&&(this.#S.commentText=this.#E=t)}get parentBoundingClientRect(){return this.#S.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=e)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:t,y:e,height:i}=this.#g.getBoundingClientRect(),{x:n,y:a,width:o,height:u}=this.#S.layer.getBoundingClientRect();return[(t-n)/o,(e+i-a)/u]}set commentPopupPosition(t){this.#b=t}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#b||this.commentButtonPosition.map(f=>f/100),n=this.parentBoundingClientRect,{x:a,y:o,width:u,height:d}=n;this.#t.showDialog(null,this,a+e*u,o+i*d,{...t,parentDimensions:n})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#n){const i=t.style.outlineColor=tt.makeHexColor(...this.#n);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#A?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#A}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}lp({html:this.#D||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#r.append(t)}get#D(){const t=this.#T,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#T.html||null}get#P(){return this.#D?.attributes?.style?.fontSize||0}get#j(){return this.#D?.attributes?.style?.color||null}#N(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:this.#j,fontSize:this.#P?`calc(${this.#P}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:n});return i}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#E=null):e&&(e.deleted?this.remove():(this.#I(),this.#E=e.text)),t&&(this.#y=null,this.#x(),this.#O());return}if(i||e?.deleted){this.remove();return}this.#M(),this.#_||={contentsObj:this.#o,richText:this.#T},t&&(this.#u=null),e&&e.text&&(this.#T=this.#N(e.text),this.#c=tu.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#_&&({contentsObj:this.#o,richText:this.#T}=this.#_,this.#_=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#R=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#C(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:a}}}=this.#d;let o=!!this.#h,u=o?this.#h:this.#v;for(const w of this.#l)if(!u||tt.intersect(w.data.rect,u)!==null){u=w.data.rect,o=!0;break}const d=tt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=o?u[2]-u[0]+5:0,g=d[0]+p,v=d[1];this.#u=[100*(g-n)/e,100*(v-a)/i];const{style:b}=this.#r;b.left=`${this.#u[0]}%`,b.top=`${this.#u[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#e)):(this.#U(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#e))}#L(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#C(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#U(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#R=this.isVisible,this.#R&&(this.#r.hidden=!0)}maybeShow(){this.#t||(this.#M(),this.#R&&(this.#m||this.#L(),this.#R=!1,this.#r.hidden=!1))}get isVisible(){return this.#t?!1:this.#r.hidden===!1}}class g_ extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=wt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class dC extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class fC extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",e-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class pC extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",i/2),o.setAttribute("rx",e/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class m_ extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:n},width:a,height:o}=this;if(!e)return this.container;const u=this.svgFactory.create(a,o,!0);let d=[];for(let p=0,g=e.length;p<g;p+=2){const v=e[p]-t[0],b=t[3]-e[p+1];d.push(`${v},${b}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class gC extends m_{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class mC extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class vp extends ne{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?wt.HIGHLIGHT:wt.INK}#s(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:n,popupRef:a}}=this,{transform:o,width:u,height:d}=this.#s(e,t),f=this.svgFactory.create(u,d,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",n.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let g=0,v=i.length;g<v;g++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",i[g].join(",")),p.append(b)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:n}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),i)for(let o=0,u=this.#e.length;o<u;o++)this.#e[o].setAttribute("points",i[o].join(","));if(n){const{transform:o,width:u,height:d}=this.#s(this.data.rotation,n);a.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class y_ extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=wt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class yC extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class vC extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class bC extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class v_ extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=wt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class _C extends ne{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:n}=Ae.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(n?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class bu{#t=null;#e=null;#s=null;#i=new Map;#a=null;#n=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:a,viewport:o,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:p}){this.div=t,this.#t=e,this.#e=i,this.#a=u||null,this.#n=f||null,this.#s=p||new hp,this.page=a,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=n,this._commentManager=d||null}hasEditableAnnotations(){return this.#i.size>0}async#r(t,e,i){const n=t.firstChild||t,a=n.id=`${ap}${e}`,o=await this.#a?.getAriaAttributes(a);if(o)for(const[u,d]of o)n.setAttribute(u,d);i?i.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,n,!1))}async render(t){const{annotations:e}=t,i=this.div;cn(i,this.viewport);const n=new Map,a={data:null,layer:i,linkService:this.#n,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Fo,annotationStorage:this.#s,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const u=o.annotationType===ce.POPUP;if(u){const p=n.get(o.id);if(!p)continue;a.elements=p}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;a.data=o;const d=Bb.create(a);if(!d.isRenderable)continue;if(!u&&o.popupRef){const p=n.get(o.popupRef);p?p.push(d):n.set(o.popupRef,[d])}const f=d.render();o.hidden&&(f.style.visibility="hidden"),await this.#r(f,o.id,a.elements),d.extraPopupElement?.popup?.renderCommentButton(),d._isEditable&&(this.#i.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}this.#o()}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#n,svgFactory:new Fo,parent:this};for(const i of t){i.borderStyle||=bu._defaultBorderStyle,e.data=i;const n=Bb.create(e);if(!n.isRenderable)continue;const a=n.render();await this.#r(a,i.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,cn(e,{rotation:t.rotation}),this.#o(),e.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;i.className="annotationContent";const{firstChild:a}=n;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):n.append(i);const o=this.#i.get(e);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,n.id,i),o._hasNoCanvas=!1):o.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:n}=t,a=new nC({data:{id:i,rect:t.getPDFRect(),rotation:n},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#n,annotationStorage:this.#s}),o=a.render();return e.append(o),this.#t?.moveElementInDOM(e,o,o,!1),a.createOrUpdatePopup(),a}static get _defaultBorderStyle(){return Tt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Vr.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const kc=/\r\n?|\n/g;class we extends ut{#t="";#e=`${this.id}-editor`;#s=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=we.prototype,e=a=>a.isEmpty(),i=Ts.TRANSLATE_SMALL,n=Ts.TRANSLATE_BIG;return Tt(this,"_keyboardManager",new Xo([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}]]))}static _type="freetext";static _editorType=wt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||we._defaultColor||ut._defaultLineColor,this.#i=t.fontSize||we._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){ut.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case kt.FREETEXT_SIZE:we._defaultFontSize=e;break;case kt.FREETEXT_COLOR:we._defaultColor=e;break}}updateParams(t,e){switch(t){case kt.FREETEXT_SIZE:this.#a(e);break;case kt.FREETEXT_COLOR:this.#n(e);break}}static get defaultPropertiesToUpdate(){return[[kt.FREETEXT_SIZE,we._defaultFontSize],[kt.FREETEXT_COLOR,we._defaultColor||ut._defaultLineColor]]}get propertiesToUpdate(){return[[kt.FREETEXT_SIZE,this.#i],[kt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Uo(this),[["colorPicker",this._colorPicker]]}get colorType(){return kt.FREETEXT_COLOR}#a(t){const e=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--total-scale-factor))`,this.translate(0,-(n-this.#i)*this.parentScale),this.#i=n,this.#o()},i=this.#i;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#n(t){const e=n=>{this.color=n,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-we._internalPadding*t,-(we._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#s=new AbortController;const t=this._uiManager.combinedSignal(this.#s);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#s?.abort(),this.#s=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(we.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:n,div:a}=this,o=a.style.display,u=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",n.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#r().trimEnd();if(t===e)return;const i=n=>{if(this.#t=n,!n){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){we._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,p]=this.pageDimensions,[g,v]=this.pageTranslation;let b,w;switch(this.rotation){case 0:b=t+(o[0]-g)/f,w=e+this.height-(o[1]-v)/p;break;case 90:b=t+(o[0]-g)/f,w=e-(o[1]-v)/p,[u,d]=[d,-u];break;case 180:b=t-this.width+(o[0]-g)/f,w=e-(o[1]-v)/p,[u,d]=[-u,-d];break;case 270:b=t+(o[0]-g-this.height*p)/f,w=e+(o[1]-v-this.width*f)/p,[u,d]=[-d,u];break}this.setAt(b*n,w*a,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(kc,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const n=we.#h(e.getData("text")||"").replaceAll(kc,`
`);if(!n)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!n.includes(`
`)){o.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:u,startOffset:d}=o,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const b=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(kc,"")),b!==this.editorDiv){let w=f;for(const _ of this.editorDiv.childNodes){if(_===b){w=p;continue}w.push(we.#c(_))}}f.push(u.nodeValue.slice(0,d).replaceAll(kc,""))}else if(u===this.editorDiv){let b=f,w=0;for(const _ of this.editorDiv.childNodes)w++===d&&(b=p),b.push(we.#c(_))}this.#t=`${f.join(`
`)}${n}${p.join(`
`)}`,this.#l();const g=new Range;let v=Math.sumPrecise(f.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const w=b.nodeValue.length;if(v<=w){g.setStart(b,v),g.setEnd(b,v);break}v-=w}a.removeAllRanges(),a.addRange(g)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=we._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let n=null;if(t instanceof g_){const{data:{defaultAppearanceData:{fontSize:o,fontColor:u},rect:d,rotation:f,id:p,popupRef:g,richText:v,contentsObj:b,creationDate:w,modificationDate:_},textContent:A,textPosition:E,parent:{page:{pageNumber:R}}}=t;if(!A||A.length===0)return null;n=t={annotationType:wt.FREETEXT,color:Array.from(u),fontSize:o,value:A.join(`
`),position:E,pageIndex:R-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:g,comment:b?.str||null,richText:v,creationDate:w,modificationDate:_}}const a=await super.deserialize(t,e,i);return a.#i=t.fontSize,a.color=tt.makeHexColor(...t.color),a.#t=we.#h(t.value),a._initialData=n,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=ut._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#i,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:n,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((o,u)=>o!==n[u])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const n of this.#t.split(`
`)){const a=document.createElement("div");a.append(n?document.createTextNode(n):document.createElement("br")),e.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Z{static PRECISION=1e-4;toSVGPath(){Yt("Abstract method `toSVGPath` must be implemented.")}get box(){Yt("Abstract getter `box` must be implemented.")}serialize(t,e){Yt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,n,a,o){o||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)o[u]=e+t[u]*n,o[u+1]=i+t[u+1]*a;return o}static _rescaleAndSwap(t,e,i,n,a,o){o||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)o[u]=e+t[u+1]*n,o[u+1]=i+t[u]*a;return o}static _translate(t,e,i,n){n||=new Float32Array(t.length);for(let a=0,o=t.length;a<o;a+=2)n[a]=e+t[a],n[a+1]=i+t[a+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,n,a){switch(a){case 90:return[1-e/i,t/n];case 180:return[1-t/i,1-e/n];case 270:return[e/i,1-t/n];default:return[t/i,e/n]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,n,a,o){return[(t+5*i)/6,(e+5*n)/6,(5*i+a)/6,(5*n+o)/6,(i+a)/2,(n+o)/2]}}class Bn{#t;#e=[];#s;#i;#a=[];#n=new Float32Array(18);#r;#o;#c;#l;#d;#h;#f=[];static#m=8;static#p=2;static#u=Bn.#m+Bn.#p;constructor({x:t,y:e},i,n,a,o,u=0){this.#t=i,this.#h=a*n,this.#i=o,this.#n.set([NaN,NaN,NaN,NaN,t,e],6),this.#s=u,this.#l=Bn.#m*n,this.#c=Bn.#u*n,this.#d=n,this.#f.push(t,e)}isEmpty(){return isNaN(this.#n[8])}#g(){const t=this.#n.subarray(4,6),e=this.#n.subarray(16,18),[i,n,a,o]=this.#t;return[(this.#r+(t[0]-e[0])/2-i)/a,(this.#o+(t[1]-e[1])/2-n)/o,(this.#r+(e[0]-t[0])/2-i)/a,(this.#o+(e[1]-t[1])/2-n)/o]}add({x:t,y:e}){this.#r=t,this.#o=e;const[i,n,a,o]=this.#t;let[u,d,f,p]=this.#n.subarray(8,12);const g=t-f,v=e-p,b=Math.hypot(g,v);if(b<this.#c)return!1;const w=b-this.#l,_=w/b,A=_*g,E=_*v;let R=u,C=d;u=f,d=p,f+=A,p+=E,this.#f?.push(t,e);const x=-E/w,D=A/w,M=x*this.#h,k=D*this.#h;return this.#n.set(this.#n.subarray(2,8),0),this.#n.set([f+M,p+k],4),this.#n.set(this.#n.subarray(14,18),12),this.#n.set([f-M,p-k],16),isNaN(this.#n[6])?(this.#a.length===0&&(this.#n.set([u+M,d+k],2),this.#a.push(NaN,NaN,NaN,NaN,(u+M-i)/a,(d+k-n)/o),this.#n.set([u-M,d-k],14),this.#e.push(NaN,NaN,NaN,NaN,(u-M-i)/a,(d-k-n)/o)),this.#n.set([R,C,u,d,f,p],6),!this.isEmpty()):(this.#n.set([R,C,u,d,f,p],6),Math.abs(Math.atan2(C-d,R-u)-Math.atan2(E,A))<Math.PI/2?([u,d,f,p]=this.#n.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+f)/2-i)/a,((d+p)/2-n)/o),[u,d,R,C]=this.#n.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((R+u)/2-i)/a,((C+d)/2-n)/o),!0):([R,C,u,d,f,p]=this.#n.subarray(0,6),this.#a.push(((R+5*u)/6-i)/a,((C+5*d)/6-n)/o,((5*u+f)/6-i)/a,((5*d+p)/6-n)/o,((u+f)/2-i)/a,((d+p)/2-n)/o),[f,p,u,d,R,C]=this.#n.subarray(12,18),this.#e.push(((R+5*u)/6-i)/a,((C+5*d)/6-n)/o,((5*u+f)/6-i)/a,((5*d+p)/6-n)/o,((u+f)/2-i)/a,((d+p)/2-n)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#n[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?i.push(`L${t[n+4]} ${t[n+5]}`):i.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);this.#v(i);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?i.push(`L${e[n+4]} ${e[n+5]}`):i.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return this.#b(i),i.join(" ")}#y(){const[t,e,i,n]=this.#t,[a,o,u,d]=this.#g();return`M${(this.#n[2]-t)/i} ${(this.#n[3]-e)/n} L${(this.#n[4]-t)/i} ${(this.#n[5]-e)/n} L${a} ${o} L${u} ${d} L${(this.#n[16]-t)/i} ${(this.#n[17]-e)/n} L${(this.#n[14]-t)/i} ${(this.#n[15]-e)/n} Z`}#b(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#v(t){const[e,i,n,a]=this.#t,o=this.#n.subarray(4,6),u=this.#n.subarray(16,18),[d,f,p,g]=this.#g();t.push(`L${(o[0]-e)/n} ${(o[1]-i)/a} L${d} ${f} L${p} ${g} L${(u[0]-e)/n} ${(u[1]-i)/a}`)}newFreeDrawOutline(t,e,i,n,a,o){return new b_(t,e,i,n,a,o)}getOutlines(){const t=this.#a,e=this.#e,i=this.#n,[n,a,o,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let g=0,v=d.length-2;g<v;g+=2)d[g]=(this.#f[g]-n)/o,d[g+1]=(this.#f[g+1]-a)/u;if(d[d.length-2]=(this.#r-n)/o,d[d.length-1]=(this.#o-a)/u,isNaN(i[6])&&!this.isEmpty())return this.#T(d);const f=new Float32Array(this.#a.length+24+this.#e.length);let p=t.length;for(let g=0;g<p;g+=2){if(isNaN(t[g])){f[g]=f[g+1]=NaN;continue}f[g]=t[g],f[g+1]=t[g+1]}p=this.#_(f,p);for(let g=e.length-6;g>=6;g-=6)for(let v=0;v<6;v+=2){if(isNaN(e[g+v])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[g+v],f[p+1]=e[g+v+1],p+=2}return this.#A(f,p),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#s,this.#i)}#T(t){const e=this.#n,[i,n,a,o]=this.#t,[u,d,f,p]=this.#g(),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(e[2]-i)/a,(e[3]-n)/o,NaN,NaN,NaN,NaN,(e[4]-i)/a,(e[5]-n)/o,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-i)/a,(e[17]-n)/o,NaN,NaN,NaN,NaN,(e[14]-i)/a,(e[15]-n)/o],0),this.newFreeDrawOutline(g,t,this.#t,this.#d,this.#s,this.#i)}#A(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#_(t,e){const i=this.#n.subarray(4,6),n=this.#n.subarray(16,18),[a,o,u,d]=this.#t,[f,p,g,v]=this.#g();return t.set([NaN,NaN,NaN,NaN,(i[0]-a)/u,(i[1]-o)/d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,g,v,NaN,NaN,NaN,NaN,(n[0]-a)/u,(n[1]-o)/d],e),e+=24}}class b_ extends Z{#t;#e=new Float32Array(4);#s;#i;#a;#n;#r;constructor(t,e,i,n,a,o){super(),this.#r=t,this.#a=e,this.#t=i,this.#n=n,this.#s=a,this.#i=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[u,d,f,p]=this.#e;for(let g=0,v=t.length;g<v;g+=2)t[g]=(t[g]-u)/f,t[g+1]=(t[g+1]-d)/p;for(let g=0,v=e.length;g<v;g+=2)e[g]=(e[g]-u)/f,e[g+1]=(e[g+1]-d)/p}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,i=this.#r.length;e<i;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,n],a){const o=i-t,u=n-e;let d,f;switch(a){case 0:d=Z._rescale(this.#r,t,n,o,-u),f=Z._rescale(this.#a,t,n,o,-u);break;case 90:d=Z._rescaleAndSwap(this.#r,t,e,o,u),f=Z._rescaleAndSwap(this.#a,t,e,o,u);break;case 180:d=Z._rescale(this.#r,i,e,-o,u),f=Z._rescale(this.#a,i,e,-o,u);break;case 270:d=Z._rescaleAndSwap(this.#r,i,n,-o,-u),f=Z._rescaleAndSwap(this.#a,i,n,-o,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#r;let i=e[4],n=e[5];const a=[i,n,i,n];let o=i,u=n,d=i,f=n;const p=t?Math.max:Math.min,g=new Float32Array(4);for(let b=6,w=e.length;b<w;b+=6){const _=e[b+4],A=e[b+5];isNaN(e[b])?(tt.pointBoundingBox(_,A,a),u>A?(o=_,u=A):u===A&&(o=p(o,_)),f<A?(d=_,f=A):f===A&&(d=p(d,_))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,tt.bezierBoundingBox(i,n,...e.slice(b,b+6),g),tt.rectBoundingBox(g[0],g[1],g[2],g[3],a),u>g[1]?(o=g[0],u=g[1]):u===g[1]&&(o=p(o,g[0])),f<g[3]?(d=g[2],f=g[3]):f===g[3]&&(d=p(d,g[2]))),i=_,n=A}const v=this.#e;v[0]=a[0]-this.#s,v[1]=a[1]-this.#s,v[2]=a[2]-a[0]+2*this.#s,v[3]=a[3]-a[1]+2*this.#s,this.firstPoint=[o,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,i,n,a,o=0){return new Bn(t,e,i,n,a,o)}getNewOutline(t,e){const[i,n,a,o]=this.#e,[u,d,f,p]=this.#t,g=a*f,v=o*p,b=i*f+u,w=n*p+d,_=this.newOutliner({x:this.#a[0]*g+b,y:this.#a[1]*v+w},this.#t,this.#n,t,this.#i,e??this.#s);for(let A=2;A<this.#a.length;A+=2)_.add({x:this.#a[A]*g+b,y:this.#a[A+1]*v+w});return _.getOutlines()}}class Mf{#t;#e;#s;#i=[];#a=[];constructor(t,e=0,i=0,n=!0){const a=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:_,y:A,width:E,height:R}of t){const C=Math.floor((_-e)/o)*o,x=Math.ceil((_+E+e)/o)*o,D=Math.floor((A-e)/o)*o,M=Math.ceil((A+R+e)/o)*o,k=[C,D,M,!0],I=[x,D,M,!1];this.#i.push(k,I),tt.rectBoundingBox(C,D,x,M,a)}const u=a[2]-a[0]+2*i,d=a[3]-a[1]+2*i,f=a[0]-i,p=a[1]-i;let g=n?-1/0:1/0,v=1/0;const b=this.#i.at(n?-1:-2),w=[b[0],b[2]];for(const _ of this.#i){const[A,E,R,C]=_;!C&&n?E<v?(v=E,g=A):E===v&&(g=Math.max(g,A)):C&&!n&&(E<v?(v=E,g=A):E===v&&(g=Math.min(g,A))),_[0]=(A-f)/u,_[1]=(E-p)/d,_[2]=(R-p)/d}this.#t=new Float32Array([f,p,u,d]),this.#e=[g,v],this.#s=w}getOutlines(){this.#i.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#n(t)}#n(t){const e=[],i=new Set;for(const o of t){const[u,d,f]=o;e.push([u,d,o],[u,f,o])}e.sort((o,u)=>o[1]-u[1]||o[0]-u[0]);for(let o=0,u=e.length;o<u;o+=2){const d=e[o][2],f=e[o+1][2];d.push(f),f.push(d),i.add(d),i.add(f)}const n=[];let a;for(;i.size>0;){const o=i.values().next().value;let[u,d,f,p,g]=o;i.delete(o);let v=u,b=d;for(a=[u,f],n.push(a);;){let w;if(i.has(p))w=p;else if(i.has(g))w=g;else break;i.delete(w),[u,d,f,p,g]=w,v!==u&&(a.push(v,b,u,b===d?d:f),v=u),b=b===d?f:d}a.push(v,b)}return new wC(n,this.#t,this.#e,this.#s)}#r(t){const e=this.#a;let i=0,n=e.length-1;for(;i<=n;){const a=i+n>>1,o=e[a][0];if(o===t)return a;o<t?i=a+1:n=a-1}return n+1}#o([,t,e]){const i=this.#r(t);this.#a.splice(i,0,[t,e])}#c([,t,e]){const i=this.#r(t);for(let n=i;n<this.#a.length;n++){const[a,o]=this.#a[n];if(a!==t)break;if(a===t&&o===e){this.#a.splice(n,1);return}}for(let n=i-1;n>=0;n--){const[a,o]=this.#a[n];if(a!==t)break;if(a===t&&o===e){this.#a.splice(n,1);return}}}#l(t){const[e,i,n]=t,a=[[e,i,n]],o=this.#r(n);for(let u=0;u<o;u++){const[d,f]=this.#a[u];for(let p=0,g=a.length;p<g;p++){const[,v,b]=a[p];if(!(f<=v||b<=d)){if(v>=d){if(b>f)a[p][1]=f;else{if(g===1)return[];a.splice(p,1),p--,g--}continue}a[p][2]=d,b>f&&a.push([e,f,b])}}}return a}}class wC extends Z{#t;#e;constructor(t,e,i,n){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#e){let[i,n]=e;t.push(`M${i} ${n}`);for(let a=2;a<e.length;a+=2){const o=e[a],u=e[a+1];o===i?(t.push(`V${u}`),n=u):u===n&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,e,i,n],a){const o=[],u=i-t,d=n-e;for(const f of this.#e){const p=new Array(f.length);for(let g=0;g<f.length;g+=2)p[g]=t+f[g]*u,p[g+1]=n-f[g+1]*d;o.push(p)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class kf extends Bn{newFreeDrawOutline(t,e,i,n,a,o){return new SC(t,e,i,n,a,o)}}class SC extends b_{newOutliner(t,e,i,n,a,o=0){return new kf(t,e,i,n,a,o)}}class ue extends ut{#t=null;#e=0;#s;#i=null;#a=null;#n=null;#r=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#p=null;#u="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=wt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ue.prototype;return Tt(this,"_keyboardManager",new Xo([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ue._defaultColor,this.#g=t.thickness||ue._defaultThickness,this.opacity=t.opacity||ue._defaultOpacity,this.#s=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#v(t),this.#S()):this.#s&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#b(),this.#S(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#b(){const t=new Mf(this.#s,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Mf(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#n=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:n}=this.#n;this.#m=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#v({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const n=1.5;if(this.#n=t.getNewOutline(this.#g/2+n,.0025),e>=0)this.#d=e,this.#i=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ue.#E(this.#l.box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:ue.#E(this.#n.box,g),path:{d:this.#n.toSVGPath()}})}const[a,o,u,d]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=u,this.height=d;break;case 90:{const[g,v]=this.parentDimensions;this.x=o,this.y=1-a,this.width=u*v/g,this.height=d*g/v;break}case 180:this.x=1-a,this.y=1-o,this.width=u,this.height=d;break;case 270:{const[g,v]=this.parentDimensions;this.x=1-o,this.y=a,this.width=u*v/g,this.height=d*g/v;break}}const{firstPoint:f}=t;this.#f=[(f[0]-a)/u,(f[1]-o)/d];const{lastPoint:p}=this.#n;this.#m=[(p[0]-a)/u,(p[1]-o)/d]}static initialize(t,e){ut.initialize(t,e),ue._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case kt.HIGHLIGHT_COLOR:ue._defaultColor=e;break;case kt.HIGHLIGHT_THICKNESS:ue._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case kt.HIGHLIGHT_COLOR:this.#T(e);break;case kt.HIGHLIGHT_THICKNESS:this.#A(e);break}}static get defaultPropertiesToUpdate(){return[[kt.HIGHLIGHT_COLOR,ue._defaultColor],[kt.HIGHLIGHT_THICKNESS,ue._defaultThickness]]}get propertiesToUpdate(){return[[kt.HIGHLIGHT_COLOR,this.color||ue._defaultColor],[kt.HIGHLIGHT_THICKNESS,this.#g||ue._defaultThickness],[kt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#T(t){const e=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,n=this.opacity;this.addCommands({cmd:e.bind(this,t,ue._defaultOpacity),undo:e.bind(this,i,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#A(t){const e=this.#g,i=n=>{this.#g=n,this.#_(n)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new ci({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#O())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#O())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#R(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#S(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#R():t&&(this.#S(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#_(t){this.#h&&(this.#v({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#R(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#S(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#E([t,e,i,n],a){switch(a){case 90:return[1-e-n,t,n,i];case 180:return[1-t-i,1-e-n,i,n];case 270:return[e,1-t-i,n,i]}return[t,e,i,n]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=ue.#E(this.#l.box,t)):i=ue.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:ue.#E(this.#n.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i,this.setDims(this.width,this.height),Y0(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#M(t){ue._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#x(!0);break;case 1:case 3:this.#x(!1);break}}#x(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#x(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#O(){return this.#h?this.rotation:0}#I(){if(this.#h)return null;const[t,e]=this.pageDimensions,[i,n]=this.pageTranslation,a=this.#s,o=new Float32Array(a.length*8);let u=0;for(const{x:d,y:f,width:p,height:g}of a){const v=d*t+i,b=(1-f)*e+n;o[u]=o[u+4]=v,o[u+1]=o[u+3]=b,o[u+2]=o[u+6]=v+p*t,o[u+5]=o[u+7]=b-g*e,u+=8}return o}#D(t){return this.#l.serialize(t,this.#O())}static startHighlighting(t,e,{target:i,x:n,y:a}){const{x:o,y:u,width:d,height:f}=i.getBoundingClientRect(),p=new AbortController,g=t.combinedSignal(p),v=b=>{p.abort(),this.#j(t,b)};window.addEventListener("blur",v,{signal:g}),window.addEventListener("pointerup",v,{signal:g}),window.addEventListener("pointerdown",se,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",fi,{signal:g}),i.addEventListener("pointermove",this.#P.bind(this,t),{signal:g}),this._freeHighlight=new kf({x:n,y:a},[o,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#P(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#j(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let n=null;if(t instanceof y_){const{data:{quadPoints:w,rect:_,rotation:A,id:E,color:R,opacity:C,popupRef:x,richText:D,contentsObj:M,creationDate:k,modificationDate:I},parent:{page:{pageNumber:H}}}=t;n=t={annotationType:wt.HIGHLIGHT,color:Array.from(R),opacity:C,quadPoints:w,boxes:null,pageIndex:H-1,rect:_.slice(0),rotation:A,annotationElementId:E,id:E,deleted:!1,popupRef:x,richText:D,comment:M?.str||null,creationDate:k,modificationDate:I}}else if(t instanceof vp){const{data:{inkLists:w,rect:_,rotation:A,id:E,color:R,borderStyle:{rawWidth:C},popupRef:x,richText:D,contentsObj:M,creationDate:k,modificationDate:I},parent:{page:{pageNumber:H}}}=t;n=t={annotationType:wt.HIGHLIGHT,color:Array.from(R),thickness:C,inkLists:w,boxes:null,pageIndex:H-1,rect:_.slice(0),rotation:A,annotationElementId:E,id:E,deleted:!1,popupRef:x,richText:D,comment:M?.str||null,creationDate:k,modificationDate:I}}const{color:a,quadPoints:o,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,i);f.color=tt.makeHexColor(...a),f.opacity=d||1,u&&(f.#g=t.thickness),f._initialData=n,t.comment&&f.setCommentData(t);const[p,g]=f.pageDimensions,[v,b]=f.pageTranslation;if(o){const w=f.#s=[];for(let _=0;_<o.length;_+=8)w.push({x:(o[_]-v)/p,y:1-(o[_+1]-b)/g,width:(o[_+2]-o[_])/p,height:(o[_+1]-o[_+5])/g});f.#b(),f.#S(),f.rotate(f.rotation)}else if(u){f.#h=!0;const w=u[0],_={x:w[0]-v,y:g-(w[1]-b)},A=new kf(_,[0,0,p,g],1,f.#g/2,!0,.001);for(let C=0,x=w.length;C<x;C+=2)_.x=w[C]-v,_.y=g-(w[C+1]-b),A.add(_);const{id:E,clipPathId:R}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);f.#v({highlightOutlines:A.getOutlines(),highlightId:E,clipPathId:R}),f.#S(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#g,quadPoints:this.#I(),outlines:this.#D(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#N(i)?null:(i.id=this.annotationElementId,i)}#N(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,n)=>i!==e[n])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class __{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Yt("Not implemented")}}class gt extends ut{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#i=null;static#a=null;static#n=NaN;static#r=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#u(t.box)}#d(t,e){const{id:i}=e.drawLayer.draw(gt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[n,a]of Object.entries(e))i.has(n)?Object.assign(t[n],a):t[n]=a;return t}static getDefaultDrawingOptions(t){Yt("Not implemented")}static get typesMap(){Yt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(gt.#s.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,n]of this.typesMap)t.push([i,e[n]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,n]of this.constructor.typesMap)t.push([i,e[n]]);return t}_updateProperty(t,e,i){const n=this._drawingOptions,a=n[e],o=u=>{n.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#u(d),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,gt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,gt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,gt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#u(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#h()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,e,i,n]){const{parentDimensions:[a,o],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(o/a),n*(a/o)];case 180:return[1-t,1-e,i,n];case 270:return[1-e,t,i*(o/a),n*(a/o)];default:return[t,e,i,n]}}#p(){const{x:t,y:e,width:i,height:n,parentDimensions:[a,o],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(a/o),n*(o/a)];case 180:return[1-t,1-e,i,n];case 270:return[e,1-t,i*(a/o),n*(o/a)];default:return[t,e,i,n]}}#u(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#g(){const{x:t,y:e,width:i,height:n,rotation:a,parentRotation:o,parentDimensions:[u,d]}=this;switch((a*4+o)/90){case 1:return[1-e-n,t,n,i];case 2:return[1-t-i,1-e-n,i,n];case 3:return[e,1-t-i,n,i];case 4:return[t,e-i*(u/d),n*(d/u),i*(u/d)];case 5:return[1-e,t,i*(u/d),n*(d/u)];case 6:return[1-t-n*(d/u),1-e,n*(d/u),i*(u/d)];case 7:return[e-i*(u/d),1-t-n*(d/u),i*(u/d),n*(d/u)];case 8:return[t-i,e-n,i,n];case 9:return[1-e,t-i,n,i];case 10:return[1-t,1-e,i,n];case 11:return[e-n,1-t,n,i];case 12:return[t-n*(d/u),e,n*(d/u),i*(u/d)];case 13:return[1-e-i*(u/d),t-n*(d/u),i*(u/d),n*(d/u)];case 14:return[1-t,1-e-i*(u/d),n*(d/u),i*(u/d)];case 15:return[e,1-t,i*(u/d),n*(d/u)];default:return[t,e,i,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,gt._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const n=document.createElement("div");return i.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,n,a){Yt("Not implemented")}static startDrawing(t,e,i,n){const{target:a,offsetX:o,offsetY:u,pointerId:d,pointerType:f}=n;if(gt.#r&&gt.#r!==f)return;const{viewport:{rotation:p}}=t,{width:g,height:v}=a.getBoundingClientRect(),b=gt.#i=new AbortController,w=t.combinedSignal(b);if(gt.#n||=d,gt.#r??=f,window.addEventListener("pointerup",_=>{gt.#n===_.pointerId?this._endDraw(_):gt.#o?.delete(_.pointerId)},{signal:w}),window.addEventListener("pointercancel",_=>{gt.#n===_.pointerId?this._currentParent.endDrawingSession():gt.#o?.delete(_.pointerId)},{signal:w}),window.addEventListener("pointerdown",_=>{gt.#r===_.pointerType&&((gt.#o||=new Set).add(_.pointerId),gt.#s.isCancellable()&&(gt.#s.removeLastElement(),gt.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",fi,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",_=>{_.timeStamp===gt.#c&&se(_)},{signal:w}),t.toggleDrawing(),e._editorUndoBar?.hide(),gt.#s){t.drawLayer.updateProperties(this._currentDrawId,gt.#s.startNew(o,u,g,v,p));return}e.updateUIForDefaultProperties(this),gt.#s=this.createDrawerInstance(o,u,g,v,p),gt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(gt.#a.toSVGProperties(),gt.#s.defaultSVGProperties),!0,!1)}static _drawMove(t){if(gt.#c=-1,!gt.#s)return;const{offsetX:e,offsetY:i,pointerId:n}=t;if(gt.#n===n){if(gt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,gt.#s.add(e,i)),gt.#c=t.timeStamp,se(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,gt.#s=null,gt.#a=null,gt.#r=null,gt.#c=NaN),gt.#i&&(gt.#i.abort(),gt.#i=null,gt.#n=NaN,gt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,gt.#s.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=gt.#s,n=this._currentDrawId,a=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(n,i.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(n,i.removeLastElement())},mustExec:!1,type:kt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(kt.DRAW_STEP),!gt.#s.isEmpty()){const{pageDimensions:[i,n],scale:a}=e,o=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:gt.#s.getOutlines(i*a,n*a,a,this._INNER_MARGIN),drawingOptions:gt.#a,mustBeCommitted:!t});return this._cleanup(!0),o}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,n,a,o){Yt("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:u}}=e.viewport,d=this.deserializeDraw(o,u,n,a,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#l({drawOutlines:d}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[n,a]=this.pageDimensions;return this.#t.serialize([e,i,n,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class AC{#t=new Float64Array(6);#e;#s;#i;#a;#n;#r="";#o=0;#c=new Qo;#l;#d;constructor(t,e,i,n,a,o){this.#l=i,this.#d=n,this.#i=a,this.#a=o,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#n=[t,e],this.#s=[{line:u,points:this.#n}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#h(t,e){return Z._normalizePoint(t,e,this.#l,this.#d,this.#i)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#n.length<=10}add(t,e){[t,e]=this.#h(t,e);const[i,n,a,o]=this.#t.subarray(2,6),u=t-a,d=e-o;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#n.push(t,e),isNaN(i)?(this.#t.set([a,o,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,n,a,o,t,e],0),this.#e.push(...Z.createBezierPoints(i,n,a,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#n.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,n,a){this.#l=i,this.#d=n,this.#i=a,[t,e]=this.#h(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#n=[t,e];const u=this.#s.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#s.push({line:o,points:this.#n}),this.#t.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(t){return this.#s?(this.#s.push(t),this.#e=t.line,this.#n=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#s)return this.#c.removeLastElement();this.#s.pop(),this.#r="";for(let t=0,e=this.#s.length;t<e;t++){const{line:i,points:n}=this.#s[t];this.#e=i,this.#n=n,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=Z.svgRound(this.#e[4]),e=Z.svgRound(this.#e[5]);if(this.#n.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#n.length<=6){const n=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,n)} M ${t} ${e}`,this.#o=6}if(this.#n.length===4){const n=Z.svgRound(this.#e[10]),a=Z.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${n} ${a}`,this.#o=12,this.#r}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let n=this.#o,a=this.#e.length;n<a;n+=6){const[o,u,d,f,p,g]=this.#e.slice(n,n+6).map(Z.svgRound);i.push(`C${o} ${u} ${d} ${f} ${p} ${g}`)}return this.#r+=i.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,i,n){const a=this.#s.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#s,t,e,i,this.#i,this.#a,n),this.#t=null,this.#e=null,this.#s=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Qo extends Z{#t;#e=0;#s;#i;#a;#n;#r;#o;#c;build(t,e,i,n,a,o,u){this.#a=e,this.#n=i,this.#r=n,this.#o=a,this.#c=o,this.#s=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${Z.svgRound(e[4])} ${Z.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Z.svgRound(e[10])} ${Z.svgRound(e[11])}`);continue}for(let i=6,n=e.length;i<n;i+=6){const[a,o,u,d,f,p]=e.subarray(i,i+6).map(Z.svgRound);t.push(`C${a} ${o} ${u} ${d} ${f} ${p}`)}}return t.join("")}serialize([t,e,i,n],a){const o=[],u=[],[d,f,p,g]=this.#d();let v,b,w,_,A,E,R,C,x;switch(this.#o){case 0:x=Z._rescale,v=t,b=e+n,w=i,_=-n,A=t+d*i,E=e+(1-f-g)*n,R=t+(d+p)*i,C=e+(1-f)*n;break;case 90:x=Z._rescaleAndSwap,v=t,b=e,w=i,_=n,A=t+f*i,E=e+d*n,R=t+(f+g)*i,C=e+(d+p)*n;break;case 180:x=Z._rescale,v=t+i,b=e,w=-i,_=n,A=t+(1-d-p)*i,E=e+f*n,R=t+(1-d)*i,C=e+(f+g)*n;break;case 270:x=Z._rescaleAndSwap,v=t+i,b=e+n,w=-i,_=-n,A=t+(1-f-g)*i,E=e+(1-d-p)*n,R=t+(1-f)*i,C=e+(1-d)*n;break}for(const{line:D,points:M}of this.#i)o.push(x(D,v,b,w,_,a?new Array(D.length):null)),u.push(x(M,v,b,w,_,a?new Array(M.length):null));return{lines:o,points:u,rect:[A,E,R,C]}}static deserialize(t,e,i,n,a,{paths:{lines:o,points:u},rotation:d,thickness:f}){const p=[];let g,v,b,w,_;switch(d){case 0:_=Z._rescale,g=-t/i,v=e/n+1,b=1/i,w=-1/n;break;case 90:_=Z._rescaleAndSwap,g=-e/n,v=-t/i,b=1/n,w=1/i;break;case 180:_=Z._rescale,g=t/i+1,v=-e/n,b=-1/i,w=1/n;break;case 270:_=Z._rescaleAndSwap,g=e/n+1,v=t/i+1,b=-1/n,w=-1/i;break}if(!o){o=[];for(const E of u){const R=E.length;if(R===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(R===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const C=new Float32Array(3*(R-2));o.push(C);let[x,D,M,k]=E.subarray(0,4);C.set([NaN,NaN,NaN,NaN,x,D],0);for(let I=4;I<R;I+=2){const H=E[I],X=E[I+1];C.set(Z.createBezierPoints(x,D,M,k,H,X),(I-2)*3),[x,D,M,k]=[M,k,H,X]}}}for(let E=0,R=o.length;E<R;E++)p.push({line:_(o[E].map(C=>C??NaN),g,v,b,w),points:_(u[E].map(C=>C??NaN),g,v,b,w)});const A=new this.prototype.constructor;return A.build(p,i,n,1,d,f,a),A}#l(t=this.#c){const e=this.#s+t/2*this.#r;return this.#o%180===0?[e/this.#a,e/this.#n]:[e/this.#n,e/this.#a]}#d(){const[t,e,i,n]=this.#t,[a,o]=this.#l(0);return[t+a,e+o,i-2*a,n-2*o]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#i){if(n.length<=12){for(let u=4,d=n.length;u<d;u+=6)tt.pointBoundingBox(n[u],n[u+1],t);continue}let a=n[4],o=n[5];for(let u=6,d=n.length;u<d;u+=6){const[f,p,g,v,b,w]=n.subarray(u,u+6);tt.bezierBoundingBox(a,o,f,p,g,v,b,w,t),a=b,o=w}}const[e,i]=this.#l();t[0]=Pe(t[0]-e,0,1),t[1]=Pe(t[1]-i,0,1),t[2]=Pe(t[2]+e,0,1),t[3]=Pe(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[n,a]=this.#l(),[o,u]=[n-e,a-i],d=this.#t;return d[0]-=o,d[1]-=u,d[2]+=2*o,d[3]+=2*u,d}updateParentDimensions([t,e],i){const[n,a]=this.#l();this.#a=t,this.#n=e,this.#r=i;const[o,u]=this.#l(),d=o-n,f=u-a,p=this.#t;return p[0]-=d,p[1]-=f,p[2]+=2*d,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Z.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,n=0,a=0,o=0,u=0,d=0;switch(this.#e){case 90:n=e/t,a=-t/e,u=t;break;case 180:i=-1,o=-1,u=t,d=e;break;case 270:n=-e/t,a=t/e,d=e;break;default:return""}return`matrix(${i} ${n} ${a} ${o} ${Z.svgRound(u)} ${Z.svgRound(d)})`}getPathResizingSVGProperties([t,e,i,n]){const[a,o]=this.#l(),[u,d,f,p]=this.#t;if(Math.abs(f-a)<=Z.PRECISION||Math.abs(p-o)<=Z.PRECISION){const _=t+i/2-(u+f/2),A=e+n/2-(d+p/2);return{path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`,transform:`${this.rotationTransform} translate(${_} ${A})`}}}const g=(i-2*a)/(f-2*a),v=(n-2*o)/(p-2*o),b=f/i,w=p/n;return{path:{"transform-origin":`${Z.svgRound(u)} ${Z.svgRound(d)}`,transform:`${this.rotationTransform} scale(${b} ${w}) translate(${Z.svgRound(a)} ${Z.svgRound(o)}) scale(${g} ${v}) translate(${Z.svgRound(-a)} ${Z.svgRound(-o)})`}}}getPathResizedSVGProperties([t,e,i,n]){const[a,o]=this.#l(),u=this.#t,[d,f,p,g]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=n,Math.abs(p-a)<=Z.PRECISION||Math.abs(g-o)<=Z.PRECISION){const A=t+i/2-(d+p/2),E=e+n/2-(f+g/2);for(const{line:R,points:C}of this.#i)Z._translate(R,A,E,R),Z._translate(C,A,E,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*a)/(p-2*a),b=(n-2*o)/(g-2*o),w=-v*(d+a)+t+a,_=-b*(f+o)+e+o;if(v!==1||b!==1||w!==0||_!==0)for(const{line:A,points:E}of this.#i)Z._rescale(A,w,_,v,b,A),Z._rescale(E,w,_,v,b,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[n,a]=i,o=this.#t,u=t-o[0],d=e-o[1];if(this.#a===n&&this.#n===a)for(const{line:f,points:p}of this.#i)Z._translate(f,u,d,f),Z._translate(p,u,d,p);else{const f=this.#a/n,p=this.#n/a;this.#a=n,this.#n=a;for(const{line:g,points:v}of this.#i)Z._rescale(g,u,d,f,p,g),Z._rescale(v,u,d,f,p,v);o[2]*=f,o[3]*=p}return o[0]=t,o[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Z.svgRound(t)} ${Z.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Z.svgRound(t[0])} ${Z.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class _u extends __{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ut._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new _u(this._viewParameters);return t.updateAll(this),t}}class bp extends gt{static _type="ink";static _editorType=wt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){ut.initialize(t,e),this._defaultDrawingOptions=new _u(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Tt(this,"typesMap",new Map([[kt.INK_THICKNESS,"stroke-width"],[kt.INK_COLOR,"stroke"],[kt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,n,a){return new AC(t,e,i,n,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,n,a,o){return Qo.deserialize(t,e,i,n,a,o)}static async deserialize(t,e,i){let n=null;if(t instanceof vp){const{data:{inkLists:o,rect:u,rotation:d,id:f,color:p,opacity:g,borderStyle:{rawWidth:v},popupRef:b,richText:w,contentsObj:_,creationDate:A,modificationDate:E},parent:{page:{pageNumber:R}}}=t;n=t={annotationType:wt.INK,color:Array.from(p),thickness:v,opacity:g,paths:{points:o},boxes:null,pageIndex:R-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:b,richText:w,comment:_?.str||null,creationDate:A,modificationDate:E}}const a=await super.deserialize(t,e,i);return a._initialData=n,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||=new Uo(this),[["colorPicker",this._colorPicker]]}get colorType(){return kt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=bp.getDefaultDrawingOptions({stroke:tt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:n,"stroke-opacity":a,"stroke-width":o}}=this,u=Object.assign(super.serialize(t),{color:ut._colorManager.convert(n),opacity:a,thickness:o,paths:{lines:e,points:i}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:n,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,u)=>o!==e[u])||t.thickness!==i||t.opacity!==n||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Df extends Qo{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Dc=8,bo=3;class Ln{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,n){return i-=t,n-=e,i===0?n>0?0:4:i===1?n+6:2-n}static#s=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,i,n,a,o,u){const d=this.#e(i,n,a,o);for(let f=0;f<8;f++){const p=(-f+d-u+16)%8,g=this.#s[2*p],v=this.#s[2*p+1];if(t[(i+g)*e+(n+v)]!==0)return p}return-1}static#a(t,e,i,n,a,o,u){const d=this.#e(i,n,a,o);for(let f=0;f<8;f++){const p=(f+d+u+16)%8,g=this.#s[2*p],v=this.#s[2*p+1];if(t[(i+g)*e+(n+v)]!==0)return p}return-1}static#n(t,e,i,n){const a=t.length,o=new Int32Array(a);for(let p=0;p<a;p++)o[p]=t[p]<=n?1:0;for(let p=1;p<i-1;p++)o[p*e]=o[p*e+e-1]=0;for(let p=0;p<e;p++)o[p]=o[e*i-1-p]=0;let u=1,d;const f=[];for(let p=1;p<i-1;p++){d=1;for(let g=1;g<e-1;g++){const v=p*e+g,b=o[v];if(b===0)continue;let w=p,_=g;if(b===1&&o[v-1]===0)u+=1,_-=1;else if(b>=1&&o[v+1]===0)u+=1,_+=1,b>1&&(d=b);else{b!==1&&(d=Math.abs(b));continue}const A=[g,p],E=_===g+1,R={isHole:E,points:A,id:u,parent:0};f.push(R);let C;for(const W of f)if(W.id===d){C=W;break}C?C.isHole?R.parent=E?C.parent:d:R.parent=E?d:C.parent:R.parent=E?d:0;const x=this.#i(o,e,p,g,w,_,0);if(x===-1){o[v]=-u,o[v]!==1&&(d=Math.abs(o[v]));continue}let D=this.#s[2*x],M=this.#s[2*x+1];const k=p+D,I=g+M;w=k,_=I;let H=p,X=g;for(;;){const W=this.#a(o,e,H,X,w,_,1);D=this.#s[2*W],M=this.#s[2*W+1];const et=H+D,mt=X+M;A.push(mt,et);const ft=H*e+X;if(o[ft+1]===0?o[ft]=-u:o[ft]===1&&(o[ft]=u),et===p&&mt===g&&H===k&&X===I){o[v]!==1&&(d=Math.abs(o[v]));break}else w=H,_=X,H=et,X=mt}}}return f}static#r(t,e,i,n){if(i-e<=4){for(let k=e;k<i-2;k+=2)n.push(t[k],t[k+1]);return}const a=t[e],o=t[e+1],u=t[i-4]-a,d=t[i-3]-o,f=Math.hypot(u,d),p=u/f,g=d/f,v=p*o-g*a,b=d/u,w=1/f,_=Math.atan(b),A=Math.cos(_),E=Math.sin(_),R=w*(Math.abs(A)+Math.abs(E)),C=w*(1-R+R**2),x=Math.max(Math.atan(Math.abs(E+A)*C),Math.atan(Math.abs(E-A)*C));let D=0,M=e;for(let k=e+2;k<i-2;k+=2){const I=Math.abs(v-p*t[k+1]+g*t[k]);I>D&&(M=k,D=I)}D>(f*x)**2?(this.#r(t,e,M+2,n),this.#r(t,M,i,n)):n.push(a,o)}static#o(t){const e=[],i=t.length;return this.#r(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,n,a,o){const u=new Float32Array(o**2),d=-2*n**2,f=o>>1;for(let _=0;_<o;_++){const A=(_-f)**2;for(let E=0;E<o;E++)u[_*o+E]=Math.exp((A+(E-f)**2)/d)}const p=new Float32Array(256),g=-2*a**2;for(let _=0;_<256;_++)p[_]=Math.exp(_**2/g);const v=t.length,b=new Uint8Array(v),w=new Uint32Array(256);for(let _=0;_<i;_++)for(let A=0;A<e;A++){const E=_*e+A,R=t[E];let C=0,x=0;for(let M=0;M<o;M++){const k=_+M-f;if(!(k<0||k>=i))for(let I=0;I<o;I++){const H=A+I-f;if(H<0||H>=e)continue;const X=t[k*e+H],W=u[M*o+I]*p[Math.abs(X-R)];C+=X*W,x+=W}}const D=b[E]=Math.round(C/x);w[D]++}return[b,w]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let n=-1/0,a=1/0;for(let u=0,d=i.length;u<d;u++){const f=i[u]=t[u<<2];n=Math.max(n,f),a=Math.min(a,f)}const o=255/(n-a);for(let u=0,d=i.length;u<d;u++)i[u]=(i[u]-a)*o;return i}static#h(t){let e,i=-1/0,n=-1/0;const a=t.findIndex(d=>d!==0);let o=a,u=a;for(e=a;e<256;e++){const d=t[e];d>i&&(e-o>n&&(n=e-o,u=e-1),i=d,o=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:n}=t,{maxDim:a}=this.#t;let o=i,u=n;if(i>a||n>a){let v=i,b=n,w=Math.log2(Math.max(i,n)/a);const _=Math.floor(w);w=w===_?_-1:_;for(let E=0;E<w;E++){o=Math.ceil(v/2),u=Math.ceil(b/2);const R=new OffscreenCanvas(o,u);R.getContext("2d").drawImage(t,0,0,v,b,0,0,o,u),v=o,b=u,t!==e&&t.close(),t=R.transferToImageBitmap()}const A=Math.min(a/o,a/u);o=Math.round(o*A),u=Math.round(u*A)}const f=new OffscreenCanvas(o,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,o,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,o,u);const p=f.getImageData(0,0,o,u).data;return[this.#d(p),o,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:n},a,o,u,d){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const g=200,v=p.font=`${i} ${n} ${g}px ${e}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:w,actualBoundingBoxAscent:_,actualBoundingBoxDescent:A,fontBoundingBoxAscent:E,fontBoundingBoxDescent:R,width:C}=p.measureText(t),x=1.5,D=Math.ceil(Math.max(Math.abs(b)+Math.abs(w)||0,C)*x),M=Math.ceil(Math.max(Math.abs(_)+Math.abs(A)||g,Math.abs(E)+Math.abs(R)||g)*x);f=new OffscreenCanvas(D,M),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,D,M),p.fillStyle="black",p.fillText(t,D*(x-1)/2,M*(3-x)/2);const k=this.#d(p.getImageData(0,0,D,M).data),I=this.#l(k),H=this.#h(I),X=this.#n(k,D,M,H);return this.processDrawnLines({lines:{curves:X,width:D,height:M},pageWidth:a,pageHeight:o,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,i,n,a){const[o,u,d]=this.#f(t),[f,p]=this.#c(o,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),g=this.#h(p),v=this.#n(f,u,d,g);return this.processDrawnLines({lines:{curves:v,width:u,height:d},pageWidth:e,pageHeight:i,rotation:n,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:a,mustSmooth:o,areContours:u}){n%180!==0&&([e,i]=[i,e]);const{curves:d,width:f,height:p}=t,g=t.thickness??0,v=[],b=Math.min(e/f,i/p),w=b/e,_=b/i,A=[];for(const{points:R}of d){const C=o?this.#o(R):R;if(!C)continue;A.push(C);const x=C.length,D=new Float32Array(x),M=new Float32Array(3*(x===2?2:x-2));if(v.push({line:M,points:D}),x===2){D[0]=C[0]*w,D[1]=C[1]*_,M.set([NaN,NaN,NaN,NaN,D[0],D[1]],0);continue}let[k,I,H,X]=C;k*=w,I*=_,H*=w,X*=_,D.set([k,I,H,X],0),M.set([NaN,NaN,NaN,NaN,k,I],0);for(let W=4;W<x;W+=2){const et=D[W]=C[W]*w,mt=D[W+1]=C[W+1]*_;M.set(Z.createBezierPoints(k,I,H,X,et,mt),(W-2)*3),[k,I,H,X]=[H,X,et,mt]}}if(v.length===0)return null;const E=u?new Df:new Qo;return E.build(v,e,i,1,n,u?0:g,a),{outline:E,newCurves:A,areContours:u,thickness:g,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:n,height:a}){let o=1/0,u=-1/0,d=0;for(const C of t){d+=C.length;for(let x=2,D=C.length;x<D;x++){const M=C[x]-C[x-2];o=Math.min(o,M),u=Math.max(u,M)}}let f;o>=-128&&u<=127?f=Int8Array:o>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,g=Dc+bo*p,v=new Uint32Array(g);let b=0;v[b++]=g*Uint32Array.BYTES_PER_ELEMENT+(d-2*p)*f.BYTES_PER_ELEMENT,v[b++]=0,v[b++]=n,v[b++]=a,v[b++]=e?0:1,v[b++]=Math.max(0,Math.floor(i??0)),v[b++]=p,v[b++]=f.BYTES_PER_ELEMENT;for(const C of t)v[b++]=C.length-2,v[b++]=C[0],v[b++]=C[1];const w=new CompressionStream("deflate-raw"),_=w.writable.getWriter();await _.ready,_.write(v);const A=f.prototype.constructor;for(const C of t){const x=new A(C.length-2);for(let D=2,M=C.length;D<M;D++)x[D-2]=C[D]-C[D-2];_.write(x)}_.close();const E=await new Response(w.readable).arrayBuffer(),R=new Uint8Array(E);return F0(R)}static async decompressSignature(t){try{const e=XT(t),{readable:i,writable:n}=new DecompressionStream("deflate-raw"),a=n.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let o=null,u=0;for await(const C of i)o||=new Uint8Array(new Uint32Array(C.buffer,0,4)[0]),o.set(C,u),u+=C.length;const d=new Uint32Array(o.buffer,0,o.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=d[2],g=d[3],v=d[4]===0,b=d[5],w=d[6],_=d[7],A=[],E=(Dc+bo*w)*Uint32Array.BYTES_PER_ELEMENT;let R;switch(_){case Int8Array.BYTES_PER_ELEMENT:R=new Int8Array(o.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:R=new Int16Array(o.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:R=new Int32Array(o.buffer,E);break}u=0;for(let C=0;C<w;C++){const x=d[bo*C+Dc],D=new Float32Array(x+2);A.push(D);for(let M=0;M<bo-1;M++)D[M]=d[bo*C+Dc+M+1];for(let M=0;M<x;M++)D[M+2]=D[M]+R[u++]}return{areContours:v,thickness:b,outlines:A,width:p,height:g}}catch(e){return St(`decompressSignature: ${e}`),null}}}class _p extends __{constructor(){super(),super.updateProperties({fill:ut._defaultLineColor,"stroke-width":0})}clone(){const t=new _p;return t.updateAll(this),t}}class wp extends _u{constructor(t){super(t),super.updateProperties({stroke:ut._defaultLineColor,"stroke-width":1})}clone(){const t=new wp(this._viewParameters);return t.updateAll(this),t}}class Xi extends gt{#t=!1;#e=null;#s=null;#i=null;static _type="signature";static _editorType=wt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#s=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){ut.initialize(t,e),this._defaultDrawingOptions=new _p,this._defaultDrawnSignatureOptions=new wp(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Tt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#s){const{lines:n,mustSmooth:a,areContours:o,description:u,uuid:d,heightInPage:f}=this.#s,{rawDims:{pageWidth:p,pageHeight:g},rotation:v}=this.parent.viewport,b=Ln.processDrawnLines({lines:n,pageWidth:p,pageHeight:g,rotation:v,innerMargin:Xi._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(b,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:n,height:a}=this.#s,o=Math.max(n,a),u=Ln.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:i,width:n,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,n){const{x:a,y:o}=this,{outline:u}=this.#s=t;this.#t=u instanceof Df,this.description=i;let d;this.#t?d=Xi.getDefaultDrawingOptions():(d=Xi._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let p=e/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(n),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!n,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:n}=this.parent.viewport;return Ln.process(t,e,i,n,Xi._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:n},rotation:a}=this.parent.viewport;return Ln.extractContoursFromText(t,e,i,n,a,Xi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:n}=this.parent.viewport;return Ln.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:Xi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Xi.getDefaultDrawingOptions():(this._drawingOptions=Xi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":n}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:n});return this.addComment(a),t?(a.paths={lines:e,points:i},a.uuid=this.#i,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,i,n,a,o){return o.areContours?Df.deserialize(t,e,i,n,a,o):Qo.deserialize(t,e,i,n,a,o)}static async deserialize(t,e,i){const n=await super.deserialize(t,e,i);return n.#t=t.areContours,n.description=t.accessibilityData?.alt||"",n.#i=t.uuid,n}}class EC extends ut{#t=null;#e=null;#s=null;#i=null;#a=null;#n="";#r=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=wt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){ut.initialize(t,e)}static isHandlingMimeForPasting(t){return eu.includes(t)}static paste(t,e){e.pasteEditor({mode:wt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#n=t.file.name),this.#p()}#f(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:n,width:a,height:o,channels:n.length/(a*o)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#h(i,!0)).finally(()=>this.#f());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(i).then(n=>this.#h(n)).finally(()=>this.#f());return}if(this.#a){const i=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(i).then(n=>this.#h(n)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=eu.join(",");const e=this._uiManager._signal;this.#s=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(n)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#s||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:n}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,n&&(this.#t=n),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:e,height:i}=this.#t;const[n,a]=this.pageDimensions,o=.75;if(this.width)e=this.width*n,i=this.height*a;else if(e>o*n||i>o*a){const d=Math.min(o*n/e,o*a/i);e*=d,i*=d}this._uiManager.enableWaiting(!1);const u=this.#r=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/n,this.height=i/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#n&&this.div.setAttribute("aria-description",this.#n),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:n,height:a}=this.#t,o=new Ui;let u=this.#t,d=n,f=a,p=null;if(e){if(n>e||a>e){const M=Math.min(e/n,e/a);d=Math.floor(n*M),f=Math.floor(a*M)}p=document.createElement("canvas");const v=p.width=Math.ceil(d*o.sx),b=p.height=Math.ceil(f*o.sy);this.#l||(u=this.#u(v,b));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let _="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":QT.isDarkMode&&(_="#8f8f9d",A="#42414d");const E=15,R=E*o.sx,C=E*o.sy,x=new OffscreenCanvas(R*2,C*2),D=x.getContext("2d");D.fillStyle=_,D.fillRect(0,0,R*2,C*2),D.fillStyle=A,D.fillRect(0,0,R,C),D.fillRect(R,C,R,C),w.fillStyle=w.createPattern(x,"repeat"),w.fillRect(0,0,v,b),w.drawImage(u,0,0,u.width,u.height,0,0,v,b)}let g=null;if(i){let v,b;if(o.symmetric&&u.width<t&&u.height<t)v=u.width,b=u.height;else if(u=this.#t,n>t||a>t){const A=Math.min(t/n,t/a);v=Math.floor(n*A),b=Math.floor(a*A),this.#l||(u=this.#u(v,b))}const _=new OffscreenCanvas(v,b).getContext("2d",{willReadFrequently:!0});_.drawImage(u,0,0,u.width,u.height,0,0,v,b),g={width:v,height:b,data:_.getImageData(0,0,v,b).data}}return{canvas:p,width:d,height:f,imageData:g}}#u(t,e){const{width:i,height:n}=this.#t;let a=i,o=n,u=this.#t;for(;a>2*t||o>2*e;){const d=a,f=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(a,o);p.getContext("2d").drawImage(u,0,0,d,f,0,0,a,o),u=p.transferToImageBitmap()}return u}#g(){const[t,e]=this.parentDimensions,{width:i,height:n}=this,a=new Ui,o=Math.ceil(i*t*a.sx),u=Math.ceil(n*e*a.sy),d=this.#r;if(!d||d.width===o&&d.height===u)return;d.width=o,d.height=u;const f=this.#l?this.#t:this.#u(o,u),p=d.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,o,u)}#y(t){if(t){if(this.#l){const n=this._uiManager.imageManager.getSvgUrl(this.#e);if(n)return n}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,n=Math.round(this.width*e*Gn.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Gn.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(n,a);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,n,a),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let n=null,a=!1;if(t instanceof v_){const{data:{rect:_,rotation:A,id:E,structParent:R,popupRef:C,richText:x,contentsObj:D,creationDate:M,modificationDate:k},container:I,parent:{page:{pageNumber:H}},canvas:X}=t;let W,et;X?(delete t.canvas,{id:W,bitmap:et}=i.imageManager.getFromCanvas(I.id,X),X.remove()):(a=!0,t._hasNoCanvas=!0);const mt=(await e._structTree.getAriaAttributes(`${ap}${E}`))?.get("aria-label")||"";n=t={annotationType:wt.STAMP,bitmapId:W,bitmap:et,pageIndex:H-1,rect:_.slice(0),rotation:A,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:mt},isSvg:!1,structParent:R,popupRef:C,richText:x,comment:D?.str||null,creationDate:M,modificationDate:k}}const o=await super.deserialize(t,e,i),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:g,accessibilityData:v}=t;a?(i.addMissingCanvas(t.id,o),o.#o=!0):p&&i.imageManager.isValidId(p)?(o.#e=p,d&&(o.#t=d)):o.#i=f,o.#l=g;const[b,w]=o.pageDimensions;return o.width=(u[2]-u[0])/b,o.height=(u[3]-u[1])/w,v&&(o.altTextData=v),o._initialData=n,t.comment&&o.setCommentData(t),o.#d=!!n,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:n,altText:a}=this.serializeAltText(!1);if(!n&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const u=this.#b(i);return u.isSame?null:(u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const o=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:o,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);o>u.area&&(u.area=o,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return i}#b(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,n=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&n&&a,isSameAltText:a}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Wi{#t;#e=!1;#s=null;#i=null;#a=null;#n=new Map;#r=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#p=-1;#u;static _initialized=!1;static#g=new Map([we,bp,EC,ue,Xi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:n,accessibilityManager:a,annotationLayer:o,drawLayer:u,textLayer:d,viewport:f,l10n:p}){const g=[...Wi.#g.values()];if(!Wi._initialized){Wi._initialized=!0;for(const v of g)v.initialize(p,t)}t.registerEditorTypes(g),this.#u=t,this.pageIndex=e,this.div=i,this.#t=a,this.#s=o,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=n,this.#u.addLayer(this)}get isEmpty(){return this.#n.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===wt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#_(),t){case wt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case wt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case wt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===wt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of Wi.#g.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#s?.div.classList.toggle("disabled",!t)}get#y(){return this.#n.size!==0?this.#n.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const i of this.#y)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#u.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#s;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#u.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const n=await this.deserialize(i);n&&(this.addOrRebuild(n),n.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const i=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",n=>{const{clientX:o,clientY:u,timeStamp:d}=n,f=this.#p;if(d-f>500){this.#p=d;return}this.#p=-1;const{classList:p}=this.div;p.toggle("getElements",!0);const g=document.elementsFromPoint(o,u);if(p.toggle("getElements",!1),!this.div.contains(g[0]))return;let v;const b=new RegExp(`^${Bo}[0-9]+$`);for(const _ of g)if(b.test(_.id)){v=_.id;break}if(!v)return;const w=this.#n.get(v);w?.annotationElementId===null&&(n.stopPropagation(),n.preventDefault(),w.dblclick(n))},{signal:i,capture:!0})}const t=this.#s;if(t){const i=new Map,n=new Map;for(const o of this.#y){if(o.disableEditing(),!o.annotationElementId){o.updateFakeAnnotationElement(t);continue}if(o.serialize()!==null){i.set(o.annotationElementId,o);continue}else n.set(o.annotationElementId,o);this.getEditableAnnotation(o.annotationElementId)?.show(),o.remove()}const a=t.getEditableAnnotations();for(const o of a){const{id:u}=o.data;if(this.#u.isDeletedAnnotationElement(u)){o.updateEdited({deleted:!0});continue}let d=n.get(u);if(d){d.resetAnnotationElement(o),d.show(!1),o.show();continue}d=i.get(u),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(o)&&d.show(!1)),o.show()}}this.#_(),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const i of Wi.#g.values())e.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#s?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#b(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:i}=Ae.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ue.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#n.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#n.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t.annotationElementId),ut.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#n.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#v(){return Wi.#g.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#T(t){const e=this.#v;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:i,offsetY:n}=this.#A(),a=this.getNextId(),o=this.#T({parent:this,id:a,x:i,y:n,uiManager:this.#u,isCentered:!0,...e});o&&this.add(o)}async deserialize(t){return await Wi.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),a=this.#T({parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...i});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:t,y:e,width:i,height:n}=this.boundingClientRect,a=Math.max(0,t),o=Math.max(0,e),u=Math.min(window.innerWidth,t+i),d=Math.min(window.innerHeight,e+n),f=(a+u)/2-t,p=(o+d)/2-e,[g,v]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:g,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#A(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=Ae.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#u.getMode();if(i===wt.STAMP||i===wt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===wt.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=Ae.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#v?.isDrawer){this.startDrawingSession(t);return}const i=this.#u.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#v.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(t)):null}findNewParent(t,e,i){const n=this.#u.findParent(e,i);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#n.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#n.clear(),this.#u.removeLayer(this)}#_(){for(const t of this.#n.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,cn(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#_();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,cn(this.div,{rotation:i}),e!==i)for(const n of this.#n.values())n.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class Se{#t=null;#e=new Map;#s=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Tt(this,"_svgFactory",new Fo)}static#a(t,[e,i,n,a]){const{style:o}=t;o.top=`${100*i}%`,o.left=`${100*e}%`,o.width=`${100*n}%`,o.height=`${100*a}%`}#n(){const t=Se._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const i=Se._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const a=Se._svgFactory.createElement("use");return i.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),n}#o(t,e){for(const[i,n]of Object.entries(e))n===null?t.removeAttribute(i):t.setAttribute(i,n)}draw(t,e=!1,i=!1){const n=Se.#i++,a=this.#n(),o=Se._svgFactory.createElement("defs");a.append(o);const u=Se._svgFactory.createElement("path");o.append(u);const d=`path_p${this.pageIndex}_${n}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#s.set(n,u);const f=i?this.#r(o,d):null,p=Se._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(a,t),this.#e.set(n,a),{id:n,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=Se.#i++,n=this.#n(),a=Se._svgFactory.createElement("defs");n.append(a);const o=Se._svgFactory.createElement("path");a.append(o);const u=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",u),o.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const g=Se._svgFactory.createElement("mask");a.append(g),d=`mask_p${this.pageIndex}_${i}`,g.setAttribute("id",d),g.setAttribute("maskUnits","objectBoundingBox");const v=Se._svgFactory.createElement("rect");g.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const b=Se._svgFactory.createElement("use");g.append(b),b.setAttribute("href",`#${u}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const f=Se._svgFactory.createElement("use");n.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const p=f.cloneNode();return n.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(n,t),this.#e.set(i,n),i}finalizeDraw(t,e){this.#s.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:n,rootClass:a,path:o}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#o(u,i),n&&Se.#a(u,n),a){const{classList:d}=u;for(const[f,p]of Object.entries(a))d.toggle(f,p)}if(o){const f=u.firstChild.firstChild;this.#o(f,o)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#s.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#s.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Mf};globalThis.pdfjsLib={AbortException:Es,AnnotationEditorLayer:Wi,AnnotationEditorParamsType:kt,AnnotationEditorType:wt,AnnotationEditorUIManager:Ts,AnnotationLayer:bu,AnnotationMode:ws,AnnotationType:ce,applyOpacity:V0,build:f_,ColorPicker:ci,createValidAbsoluteUrl:sp,CSSConstants:q0,DOMSVGFactory:Fo,DrawLayer:Se,FeatureTest:Ae,fetchData:da,findContrastColor:G0,getDocument:c_,getFilenameFromUrl:z0,getPdfFilenameFromUrl:H0,getRGB:fa,getUuid:rp,getXfaPageViewport:$0,GlobalWorkerOptions:qn,ImageKind:xo,InvalidPDFException:Zc,isDataScheme:Yo,isPdfFile:yu,isValidExplicitDest:W0,MathClamp:Pe,noContextMenu:fi,normalizeUnicode:U0,OPS:oa,OutputScale:Ui,PasswordResponses:I0,PDFDataRangeTransport:mp,PDFDateString:tu,PDFWorker:la,PermissionFlag:B0,PixelsPerInch:Gn,RenderingCancelledException:mu,renderRichText:lp,ResponseException:Io,setLayerDimensions:cn,shadow:Tt,SignatureExtractor:Ln,stopEvent:se,SupportedImageMimeTypes:eu,TextLayer:Le,TouchManager:Ko,updateUrlHash:np,Util:tt,VerbosityLevel:qo,version:d_,XfaLayer:op};const fO=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Es,AnnotationEditorLayer:Wi,AnnotationEditorParamsType:kt,AnnotationEditorType:wt,AnnotationEditorUIManager:Ts,AnnotationLayer:bu,AnnotationMode:ws,AnnotationType:ce,CSSConstants:q0,ColorPicker:ci,DOMSVGFactory:Fo,DrawLayer:Se,FeatureTest:Ae,GlobalWorkerOptions:qn,ImageKind:xo,InvalidPDFException:Zc,MathClamp:Pe,OPS:oa,OutputScale:Ui,PDFDataRangeTransport:mp,PDFDateString:tu,PDFWorker:la,PasswordResponses:I0,PermissionFlag:B0,PixelsPerInch:Gn,RenderingCancelledException:mu,ResponseException:Io,SignatureExtractor:Ln,SupportedImageMimeTypes:eu,TextLayer:Le,TouchManager:Ko,Util:tt,VerbosityLevel:qo,XfaLayer:op,applyOpacity:V0,build:f_,createValidAbsoluteUrl:sp,fetchData:da,findContrastColor:G0,getDocument:c_,getFilenameFromUrl:z0,getPdfFilenameFromUrl:H0,getRGB:fa,getUuid:rp,getXfaPageViewport:$0,isDataScheme:Yo,isPdfFile:yu,isValidExplicitDest:W0,noContextMenu:fi,normalizeUnicode:U0,renderRichText:lp,setLayerDimensions:cn,shadow:Tt,stopEvent:se,updateUrlHash:np,version:d_},Symbol.toStringTag,{value:"Module"})),TC=()=>Cs(()=>import("./host-Be33yNiH.js"),__vite__mapDeps([0,1]));qn.workerSrc=new URL("/me/assets/pdf.worker.min-qwK7q_zL.mjs",import.meta.url).toString();const CC=No("/host")({component:ip(TC,"component")}),RC=()=>Cs(()=>import("./audience-DU3g1Np7.js"),__vite__mapDeps([2,1])),xC=No("/audience")({component:ip(RC,"component")}),OC=()=>Cs(()=>import("./index-BsnAhzGm.js"),[]),MC=No("/")({component:ip(OC,"component")}),kC=CC.update({id:"/host",path:"/host",getParentRoute:()=>fu}),DC=xC.update({id:"/audience",path:"/audience",getParentRoute:()=>fu}),LC=MC.update({id:"/",path:"/",getParentRoute:()=>fu}),PC={IndexRoute:LC,AudienceRoute:DC,HostRoute:kC},NC=fu._addFileChildren(PC)._addFileTypes(),w_=dt.createContext(void 0);function BC(l){const t=N0.c(5),{children:e}=l,[i,n]=dt.useState(null);let a;t[0]!==i?(a={user:i,setUser:n},t[0]=i,t[1]=a):a=t[1];let o;return t[2]!==e||t[3]!==a?(o=st.jsx(w_.Provider,{value:a,children:e}),t[2]=e,t[3]=a,t[4]=o):o=t[4],o}function pO(){const l=dt.useContext(w_);if(!l)throw new Error("useUser must be used within a UserProvider");return l}var Lf=function(l,t){return Lf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])},Lf(l,t)};function S_(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Lf(l,t);function e(){this.constructor=l}l.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var su=function(){return su=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},su.apply(this,arguments)};function pa(l,t){var e={};for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&t.indexOf(i)<0&&(e[i]=l[i]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(l);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(l,i[n])&&(e[i[n]]=l[i[n]]);return e}function A_(l,t,e,i){var n=arguments.length,a=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(l,t,e,i);else for(var u=l.length-1;u>=0;u--)(o=l[u])&&(a=(n<3?o(a):n>3?o(t,e,a):o(t,e))||a);return n>3&&a&&Object.defineProperty(t,e,a),a}function E_(l,t){return function(e,i){t(e,i,l)}}function T_(l,t,e,i,n,a){function o(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var u=i.kind,d=u==="getter"?"get":u==="setter"?"set":"value",f=!t&&l?i.static?l:l.prototype:null,p=t||(f?Object.getOwnPropertyDescriptor(f,i.name):{}),g,v=!1,b=e.length-1;b>=0;b--){var w={};for(var _ in i)w[_]=_==="access"?{}:i[_];for(var _ in i.access)w.access[_]=i.access[_];w.addInitializer=function(E){if(v)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(E||null))};var A=(0,e[b])(u==="accessor"?{get:p.get,set:p.set}:p[d],w);if(u==="accessor"){if(A===void 0)continue;if(A===null||typeof A!="object")throw new TypeError("Object expected");(g=o(A.get))&&(p.get=g),(g=o(A.set))&&(p.set=g),(g=o(A.init))&&n.unshift(g)}else(g=o(A))&&(u==="field"?n.unshift(g):p[d]=g)}f&&Object.defineProperty(f,i.name,p),v=!0}function C_(l,t,e){for(var i=arguments.length>2,n=0;n<t.length;n++)e=i?t[n].call(l,e):t[n].call(l);return i?e:void 0}function R_(l){return typeof l=="symbol"?l:"".concat(l)}function x_(l,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(l,"name",{configurable:!0,value:e?"".concat(e," ",t):t})}function O_(l,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,t)}function rt(l,t,e,i){function n(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function u(p){try{f(i.next(p))}catch(g){o(g)}}function d(p){try{f(i.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):n(p.value).then(u,d)}f((i=i.apply(l,t||[])).next())})}function M_(l,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=u(0),o.throw=u(1),o.return=u(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(f){return function(p){return d([f,p])}}function d(f){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,f[0]&&(e=0)),e;)try{if(i=1,n&&(a=f[0]&2?n.return:f[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,f[1])).done)return a;switch(n=0,a&&(f=[f[0]&2,a.value]),f[0]){case 0:case 1:a=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,n=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){e.label=f[1];break}if(f[0]===6&&e.label<a[1]){e.label=a[1],a=f;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(f);break}a[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(l,e)}catch(p){f=[6,p],n=0}finally{i=a=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var wu=Object.create?(function(l,t,e,i){i===void 0&&(i=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(l,i,n)}):(function(l,t,e,i){i===void 0&&(i=e),l[i]=t[e]});function k_(l,t){for(var e in l)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&wu(t,l,e)}function nu(l){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&l[t],i=0;if(e)return e.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&i>=l.length&&(l=void 0),{value:l&&l[i++],done:!l}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sp(l,t){var e=typeof Symbol=="function"&&l[Symbol.iterator];if(!e)return l;var i=e.call(l),n,a=[],o;try{for(;(t===void 0||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a}function D_(){for(var l=[],t=0;t<arguments.length;t++)l=l.concat(Sp(arguments[t]));return l}function L_(){for(var l=0,t=0,e=arguments.length;t<e;t++)l+=arguments[t].length;for(var i=Array(l),n=0,t=0;t<e;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,n++)i[n]=a[o];return i}function P_(l,t,e){if(e||arguments.length===2)for(var i=0,n=t.length,a;i<n;i++)(a||!(i in t))&&(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return l.concat(a||Array.prototype.slice.call(t))}function ca(l){return this instanceof ca?(this.v=l,this):new ca(l)}function N_(l,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(l,t||[]),n,a=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(b){return function(w){return Promise.resolve(w).then(b,g)}}function u(b,w){i[b]&&(n[b]=function(_){return new Promise(function(A,E){a.push([b,_,A,E])>1||d(b,_)})},w&&(n[b]=w(n[b])))}function d(b,w){try{f(i[b](w))}catch(_){v(a[0][3],_)}}function f(b){b.value instanceof ca?Promise.resolve(b.value.v).then(p,g):v(a[0][2],b)}function p(b){d("next",b)}function g(b){d("throw",b)}function v(b,w){b(w),a.shift(),a.length&&d(a[0][0],a[0][1])}}function B_(l){var t,e;return t={},i("next"),i("throw",function(n){throw n}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(n,a){t[n]=l[n]?function(o){return(e=!e)?{value:ca(l[n](o)),done:!1}:a?a(o):o}:a}}function I_(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=l[Symbol.asyncIterator],e;return t?t.call(l):(l=typeof nu=="function"?nu(l):l[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(a){e[a]=l[a]&&function(o){return new Promise(function(u,d){o=l[a](o),n(u,d,o.done,o.value)})}}function n(a,o,u,d){Promise.resolve(d).then(function(f){a({value:f,done:u})},o)}}function j_(l,t){return Object.defineProperty?Object.defineProperty(l,"raw",{value:t}):l.raw=t,l}var IC=Object.create?(function(l,t){Object.defineProperty(l,"default",{enumerable:!0,value:t})}):function(l,t){l.default=t},Pf=function(l){return Pf=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},Pf(l)};function U_(l){if(l&&l.__esModule)return l;var t={};if(l!=null)for(var e=Pf(l),i=0;i<e.length;i++)e[i]!=="default"&&wu(t,l,e[i]);return IC(t,l),t}function F_(l){return l&&l.__esModule?l:{default:l}}function z_(l,t,e,i){if(e==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?l!==t||!i:!t.has(l))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(l):i?i.value:t.get(l)}function H_(l,t,e,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?l!==t||!n:!t.has(l))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(l,e):n?n.value=e:t.set(l,e),e}function $_(l,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof l=="function"?t===l:l.has(t)}function q_(l,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var i,n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],e&&(n=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");n&&(i=function(){try{n.call(this)}catch(a){return Promise.reject(a)}}),l.stack.push({value:t,dispose:i,async:e})}else e&&l.stack.push({async:!0});return t}var jC=typeof SuppressedError=="function"?SuppressedError:function(l,t,e){var i=new Error(e);return i.name="SuppressedError",i.error=l,i.suppressed=t,i};function V_(l){function t(a){l.error=l.hasError?new jC(a,l.error,"An error was suppressed during disposal."):a,l.hasError=!0}var e,i=0;function n(){for(;e=l.stack.pop();)try{if(!e.async&&i===1)return i=0,l.stack.push(e),Promise.resolve().then(n);if(e.dispose){var a=e.dispose.call(e.value);if(e.async)return i|=2,Promise.resolve(a).then(n,function(o){return t(o),n()})}else i|=1}catch(o){t(o)}if(i===1)return l.hasError?Promise.reject(l.error):Promise.resolve();if(l.hasError)throw l.error}return n()}function G_(l,t){return typeof l=="string"&&/^\.\.?\//.test(l)?l.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,i,n,a,o){return i?t?".jsx":".js":n&&(!a||!o)?e:n+a+"."+o.toLowerCase()+"js"}):l}const UC={__extends:S_,__assign:su,__rest:pa,__decorate:A_,__param:E_,__esDecorate:T_,__runInitializers:C_,__propKey:R_,__setFunctionName:x_,__metadata:O_,__awaiter:rt,__generator:M_,__createBinding:wu,__exportStar:k_,__values:nu,__read:Sp,__spread:D_,__spreadArrays:L_,__spreadArray:P_,__await:ca,__asyncGenerator:N_,__asyncDelegator:B_,__asyncValues:I_,__makeTemplateObject:j_,__importStar:U_,__importDefault:F_,__classPrivateFieldGet:z_,__classPrivateFieldSet:H_,__classPrivateFieldIn:$_,__addDisposableResource:q_,__disposeResources:V_,__rewriteRelativeImportExtension:G_},FC=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:q_,get __assign(){return su},__asyncDelegator:B_,__asyncGenerator:N_,__asyncValues:I_,__await:ca,__awaiter:rt,__classPrivateFieldGet:z_,__classPrivateFieldIn:$_,__classPrivateFieldSet:H_,__createBinding:wu,__decorate:A_,__disposeResources:V_,__esDecorate:T_,__exportStar:k_,__extends:S_,__generator:M_,__importDefault:F_,__importStar:U_,__makeTemplateObject:j_,__metadata:O_,__param:E_,__propKey:R_,__read:Sp,__rest:pa,__rewriteRelativeImportExtension:G_,__runInitializers:C_,__setFunctionName:x_,__spread:D_,__spreadArray:P_,__spreadArrays:L_,__values:nu,default:UC},Symbol.toStringTag,{value:"Module"})),zC=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...e)=>Cs(async()=>{const{default:i}=await Promise.resolve().then(()=>Wn);return{default:i}},void 0).then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)};class Ap extends Error{constructor(t,e="FunctionsError",i){super(t),this.name=e,this.context=i}}class Ib extends Ap{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class jb extends Ap{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ub extends Ap{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Nf;(function(l){l.Any="any",l.ApNortheast1="ap-northeast-1",l.ApNortheast2="ap-northeast-2",l.ApSouth1="ap-south-1",l.ApSoutheast1="ap-southeast-1",l.ApSoutheast2="ap-southeast-2",l.CaCentral1="ca-central-1",l.EuCentral1="eu-central-1",l.EuWest1="eu-west-1",l.EuWest2="eu-west-2",l.EuWest3="eu-west-3",l.SaEast1="sa-east-1",l.UsEast1="us-east-1",l.UsWest1="us-west-1",l.UsWest2="us-west-2"})(Nf||(Nf={}));class HC{constructor(t,{headers:e={},customFetch:i,region:n=Nf.Any}={}){this.url=t,this.headers=e,this.region=n,this.fetch=zC(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return rt(this,arguments,void 0,function*(e,i={}){var n;try{const{headers:a,method:o,body:u,signal:d}=i;let f={},{region:p}=i;p||(p=this.region);const g=new URL(`${this.url}/${e}`);p&&p!=="any"&&(f["x-region"]=p,g.searchParams.set("forceFunctionRegion",p));let v;u&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",v=u):typeof u=="string"?(f["Content-Type"]="text/plain",v=u):typeof FormData<"u"&&u instanceof FormData?v=u:(f["Content-Type"]="application/json",v=JSON.stringify(u)):v=u;const b=yield this.fetch(g.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:v,signal:d}).catch(E=>{throw E.name==="AbortError"?E:new Ib(E)}),w=b.headers.get("x-relay-error");if(w&&w==="true")throw new jb(b);if(!b.ok)throw new Ub(b);let _=((n=b.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),A;return _==="application/json"?A=yield b.json():_==="application/octet-stream"||_==="application/pdf"?A=yield b.blob():_==="text/event-stream"?A=b:_==="multipart/form-data"?A=yield b.formData():A=yield b.text(),{data:A,error:null,response:b}}catch(a){return a instanceof Error&&a.name==="AbortError"?{data:null,error:new Ib(a)}:{data:null,error:a,response:a instanceof Ub||a instanceof jb?a.context:void 0}}})}}var De={};const ga=d0(FC);var Lc={},Pc={},Nc={},Bc={},Ic={},$C=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ua=$C();const qC=ua.fetch,Y_=ua.fetch.bind(ua),X_=ua.Headers,VC=ua.Request,GC=ua.Response,Wn=Object.freeze(Object.defineProperty({__proto__:null,Headers:X_,Request:VC,Response:GC,default:Y_,fetch:qC},Symbol.toStringTag,{value:"Module"})),YC=d0(Wn);var jc={},Fb;function K_(){if(Fb)return jc;Fb=1,Object.defineProperty(jc,"__esModule",{value:!0});class l extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return jc.default=l,jc}var zb;function W_(){if(zb)return Ic;zb=1,Object.defineProperty(Ic,"__esModule",{value:!0});const l=ga,t=l.__importDefault(YC),e=l.__importDefault(K_());class i{constructor(a){var o,u;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(o=a.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=a.signal,this.isMaybeSingle=(u=a.isMaybeSingle)!==null&&u!==void 0?u:!1,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,o){return this.headers=new Headers(this.headers),this.headers.set(a,o),this}then(a,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let d=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var p,g,v,b;let w=null,_=null,A=null,E=f.status,R=f.statusText;if(f.ok){if(this.method!=="HEAD"){const M=await f.text();M===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?_=M:_=JSON.parse(M))}const x=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),D=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");x&&D&&D.length>1&&(A=parseInt(D[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(w={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,A=null,E=406,R="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const x=await f.text();try{w=JSON.parse(x),Array.isArray(w)&&f.status===404&&(_=[],w=null,E=200,R="OK")}catch{f.status===404&&x===""?(E=204,R="No Content"):w={message:x}}if(w&&this.isMaybeSingle&&(!((b=w?.details)===null||b===void 0)&&b.includes("0 rows"))&&(w=null,E=200,R="OK"),w&&this.shouldThrowOnError)throw new e.default(w)}return{error:w,data:_,count:A,status:E,statusText:R}});return this.shouldThrowOnError||(d=d.catch(f=>{var p,g,v;return{error:{message:`${(p=f?.name)!==null&&p!==void 0?p:"FetchError"}: ${f?.message}`,details:`${(g=f?.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(v=f?.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,o)}returns(){return this}overrideTypes(){return this}}return Ic.default=i,Ic}var Hb;function Q_(){if(Hb)return Bc;Hb=1,Object.defineProperty(Bc,"__esModule",{value:!0});const t=ga.__importDefault(W_());class e extends t.default{select(n){let a=!1;const o=(n??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:a=!0,nullsFirst:o,foreignTable:u,referencedTable:d=u}={}){const f=d?`${d}.order`:"order",p=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${p?`${p},`:""}${n}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:o=a}={}){const u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(u,`${n}`),this}range(n,a,{foreignTable:o,referencedTable:u=o}={}){const d=typeof u>"u"?"offset":`${u}.offset`,f=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(d,`${n}`),this.url.searchParams.set(f,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:a=!1,settings:o=!1,buffers:u=!1,wal:d=!1,format:f="text"}={}){var p;const g=[n?"analyze":null,a?"verbose":null,o?"settings":null,u?"buffers":null,d?"wal":null].filter(Boolean).join("|"),v=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${v}"; options=${g};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return Bc.default=e,Bc}var $b;function Ep(){if($b)return Nc;$b=1,Object.defineProperty(Nc,"__esModule",{value:!0});const t=ga.__importDefault(Q_());class e extends t.default{eq(n,a){return this.url.searchParams.append(n,`eq.${a}`),this}neq(n,a){return this.url.searchParams.append(n,`neq.${a}`),this}gt(n,a){return this.url.searchParams.append(n,`gt.${a}`),this}gte(n,a){return this.url.searchParams.append(n,`gte.${a}`),this}lt(n,a){return this.url.searchParams.append(n,`lt.${a}`),this}lte(n,a){return this.url.searchParams.append(n,`lte.${a}`),this}like(n,a){return this.url.searchParams.append(n,`like.${a}`),this}likeAllOf(n,a){return this.url.searchParams.append(n,`like(all).{${a.join(",")}}`),this}likeAnyOf(n,a){return this.url.searchParams.append(n,`like(any).{${a.join(",")}}`),this}ilike(n,a){return this.url.searchParams.append(n,`ilike.${a}`),this}ilikeAllOf(n,a){return this.url.searchParams.append(n,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(n,a){return this.url.searchParams.append(n,`ilike(any).{${a.join(",")}}`),this}is(n,a){return this.url.searchParams.append(n,`is.${a}`),this}in(n,a){const o=Array.from(new Set(a)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cs.{${a.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(a)}`),this}containedBy(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cd.{${a.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(a)}`),this}rangeGt(n,a){return this.url.searchParams.append(n,`sr.${a}`),this}rangeGte(n,a){return this.url.searchParams.append(n,`nxl.${a}`),this}rangeLt(n,a){return this.url.searchParams.append(n,`sl.${a}`),this}rangeLte(n,a){return this.url.searchParams.append(n,`nxr.${a}`),this}rangeAdjacent(n,a){return this.url.searchParams.append(n,`adj.${a}`),this}overlaps(n,a){return typeof a=="string"?this.url.searchParams.append(n,`ov.${a}`):this.url.searchParams.append(n,`ov.{${a.join(",")}}`),this}textSearch(n,a,{config:o,type:u}={}){let d="";u==="plain"?d="pl":u==="phrase"?d="ph":u==="websearch"&&(d="w");const f=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${d}fts${f}.${a}`),this}match(n){return Object.entries(n).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(n,a,o){return this.url.searchParams.append(n,`not.${a}.${o}`),this}or(n,{foreignTable:a,referencedTable:o=a}={}){const u=o?`${o}.or`:"or";return this.url.searchParams.append(u,`(${n})`),this}filter(n,a,o){return this.url.searchParams.append(n,`${a}.${o}`),this}}return Nc.default=e,Nc}var qb;function J_(){if(qb)return Pc;qb=1,Object.defineProperty(Pc,"__esModule",{value:!0});const t=ga.__importDefault(Ep());class e{constructor(n,{headers:a={},schema:o,fetch:u}){this.url=n,this.headers=new Headers(a),this.schema=o,this.fetch=u}select(n,a){const{head:o=!1,count:u}=a??{},d=o?"HEAD":"GET";let f=!1;const p=(n??"*").split("").map(g=>/\s/.test(g)&&!f?"":(g==='"'&&(f=!f),g)).join("");return this.url.searchParams.set("select",p),u&&this.headers.append("Prefer",`count=${u}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:a,defaultToNull:o=!0}={}){var u;const d="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(n,{onConflict:a,ignoreDuplicates:o=!1,count:u,defaultToNull:d=!0}={}){var f;const p="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),u&&this.headers.append("Prefer",`count=${u}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const g=n.reduce((v,b)=>v.concat(Object.keys(b)),[]);if(g.length>0){const v=[...new Set(g)].map(b=>`"${b}"`);this.url.searchParams.set("columns",v.join(","))}}return new t.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(n,{count:a}={}){var o;const u="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:n}={}){var a;const o="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Pc.default=e,Pc}var Vb;function XC(){if(Vb)return Lc;Vb=1,Object.defineProperty(Lc,"__esModule",{value:!0});const l=ga,t=l.__importDefault(J_()),e=l.__importDefault(Ep());class i{constructor(a,{headers:o={},schema:u,fetch:d}={}){this.url=a,this.headers=new Headers(o),this.schemaName=u,this.fetch=d}from(a){const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new i(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:u=!1,get:d=!1,count:f}={}){var p;let g;const v=new URL(`${this.url}/rpc/${a}`);let b;u||d?(g=u?"HEAD":"GET",Object.entries(o).filter(([_,A])=>A!==void 0).map(([_,A])=>[_,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([_,A])=>{v.searchParams.append(_,A)})):(g="POST",b=o);const w=new Headers(this.headers);return f&&w.set("Prefer",`count=${f}`),new e.default({method:g,url:v,headers:w,schema:this.schemaName,body:b,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return Lc.default=i,Lc}var Gb;function KC(){if(Gb)return De;Gb=1,Object.defineProperty(De,"__esModule",{value:!0}),De.PostgrestError=De.PostgrestBuilder=De.PostgrestTransformBuilder=De.PostgrestFilterBuilder=De.PostgrestQueryBuilder=De.PostgrestClient=void 0;const l=ga,t=l.__importDefault(XC());De.PostgrestClient=t.default;const e=l.__importDefault(J_());De.PostgrestQueryBuilder=e.default;const i=l.__importDefault(Ep());De.PostgrestFilterBuilder=i.default;const n=l.__importDefault(Q_());De.PostgrestTransformBuilder=n.default;const a=l.__importDefault(W_());De.PostgrestBuilder=a.default;const o=l.__importDefault(K_());return De.PostgrestError=o.default,De.default={PostgrestClient:t.default,PostgrestQueryBuilder:e.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:a.default,PostgrestError:o.default},De}var WC=KC();const QC=Gf(WC),{PostgrestClient:JC,PostgrestQueryBuilder:gO,PostgrestFilterBuilder:mO,PostgrestTransformBuilder:yO,PostgrestBuilder:vO,PostgrestError:bO}=QC;class ZC{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const i=e.node,n=parseInt(i.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),new Error(e)}static createWebSocket(t,e){const i=this.getWebSocketConstructor();return new i(t,e)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const tR="2.76.1",eR=`realtime-js/${tR}`,iR="1.0.0",Bf=1e4,sR=1e3,nR=100;var Mo;(function(l){l[l.connecting=0]="connecting",l[l.open=1]="open",l[l.closing=2]="closing",l[l.closed=3]="closed"})(Mo||(Mo={}));var ve;(function(l){l.closed="closed",l.errored="errored",l.joined="joined",l.joining="joining",l.leaving="leaving"})(ve||(ve={}));var Ii;(function(l){l.close="phx_close",l.error="phx_error",l.join="phx_join",l.reply="phx_reply",l.leave="phx_leave",l.access_token="access_token"})(Ii||(Ii={}));var If;(function(l){l.websocket="websocket"})(If||(If={}));var Pn;(function(l){l.Connecting="connecting",l.Open="open",l.Closing="closing",l.Closed="closed"})(Pn||(Pn={}));class rR{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,e,i)}_decodeBroadcast(t,e,i){const n=e.getUint8(1),a=e.getUint8(2);let o=this.HEADER_LENGTH+2;const u=i.decode(t.slice(o,o+n));o=o+n;const d=i.decode(t.slice(o,o+a));o=o+a;const f=JSON.parse(i.decode(t.slice(o,t.byteLength)));return{ref:null,topic:u,event:d,payload:f}}}class Z_{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Kt;(function(l){l.abstime="abstime",l.bool="bool",l.date="date",l.daterange="daterange",l.float4="float4",l.float8="float8",l.int2="int2",l.int4="int4",l.int4range="int4range",l.int8="int8",l.int8range="int8range",l.json="json",l.jsonb="jsonb",l.money="money",l.numeric="numeric",l.oid="oid",l.reltime="reltime",l.text="text",l.time="time",l.timestamp="timestamp",l.timestamptz="timestamptz",l.timetz="timetz",l.tsrange="tsrange",l.tstzrange="tstzrange"})(Kt||(Kt={}));const Yb=(l,t,e={})=>{var i;const n=(i=e.skipTypes)!==null&&i!==void 0?i:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=aR(o,l,t,n),a),{}):{}},aR=(l,t,e,i)=>{const n=t.find(u=>u.name===l),a=n?.type,o=e[l];return a&&!i.includes(a)?tw(a,o):jf(o)},tw=(l,t)=>{if(l.charAt(0)==="_"){const e=l.slice(1,l.length);return uR(t,e)}switch(l){case Kt.bool:return oR(t);case Kt.float4:case Kt.float8:case Kt.int2:case Kt.int4:case Kt.int8:case Kt.numeric:case Kt.oid:return lR(t);case Kt.json:case Kt.jsonb:return cR(t);case Kt.timestamp:return hR(t);case Kt.abstime:case Kt.date:case Kt.daterange:case Kt.int4range:case Kt.int8range:case Kt.money:case Kt.reltime:case Kt.text:case Kt.time:case Kt.timestamptz:case Kt.timetz:case Kt.tsrange:case Kt.tstzrange:return jf(t);default:return jf(t)}},jf=l=>l,oR=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},lR=l=>{if(typeof l=="string"){const t=parseFloat(l);if(!Number.isNaN(t))return t}return l},cR=l=>{if(typeof l=="string")try{return JSON.parse(l)}catch(t){return console.log(`JSON parse error: ${t}`),l}return l},uR=(l,t)=>{if(typeof l!="string")return l;const e=l.length-1,i=l[e];if(l[0]==="{"&&i==="}"){let a;const o=l.slice(1,e);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(u=>tw(t,u))}return l},hR=l=>typeof l=="string"?l.replace(" ","T"):l,ew=l=>{const t=new URL(l);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class cf{constructor(t,e,i={},n=Bf){this.channel=t,this.event=e,this.payload=i,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var i;return this._hasReceived(t)&&e((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Xb;(function(l){l.SYNC="sync",l.JOIN="join",l.LEAVE="leave"})(Xb||(Xb={}));class ko{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},n=>{const{onJoin:a,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ko.syncState(this.state,n,a,o),this.pendingDiffs.forEach(d=>{this.state=ko.syncDiff(this.state,d,a,o)}),this.pendingDiffs=[],u()}),this.channel._on(i.diff,{},n=>{const{onJoin:a,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ko.syncDiff(this.state,n,a,o),u())}),this.onJoin((n,a,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:o})}),this.onLeave((n,a,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,i,n){const a=this.cloneDeep(t),o=this.transformState(e),u={},d={};return this.map(a,(f,p)=>{o[f]||(d[f]=p)}),this.map(o,(f,p)=>{const g=a[f];if(g){const v=p.map(A=>A.presence_ref),b=g.map(A=>A.presence_ref),w=p.filter(A=>b.indexOf(A.presence_ref)<0),_=g.filter(A=>v.indexOf(A.presence_ref)<0);w.length>0&&(u[f]=w),_.length>0&&(d[f]=_)}else u[f]=p}),this.syncDiff(a,{joins:u,leaves:d},i,n)}static syncDiff(t,e,i,n){const{joins:a,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return i||(i=()=>{}),n||(n=()=>{}),this.map(a,(u,d)=>{var f;const p=(f=t[u])!==null&&f!==void 0?f:[];if(t[u]=this.cloneDeep(d),p.length>0){const g=t[u].map(b=>b.presence_ref),v=p.filter(b=>g.indexOf(b.presence_ref)<0);t[u].unshift(...v)}i(u,p,d)}),this.map(o,(u,d)=>{let f=t[u];if(!f)return;const p=d.map(g=>g.presence_ref);f=f.filter(g=>p.indexOf(g.presence_ref)<0),t[u]=f,n(u,f,d),f.length===0&&delete t[u]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(i=>e(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,i)=>{const n=t[i];return"metas"in n?e[i]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):e[i]=n,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Kb;(function(l){l.ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE"})(Kb||(Kb={}));var Do;(function(l){l.BROADCAST="broadcast",l.PRESENCE="presence",l.POSTGRES_CHANGES="postgres_changes",l.SYSTEM="system"})(Do||(Do={}));var bs;(function(l){l.SUBSCRIBED="SUBSCRIBED",l.TIMED_OUT="TIMED_OUT",l.CLOSED="CLOSED",l.CHANNEL_ERROR="CHANNEL_ERROR"})(bs||(bs={}));class Tp{constructor(t,e={config:{}},i){var n,a;if(this.topic=t,this.params=e,this.socket=i,this.bindings={},this.state=ve.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new cf(this,Ii.join,this.params,this.timeout),this.rejoinTimer=new Z_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ve.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ve.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ve.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ve.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ve.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ii.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new ko(this),this.broadcastEndpointURL=ew(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var i,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ve.closed){const{config:{broadcast:o,presence:u,private:d}}=this.params,f=(n=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(b=>b.filter))!==null&&n!==void 0?n:[],p=!!this.bindings[Do.PRESENCE]&&this.bindings[Do.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,g={},v={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(b=>t?.(bs.CHANNEL_ERROR,b)),this._onClose(()=>t?.(bs.CLOSED)),this.updateJoinPayload(Object.assign({config:v},g)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){t?.(bs.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,A=(w=_?.length)!==null&&w!==void 0?w:0,E=[];for(let R=0;R<A;R++){const C=_[R],{filter:{event:x,schema:D,table:M,filter:k}}=C,I=b&&b[R];if(I&&I.event===x&&I.schema===D&&I.table===M&&I.filter===k)E.push(Object.assign(Object.assign({},C),{id:I.id}));else{this.unsubscribe(),this.state=ve.errored,t?.(bs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,t&&t(bs.SUBSCRIBED);return}}).receive("error",b=>{this.state=ve.errored,t?.(bs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t?.(bs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,i){return this.state===ve.joined&&t===Do.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,e,i)}async httpSend(t,e,i={}){var n;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(e==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=i.timeout)!==null&&n!==void 0?n:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const f=await u.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(t,e={}){var i,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(i=e.timeout)!==null&&i!==void 0?i:this.timeout);return await((n=f.body)===null||n===void 0?void 0:n.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,u,d;const f=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ve.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ii.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(n=>{i=new cf(this,Ii.leave,{},t),i.receive("ok",()=>{e(),n("ok")}).receive("timeout",()=>{e(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ve.closed,this.bindings={}}async _fetchWithTimeout(t,e,i){const n=new AbortController,a=setTimeout(()=>n.abort(),i),o=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:n.signal}));return clearTimeout(a),o}_push(t,e,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new cf(this,t,e,i);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>nR){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(t,e,i){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,i){var n,a;const o=t.toLocaleLowerCase(),{close:u,error:d,leave:f,join:p}=Ii;if(i&&[u,d,f,p].indexOf(o)>=0&&i!==this._joinRef())return;let v=this._onMessage(o,e,i);if(e&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(b=>{var w,_,A;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((A=(_=b.filter)===null||_===void 0?void 0:_.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===o}).map(b=>b.callback(v,i)):(a=this.bindings[o])===null||a===void 0||a.filter(b=>{var w,_,A,E,R,C;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in b){const x=b.id,D=(w=b.filter)===null||w===void 0?void 0:w.event;return x&&((_=e.ids)===null||_===void 0?void 0:_.includes(x))&&(D==="*"||D?.toLocaleLowerCase()===((A=e.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const x=(R=(E=b?.filter)===null||E===void 0?void 0:E.event)===null||R===void 0?void 0:R.toLocaleLowerCase();return x==="*"||x===((C=e?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===o}).map(b=>{if(typeof v=="object"&&"ids"in v){const w=v.data,{schema:_,table:A,commit_timestamp:E,type:R,errors:C}=w;v=Object.assign(Object.assign({},{schema:_,table:A,commit_timestamp:E,eventType:R,new:{},old:{},errors:C}),this._getPayloadRecords(w))}b.callback(v,i)})}_isClosed(){return this.state===ve.closed}_isJoined(){return this.state===ve.joined}_isJoining(){return this.state===ve.joining}_isLeaving(){return this.state===ve.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,i){const n=t.toLocaleLowerCase(),a={type:n,filter:e,callback:i};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(t,e){const i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===i&&Tp.isEqual(n.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(t[i]!==e[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ii.close,{},t)}_onError(t){this._on(Ii.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ve.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Yb(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Yb(t.columns,t.old_record)),e}}const uf=()=>{},Uc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},dR=[1e3,2e3,5e3,1e4],fR=1e4,pR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gR{constructor(t,e){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bf,this.transport=null,this.heartbeatIntervalMs=Uc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=uf,this.ref=0,this.reconnectTimer=null,this.logger=uf,this.conn=null,this.sendBuffer=[],this.serializer=new rR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let a;return n?a=n:typeof fetch>"u"?a=(...o)=>Cs(async()=>{const{default:u}=await Promise.resolve().then(()=>Wn);return{default:u}},void 0).then(({default:u})=>u(...o)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((i=e?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${If.websocket}`,this.httpEndpoint=ew(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ZC.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const e=t.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:iR}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},t?this.conn.close(t,e??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,e,i){this.logger(t,e,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Mo.connecting:return Pn.Connecting;case Mo.open:return Pn.Open;case Mo.closing:return Pn.Closing;default:return Pn.Closed}}isConnected(){return this.connectionState()===Pn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,e={config:{}}){const i=`realtime:${t}`,n=this.getChannels().find(a=>a.topic===i);if(n)return n;{const a=new Tp(`realtime:${t}`,e,this);return this.channels.push(a),a}}push(t){const{topic:e,event:i,payload:n,ref:a}=t,o=()=>{this.encode(t,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${e} ${i} (${a})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(sR,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},Uc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:n,payload:a,ref:o}=e,u=o?`(${o})`:"",d=a.status||"";this.log("receive",`${d} ${i} ${n} ${u}`.trim(),a),this.channels.filter(f=>f._isMember(i)).forEach(f=>f._trigger(n,a,o)),this._triggerStateCallbacks("message",e)})}_clearTimer(t){var e;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ii.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const i=t.match(/\?/)?"&":"?",n=new URLSearchParams(e);return`${t}${i}${n}`}_workerObjectUrl(t){let e;if(t)e=t;else{const i=new Blob([pR],{type:"application/javascript"});e=URL.createObjectURL(i)}return e}_setConnectionState(t,e=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(t=null){let e;t?e=t:this.accessToken?e=await this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(i=>{const n={access_token:e,version:eR};e&&i.updateJoinPayload(n),i.joinedOnce&&i._isJoined()&&i._push(Ii.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(e)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(i){this.log("error",`error triggering ${t} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Z_(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Uc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var e,i,n,a,o,u,d,f,p;if(this.transport=(e=t?.transport)!==null&&e!==void 0?e:null,this.timeout=(i=t?.timeout)!==null&&i!==void 0?i:Bf,this.heartbeatIntervalMs=(n=t?.heartbeatIntervalMs)!==null&&n!==void 0?n:Uc.HEARTBEAT_INTERVAL,this.worker=(a=t?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:uf,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(g=>dR[g-1]||fR),this.encode=(f=t?.encode)!==null&&f!==void 0?f:((g,v)=>v(JSON.stringify(g))),this.decode=(p=t?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class Cp extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ie(l){return typeof l=="object"&&l!==null&&"__isStorageError"in l}class mR extends Cp{constructor(t,e,i){super(t),this.name="StorageApiError",this.status=e,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Uf extends Cp{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}const Rp=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...e)=>Cs(async()=>{const{default:i}=await Promise.resolve().then(()=>Wn);return{default:i}},void 0).then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},yR=()=>rt(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Cs(()=>Promise.resolve().then(()=>Wn),void 0)).Response:Response}),Ff=l=>{if(Array.isArray(l))return l.map(e=>Ff(e));if(typeof l=="function"||l!==Object(l))return l;const t={};return Object.entries(l).forEach(([e,i])=>{const n=e.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[n]=Ff(i)}),t},vR=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},hf=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),bR=(l,t,e)=>rt(void 0,void 0,void 0,function*(){const i=yield yR();l instanceof i&&!e?.noResolveJson?l.json().then(n=>{const a=l.status||500,o=n?.statusCode||a+"";t(new mR(hf(n),a,o))}).catch(n=>{t(new Uf(hf(n),n))}):t(new Uf(hf(l),l))}),_R=(l,t,e,i)=>{const n={method:l,headers:t?.headers||{}};return l==="GET"||!i?n:(vR(i)?(n.headers=Object.assign({"Content-Type":"application/json"},t?.headers),n.body=JSON.stringify(i)):n.body=i,t?.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),e))};function Jo(l,t,e,i,n,a){return rt(this,void 0,void 0,function*(){return new Promise((o,u)=>{l(e,_R(t,i,n,a)).then(d=>{if(!d.ok)throw d;return i?.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>bR(d,u,i))})})}function zo(l,t,e,i){return rt(this,void 0,void 0,function*(){return Jo(l,"GET",t,e,i)})}function Ni(l,t,e,i,n){return rt(this,void 0,void 0,function*(){return Jo(l,"POST",t,i,n,e)})}function zf(l,t,e,i,n){return rt(this,void 0,void 0,function*(){return Jo(l,"PUT",t,i,n,e)})}function wR(l,t,e,i){return rt(this,void 0,void 0,function*(){return Jo(l,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),i)})}function xp(l,t,e,i,n){return rt(this,void 0,void 0,function*(){return Jo(l,"DELETE",t,i,n,e)})}class SR{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}execute(){return rt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}}var iw;class AR{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[iw]="BlobDownloadBuilder",this.promise=null}asStream(){return new SR(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return rt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}}iw=Symbol.toStringTag;const ER={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Wb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class TR{constructor(t,e={},i,n){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=i,this.fetch=Rp(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,e,i,n){return rt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Wb),n);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&i instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",i)):typeof FormData<"u"&&i instanceof FormData?(a=i,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d))):(a=i,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,d&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),n?.headers&&(u=Object.assign(Object.assign({},u),n.headers));const f=this._removeEmptyFolders(e),p=this._getFinalPath(f),g=yield(t=="PUT"?zf:Ni)(this.fetch,`${this.url}/object/${p}`,a,Object.assign({headers:u},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ie(a))return{data:null,error:a};throw a}})}upload(t,e,i){return rt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,i)})}uploadToSignedUrl(t,e,i,n){return rt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),u=new URL(this.url+`/object/upload/sign/${o}`);u.searchParams.set("token",e);try{let d;const f=Object.assign({upsert:Wb.upsert},n),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&i instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",i)):typeof FormData<"u"&&i instanceof FormData?(d=i,d.append("cacheControl",f.cacheControl)):(d=i,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType);const g=yield zf(this.fetch,u.toString(),d,{headers:p});return{data:{path:a,fullPath:g.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(ie(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,e){return rt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const n=Object.assign({},this.headers);e?.upsert&&(n["x-upsert"]="true");const a=yield Ni(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:n}),o=new URL(this.url+a.url),u=o.searchParams.get("token");if(!u)throw new Cp("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:u},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ie(i))return{data:null,error:i};throw i}})}update(t,e,i){return rt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,i)})}move(t,e,i){return rt(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ie(n))return{data:null,error:n};throw n}})}copy(t,e,i){return rt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ni(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ie(n))return{data:null,error:n};throw n}})}createSignedUrl(t,e,i){return rt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),a=yield Ni(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:e},i?.transform?{transform:i.transform}:{}),{headers:this.headers});const o=i?.download?`&download=${i.download===!0?"":i.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ie(n))return{data:null,error:n};throw n}})}createSignedUrls(t,e,i){return rt(this,void 0,void 0,function*(){try{const n=yield Ni(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),a=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ie(n))return{data:null,error:n};throw n}})}download(t,e){const n=typeof e?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(e?.transform||{}),o=a?`?${a}`:"",u=this._getFinalPath(t),d=()=>zo(this.fetch,`${this.url}/${n}/${u}${o}`,{headers:this.headers,noResolveJson:!0});return new AR(d,this.shouldThrowOnError)}info(t){return rt(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const i=yield zo(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Ff(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ie(i))return{data:null,error:i};throw i}})}exists(t){return rt(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield wR(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ie(i)&&i instanceof Uf){const n=i.originalError;if([400,404].includes(n?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,e){const i=this._getFinalPath(t),n=[],a=e?.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&n.push(a);const u=typeof e?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(e?.transform||{});d!==""&&n.push(d);let f=n.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${i}${f}`)}}}remove(t){return rt(this,void 0,void 0,function*(){try{return{data:yield xp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}list(t,e,i){return rt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},ER),e),{prefix:t||""});return{data:yield Ni(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},i),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ie(n))return{data:null,error:n};throw n}})}listV2(t,e){return rt(this,void 0,void 0,function*(){try{const i=Object.assign({},t);return{data:yield Ni(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},e),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ie(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const sw="2.76.1",nw={"X-Client-Info":`storage-js/${sw}`};class CR{constructor(t,e={},i,n){this.shouldThrowOnError=!1;const a=new URL(t);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nw),e),this.fetch=Rp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return rt(this,void 0,void 0,function*(){try{return{data:yield zo(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ie(t))return{data:null,error:t};throw t}})}getBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:yield zo(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}createBucket(t){return rt(this,arguments,void 0,function*(e,i={public:!1}){try{return{data:yield Ni(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ie(n))return{data:null,error:n};throw n}})}updateBucket(t,e){return rt(this,void 0,void 0,function*(){try{return{data:yield zf(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ie(i))return{data:null,error:i};throw i}})}emptyBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}deleteBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:yield xp(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}}class RR{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},nw),e),this.fetch=Rp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}listBuckets(t){return rt(this,void 0,void 0,function*(){try{const e=new URLSearchParams;t?.limit!==void 0&&e.set("limit",t.limit.toString()),t?.offset!==void 0&&e.set("offset",t.offset.toString()),t?.sortColumn&&e.set("sortColumn",t.sortColumn),t?.sortOrder&&e.set("sortOrder",t.sortOrder),t?.search&&e.set("search",t.search);const i=e.toString(),n=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`,a=yield zo(this.fetch,n,{headers:this.headers});return{data:Array.isArray(a)?a.filter(u=>u.type==="ANALYTICS"):[],error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}deleteBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:yield xp(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ie(e))return{data:null,error:e};throw e}})}}const Op={"X-Client-Info":`storage-js/${sw}`,"Content-Type":"application/json"};class rw extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function hi(l){return typeof l=="object"&&l!==null&&"__isStorageVectorsError"in l}class df extends rw{constructor(t,e,i){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xR extends rw{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}}var Qb;(function(l){l.InternalError="InternalError",l.S3VectorConflictException="S3VectorConflictException",l.S3VectorNotFoundException="S3VectorNotFoundException",l.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",l.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",l.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Qb||(Qb={}));const Mp=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...e)=>Cs(async()=>{const{default:i}=await Promise.resolve().then(()=>Wn);return{default:i}},void 0).then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},OR=l=>{if(typeof l!="object"||l===null)return!1;const t=Object.getPrototypeOf(l);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in l)&&!(Symbol.iterator in l)},Jb=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),MR=(l,t,e)=>rt(void 0,void 0,void 0,function*(){if(l&&typeof l=="object"&&"status"in l&&"ok"in l&&typeof l.status=="number"&&!e?.noResolveJson){const n=l.status||500,a=l;if(typeof a.json=="function")a.json().then(o=>{const u=o?.statusCode||o?.code||n+"";t(new df(Jb(o),n,u))}).catch(()=>{const o=n+"",u=a.statusText||`HTTP ${n} error`;t(new df(u,n,o))});else{const o=n+"",u=a.statusText||`HTTP ${n} error`;t(new df(u,n,o))}}else t(new xR(Jb(l),l))}),kR=(l,t,e,i)=>{const n={method:l,headers:t?.headers||{}};return i?(OR(i)?(n.headers=Object.assign({"Content-Type":"application/json"},t?.headers),n.body=JSON.stringify(i)):n.body=i,Object.assign(Object.assign({},n),e)):n};function DR(l,t,e,i,n,a){return rt(this,void 0,void 0,function*(){return new Promise((o,u)=>{l(e,kR(t,i,n,a)).then(d=>{if(!d.ok)throw d;if(i?.noResolveJson)return d;const f=d.headers.get("content-type");return!f||!f.includes("application/json")?{}:d.json()}).then(d=>o(d)).catch(d=>MR(d,u,i))})})}function di(l,t,e,i,n){return rt(this,void 0,void 0,function*(){return DR(l,"POST",t,i,n,e)})}class LR{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Op),e),this.fetch=Mp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return rt(this,void 0,void 0,function*(){try{return{data:(yield di(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}getIndex(t,e){return rt(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(hi(i))return{data:null,error:i};throw i}})}listIndexes(t){return rt(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}deleteIndex(t,e){return rt(this,void 0,void 0,function*(){try{return{data:(yield di(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(hi(i))return{data:null,error:i};throw i}})}}class PR{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Op),e),this.fetch=Mp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return rt(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield di(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}getVectors(t){return rt(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}listVectors(t){return rt(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield di(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}queryVectors(t){return rt(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}deleteVectors(t){return rt(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield di(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}}class NR{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Op),e),this.fetch=Mp(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:(yield di(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}getBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}listBuckets(){return rt(this,arguments,void 0,function*(t={}){try{return{data:yield di(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}deleteBucket(t){return rt(this,void 0,void 0,function*(){try{return{data:(yield di(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(hi(e))return{data:null,error:e};throw e}})}}class BR extends NR{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new IR(this.url,this.headers,t,this.fetch)}}class IR extends LR{constructor(t,e,i,n){super(t,e,n),this.vectorBucketName=i}createIndex(t){const e=Object.create(null,{createIndex:{get:()=>super.createIndex}});return rt(this,void 0,void 0,function*(){return e.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return rt(this,arguments,void 0,function*(e={}){return t.listIndexes.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const e=Object.create(null,{getIndex:{get:()=>super.getIndex}});return rt(this,void 0,void 0,function*(){return e.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const e=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return rt(this,void 0,void 0,function*(){return e.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new jR(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class jR extends PR{constructor(t,e,i,n,a){super(t,e,a),this.vectorBucketName=i,this.indexName=n}putVectors(t){const e=Object.create(null,{putVectors:{get:()=>super.putVectors}});return rt(this,void 0,void 0,function*(){return e.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const e=Object.create(null,{getVectors:{get:()=>super.getVectors}});return rt(this,void 0,void 0,function*(){return e.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return rt(this,arguments,void 0,function*(e={}){return t.listVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const e=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return rt(this,void 0,void 0,function*(){return e.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const e=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return rt(this,void 0,void 0,function*(){return e.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class UR extends CR{constructor(t,e={},i,n){super(t,e,i,n)}from(t){return new TR(this.url,this.headers,t,this.fetch)}get vectors(){return new BR(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new RR(this.url+"/iceberg",this.headers,this.fetch)}}const FR="2.76.1";let Eo="";typeof Deno<"u"?Eo="deno":typeof document<"u"?Eo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Eo="react-native":Eo="node";const zR={"X-Client-Info":`supabase-js-${Eo}/${FR}`},HR={headers:zR},$R={schema:"public"},qR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},VR={},GR=l=>{let t;return l?t=l:typeof fetch>"u"?t=Y_:t=fetch,(...e)=>t(...e)},YR=()=>typeof Headers>"u"?X_:Headers,XR=(l,t,e)=>{const i=GR(e),n=YR();return async(a,o)=>{var u;const d=(u=await t())!==null&&u!==void 0?u:l;let f=new n(o?.headers);return f.has("apikey")||f.set("apikey",l),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),i(a,Object.assign(Object.assign({},o),{headers:f}))}};function KR(l){return l.endsWith("/")?l:l+"/"}function WR(l,t){var e,i;const{db:n,auth:a,realtime:o,global:u}=l,{db:d,auth:f,realtime:p,global:g}=t,v={db:Object.assign(Object.assign({},d),n),auth:Object.assign(Object.assign({},f),a),realtime:Object.assign(Object.assign({},p),o),storage:{},global:Object.assign(Object.assign(Object.assign({},g),u),{headers:Object.assign(Object.assign({},(e=g?.headers)!==null&&e!==void 0?e:{}),(i=u?.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return l.accessToken?v.accessToken=l.accessToken:delete v.accessToken,v}function QR(l){const t=l?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(KR(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const aw="2.76.1",Yr=30*1e3,Hf=3,ff=Hf*Yr,JR="http://localhost:9999",ZR="supabase.auth.token",tx={"X-Client-Info":`gotrue-js/${aw}`},$f="X-Supabase-Api-Version",ow={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ex=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ix=600*1e3;class Ho extends Error{constructor(t,e,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=i}}function ht(l){return typeof l=="object"&&l!==null&&"__isAuthError"in l}class sx extends Ho{constructor(t,e,i){super(t,e,i),this.name="AuthApiError",this.status=e,this.code=i}}function nx(l){return ht(l)&&l.name==="AuthApiError"}class Nn extends Ho{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class un extends Ho{constructor(t,e,i,n){super(t,i,n),this.name=e,this.status=i}}class en extends un{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rx(l){return ht(l)&&l.name==="AuthSessionMissingError"}class jr extends un{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fc extends un{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class zc extends un{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ax(l){return ht(l)&&l.name==="AuthImplicitGrantRedirectError"}class Zb extends un{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qf extends un{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function pf(l){return ht(l)&&l.name==="AuthRetryableFetchError"}class t0 extends un{constructor(t,e,i){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=i}}class Vf extends un{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ru="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),e0=` 	
\r=`.split(""),ox=(()=>{const l=new Array(128);for(let t=0;t<l.length;t+=1)l[t]=-1;for(let t=0;t<e0.length;t+=1)l[e0[t].charCodeAt(0)]=-2;for(let t=0;t<ru.length;t+=1)l[ru[t].charCodeAt(0)]=t;return l})();function i0(l,t,e){if(l!==null)for(t.queue=t.queue<<8|l,t.queuedBits+=8;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;e(ru[i]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const i=t.queue>>t.queuedBits-6&63;e(ru[i]),t.queuedBits-=6}}function lw(l,t,e){const i=ox[l];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}}function s0(l){const t=[],e=o=>{t.push(String.fromCodePoint(o))},i={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=o=>{ux(o,i,e)};for(let o=0;o<l.length;o+=1)lw(l.charCodeAt(o),n,a);return t.join("")}function lx(l,t){if(l<=127){t(l);return}else if(l<=2047){t(192|l>>6),t(128|l&63);return}else if(l<=65535){t(224|l>>12),t(128|l>>6&63),t(128|l&63);return}else if(l<=1114111){t(240|l>>18),t(128|l>>12&63),t(128|l>>6&63),t(128|l&63);return}throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}function cx(l,t){for(let e=0;e<l.length;e+=1){let i=l.charCodeAt(e);if(i>55295&&i<=56319){const n=(i-55296)*1024&65535;i=(l.charCodeAt(e+1)-56320&65535|n)+65536,e+=1}lx(i,t)}}function ux(l,t,e){if(t.utf8seq===0){if(l<=127){e(l);return}for(let i=1;i<6;i+=1)if((l>>7-i&1)===0){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=l&31;else if(t.utf8seq===3)t.codepoint=l&15;else if(t.utf8seq===4)t.codepoint=l&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|l&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function ia(l){const t=[],e={queue:0,queuedBits:0},i=n=>{t.push(n)};for(let n=0;n<l.length;n+=1)lw(l.charCodeAt(n),e,i);return new Uint8Array(t)}function hx(l){const t=[];return cx(l,e=>t.push(e)),new Uint8Array(t)}function In(l){const t=[],e={queue:0,queuedBits:0},i=n=>{t.push(n)};return l.forEach(n=>i0(n,e,i)),i0(null,e,i),t.join("")}function dx(l){return Math.round(Date.now()/1e3)+l}function fx(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){const t=Math.random()*16|0;return(l=="x"?t:t&3|8).toString(16)})}const oi=()=>typeof window<"u"&&typeof document<"u",Mn={tested:!1,writable:!1},cw=()=>{if(!oi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Mn.tested)return Mn.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),Mn.tested=!0,Mn.writable=!0}catch{Mn.tested=!0,Mn.writable=!1}return Mn.writable};function px(l){const t={},e=new URL(l);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((n,a)=>{t[a]=n})}catch{}return e.searchParams.forEach((i,n)=>{t[n]=i}),t}const uw=l=>{let t;return l?t=l:typeof fetch>"u"?t=(...e)=>Cs(async()=>{const{default:i}=await Promise.resolve().then(()=>Wn);return{default:i}},void 0).then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},gx=l=>typeof l=="object"&&l!==null&&"status"in l&&"ok"in l&&"json"in l&&typeof l.json=="function",Xr=async(l,t,e)=>{await l.setItem(t,JSON.stringify(e))},kn=async(l,t)=>{const e=await l.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},tn=async(l,t)=>{await l.removeItem(t)};class Su{constructor(){this.promise=new Su.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Su.promiseConstructor=Promise;function gf(l){const t=l.split(".");if(t.length!==3)throw new Vf("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!ex.test(t[i]))throw new Vf("JWT not in base64url format");return{header:JSON.parse(s0(t[0])),payload:JSON.parse(s0(t[1])),signature:ia(t[2]),raw:{header:t[0],payload:t[1]}}}async function mx(l){return await new Promise(t=>{setTimeout(()=>t(null),l)})}function yx(l,t){return new Promise((i,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await l(a);if(!t(a,null,o)){i(o);return}}catch(o){if(!t(a,o)){n(o);return}}})()})}function vx(l){return("0"+l.toString(16)).substr(-2)}function bx(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=e.length;let n="";for(let a=0;a<56;a++)n+=e.charAt(Math.floor(Math.random()*i));return n}return crypto.getRandomValues(t),Array.from(t,vx).join("")}async function _x(l){const e=new TextEncoder().encode(l),i=await crypto.subtle.digest("SHA-256",e),n=new Uint8Array(i);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function wx(l){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const e=await _x(l);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ur(l,t,e=!1){const i=bx();let n=i;e&&(n+="/PASSWORD_RECOVERY"),await Xr(l,`${t}-code-verifier`,n);const a=await wx(i);return[a,i===a?"plain":"s256"]}const Sx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ax(l){const t=l.headers.get($f);if(!t||!t.match(Sx))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Ex(l){if(!l)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(l<=t)throw new Error("JWT has expired")}function Tx(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Cx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fr(l){if(!Cx.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function mf(){const l={};return new Proxy(l,{get:(t,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const i=e.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function n0(l){return JSON.parse(JSON.stringify(l))}const Dn=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Rx=[502,503,504];async function r0(l){var t;if(!gx(l))throw new qf(Dn(l),0);if(Rx.includes(l.status))throw new qf(Dn(l),l.status);let e;try{e=await l.json()}catch(a){throw new Nn(Dn(a),a)}let i;const n=Ax(l);if(n&&n.getTime()>=ow["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?i=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(i=e.error_code),i){if(i==="weak_password")throw new t0(Dn(e),l.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new en}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new t0(Dn(e),l.status,e.weak_password.reasons);throw new sx(Dn(e),l.status||500,i)}const xx=(l,t,e,i)=>{const n={method:l,headers:t?.headers||{}};return l==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),e))};async function _t(l,t,e,i){var n;const a=Object.assign({},i?.headers);a[$f]||(a[$f]=ow["2024-01-01"].name),i?.jwt&&(a.Authorization=`Bearer ${i.jwt}`);const o=(n=i?.query)!==null&&n!==void 0?n:{};i?.redirectTo&&(o.redirect_to=i.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await Ox(l,t,e+u,{headers:a,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(d):{data:Object.assign({},d),error:null}}async function Ox(l,t,e,i,n,a){const o=xx(t,i,n,a);let u;try{u=await l(e,Object.assign({},o))}catch(d){throw console.error(d),new qf(Dn(d),0)}if(u.ok||await r0(u),i?.noResolveJson)return u;try{return await u.json()}catch(d){await r0(d)}}function Pi(l){var t;let e=null;Dx(l)&&(e=Object.assign({},l),l.expires_at||(e.expires_at=dx(l.expires_in)));const i=(t=l.user)!==null&&t!==void 0?t:l;return{data:{session:e,user:i},error:null}}function a0(l){const t=Pi(l);return!t.error&&l.weak_password&&typeof l.weak_password=="object"&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&typeof l.weak_password.message=="string"&&l.weak_password.reasons.reduce((e,i)=>e&&typeof i=="string",!0)&&(t.data.weak_password=l.weak_password),t}function sn(l){var t;return{data:{user:(t=l.user)!==null&&t!==void 0?t:l},error:null}}function Mx(l){return{data:l,error:null}}function kx(l){const{action_link:t,email_otp:e,hashed_token:i,redirect_to:n,verification_type:a}=l,o=pa(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:e,hashed_token:i,redirect_to:n,verification_type:a},d=Object.assign({},o);return{data:{properties:u,user:d},error:null}}function o0(l){return l}function Dx(l){return l.access_token&&l.refresh_token&&l.expires_in}const yf=["global","local","others"];class Lx{constructor({url:t="",headers:e={},fetch:i}){this.url=t,this.headers=e,this.fetch=uw(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,e=yf[0]){if(yf.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yf.join(", ")}`);try{return await _t(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ht(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,e={}){try{return await _t(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:sn})}catch(i){if(ht(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:e}=t,i=pa(t,["options"]),n=Object.assign(Object.assign({},i),e);return"newEmail"in i&&(n.new_email=i?.newEmail,delete n.newEmail),await _t(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:kx,redirectTo:e?.redirectTo})}catch(e){if(ht(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await _t(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:sn})}catch(e){if(ht(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,i,n,a,o,u,d;try{const f={nextPage:null,lastPage:0,total:0},p=await _t(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&i!==void 0?i:"",per_page:(a=(n=t?.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:o0});if(p.error)throw p.error;const g=await p.json(),v=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,b=(d=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(w.split(";")[1].split("=")[1]);f[`${A}Page`]=_}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(ht(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){Fr(t);try{return await _t(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:sn})}catch(e){if(ht(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){Fr(t);try{return await _t(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:sn})}catch(i){if(ht(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,e=!1){Fr(t);try{return await _t(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:sn})}catch(i){if(ht(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){Fr(t.userId);try{const{data:e,error:i}=await _t(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:e,error:i}}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _deleteFactor(t){Fr(t.userId),Fr(t.id);try{return{data:await _t(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _listOAuthClients(t){var e,i,n,a,o,u,d;try{const f={nextPage:null,lastPage:0,total:0},p=await _t(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&i!==void 0?i:"",per_page:(a=(n=t?.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:o0});if(p.error)throw p.error;const g=await p.json(),v=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,b=(d=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(w.split(";")[1].split("=")[1]);f[`${A}Page`]=_}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(ht(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await _t(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _getOAuthClient(t){try{return await _t(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(t){try{return await _t(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(t){try{return await _t(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ht(e))return{data:null,error:e};throw e}}}function l0(l={}){return{getItem:t=>l[t]||null,setItem:(t,e)=>{l[t]=e},removeItem:t=>{delete l[t]}}}const zr={debug:!!(globalThis&&cw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class hw extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Px extends hw{}async function Nx(l,t,e){zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),zr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(l,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async n=>{if(n){zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,n.name);try{return await e()}finally{zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",l,n.name)}}else{if(t===0)throw zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new Px(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(zr.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function Bx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function dw(l){if(!/^0x[a-fA-F0-9]{40}$/.test(l))throw new Error(`@supabase/auth-js: Address "${l}" is invalid.`);return l.toLowerCase()}function Ix(l){return parseInt(l,16)}function jx(l){const t=new TextEncoder().encode(l);return"0x"+Array.from(t,i=>i.toString(16).padStart(2,"0")).join("")}function Ux(l){var t;const{chainId:e,domain:i,expirationTime:n,issuedAt:a=new Date,nonce:o,notBefore:u,requestId:d,resources:f,scheme:p,uri:g,version:v}=l;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=l.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${l.statement}`)}const b=dw(l.address),w=p?`${p}://${i}`:i,_=l.statement?`${l.statement}
`:"",A=`${w} wants you to sign in with your Ethereum account:
${b}

${_}`;let E=`URI: ${g}
Version: ${v}
Chain ID: ${e}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(n&&(E+=`
Expiration Time: ${n.toISOString()}`),u&&(E+=`
Not Before: ${u.toISOString()}`),d&&(E+=`
Request ID: ${d}`),f){let R=`
Resources:`;for(const C of f){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);R+=`
- ${C}`}E+=R}return`${A}
${E}`}class me extends Error{constructor({message:t,code:e,cause:i,name:n}){var a;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=(a=n??(i instanceof Error?i.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=e}}class au extends me{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}}function Fx({error:l,options:t}){var e,i,n;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new me({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else if(l.name==="ConstraintError"){if(((e=a.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new me({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:l});if(t.mediation==="conditional"&&((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new me({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:l});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new me({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:l})}else{if(l.name==="InvalidStateError")return new me({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:l});if(l.name==="NotAllowedError")return new me({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="NotSupportedError")return a.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new me({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:l}):new me({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:l});if(l.name==="SecurityError"){const o=window.location.hostname;if(fw(o)){if(a.rp.id!==o)return new me({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new me({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new me({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:l})}else if(l.name==="UnknownError")return new me({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new me({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}function zx({error:l,options:t}){const{publicKey:e}=t;if(!e)throw Error("options was missing required publicKey property");if(l.name==="AbortError"){if(t.signal instanceof AbortSignal)return new me({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:l})}else{if(l.name==="NotAllowedError")return new me({message:l.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l});if(l.name==="SecurityError"){const i=window.location.hostname;if(fw(i)){if(e.rpId!==i)return new me({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:l})}else return new me({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:l})}else if(l.name==="UnknownError")return new me({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:l})}return new me({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l})}class Hx{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const $x=new Hx;function qx(l){if(!l)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(l);const{challenge:t,user:e,excludeCredentials:i}=l,n=pa(l,["challenge","user","excludeCredentials"]),a=ia(t).buffer,o=Object.assign(Object.assign({},e),{id:ia(e.id).buffer}),u=Object.assign(Object.assign({},n),{challenge:a,user:o});if(i&&i.length>0){u.excludeCredentials=new Array(i.length);for(let d=0;d<i.length;d++){const f=i[d];u.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:ia(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function Vx(l){if(!l)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(l);const{challenge:t,allowCredentials:e}=l,i=pa(l,["challenge","allowCredentials"]),n=ia(t).buffer,a=Object.assign(Object.assign({},i),{challenge:n});if(e&&e.length>0){a.allowCredentials=new Array(e.length);for(let o=0;o<e.length;o++){const u=e[o];a.allowCredentials[o]=Object.assign(Object.assign({},u),{id:ia(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function Gx(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const e=l;return{id:l.id,rawId:l.id,response:{attestationObject:In(new Uint8Array(l.response.attestationObject)),clientDataJSON:In(new Uint8Array(l.response.clientDataJSON))},type:"public-key",clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Yx(l){var t;if("toJSON"in l&&typeof l.toJSON=="function")return l.toJSON();const e=l,i=l.getClientExtensionResults(),n=l.response;return{id:l.id,rawId:l.id,response:{authenticatorData:In(new Uint8Array(n.authenticatorData)),clientDataJSON:In(new Uint8Array(n.clientDataJSON)),signature:In(new Uint8Array(n.signature)),userHandle:n.userHandle?In(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function fw(l){return l==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(l)}function c0(){var l,t;return!!(oi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((l=navigator?.credentials)===null||l===void 0?void 0:l.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Xx(l){try{const t=await navigator.credentials.create(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new au("Browser returned unexpected credential type",t)}:{data:null,error:new au("Empty credential response",t)}}catch(t){return{data:null,error:Fx({error:t,options:l})}}}async function Kx(l){try{const t=await navigator.credentials.get(l);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new au("Browser returned unexpected credential type",t)}:{data:null,error:new au("Empty credential response",t)}}catch(t){return{data:null,error:zx({error:t,options:l})}}}const Wx={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Qx={userVerification:"preferred",hints:["security-key"]};function ou(...l){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),e=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),i={};for(const n of l)if(n)for(const a in n){const o=n[a];if(o!==void 0)if(Array.isArray(o))i[a]=o;else if(e(o))i[a]=o;else if(t(o)){const u=i[a];t(u)?i[a]=ou(u,o):i[a]=ou(o)}else i[a]=o}return i}function Jx(l,t){return ou(Wx,l,t||{})}function Zx(l,t){return ou(Qx,l,t||{})}class tO{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:e,friendlyName:i,signal:n},a){try{const{data:o,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:e});if(!o)return{data:null,error:u};const d=n??$x.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:f}=o.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${i}`),f.displayName||(f.displayName=f.name)}switch(o.webauthn.type){case"create":{const f=Jx(o.webauthn.credential_options.publicKey,a?.create),{data:p,error:g}=await Xx({publicKey:f,signal:d});return p?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:g}}case"request":{const f=Zx(o.webauthn.credential_options.publicKey,a?.request),{data:p,error:g}=await Kx(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:f,signal:d}));return p?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:g}}}}catch(o){return ht(o)?{data:null,error:o}:{data:null,error:new Nn("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:e,webauthn:i}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:i})}async _authenticate({factorId:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:n}},a){if(!e)return{data:null,error:new Ho("rpId is required for WebAuthn authentication")};try{if(!c0())return{data:null,error:new Nn("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:i},signal:n},{request:a});if(!o)return{data:null,error:u};const{webauthn:d}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:d.type,rpId:e,rpOrigins:i,credential_response:d.credential_response}})}catch(o){return ht(o)?{data:null,error:o}:{data:null,error:new Nn("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:n},a){if(!e)return{data:null,error:new Ho("rpId is required for WebAuthn registration")};try{if(!c0())return{data:null,error:new Nn("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(p=>{var g;return(g=p.data)===null||g===void 0?void 0:g.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:u};const{data:d,error:f}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:e,rpOrigins:i},signal:n},{create:a});return d?this._verify({factorId:o.id,challengeId:d.challengeId,webauthn:{rpId:e,rpOrigins:i,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(o){return ht(o)?{data:null,error:o}:{data:null,error:new Nn("Unexpected error in register",o)}}}}Bx();const eO={url:JR,storageKey:ZR,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function u0(l,t,e){return await e()}const Hr={};class $o{get jwks(){var t,e;return(e=(t=Hr[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(t){Hr[this.storageKey]=Object.assign(Object.assign({},Hr[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,e;return(e=(t=Hr[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Hr[this.storageKey]=Object.assign(Object.assign({},Hr[this.storageKey]),{cachedAt:t})}constructor(t){var e,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=$o.nextInstanceID,$o.nextInstanceID+=1,this.instanceID>0&&oi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},eO),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Lx({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=uw(n.fetch),this.lock=n.lock||u0,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:oi()&&(!((e=globalThis?.navigator)===null||e===void 0)&&e.locks)?this.lock=Nx:this.lock=u0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new tO(this)},this.persistSession?(n.storage?this.storage=n.storage:cw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=l0(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=l0(this.memoryStorage)),oi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${aw}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const e=px(window.location.href);let i="none";if(this._isImplicitGrantCallback(e)?i="implicit":await this._isPKCECallback(e)&&(i="pkce"),oi()&&this.detectSessionInUrl&&i!=="none"){const{data:n,error:a}=await this._getSessionFromURL(e,i);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),ax(a)){const d=(t=a.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:u}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return ht(e)?{error:e}:{error:new Nn("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,i,n;try{const a=await _t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(e=t?.options)===null||e===void 0?void 0:e.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(n=t?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Pi}),{data:o,error:u}=a;if(u||!o)return{data:{user:null,session:null},error:u};const d=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ht(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var e,i,n;try{let a;if("email"in t){const{email:p,password:g,options:v}=t;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await Ur(this.storage,this.storageKey)),a=await _t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:p,password:g,data:(e=v?.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:b,code_challenge_method:w},xform:Pi})}else if("phone"in t){const{phone:p,password:g,options:v}=t;a=await _t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(i=v?.data)!==null&&i!==void 0?i:{},channel:(n=v?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Pi})}else throw new Fc("You must provide either an email or phone number and a password");const{data:o,error:u}=a;if(u||!o)return{data:{user:null,session:null},error:u};const d=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ht(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let e;if("email"in t){const{email:a,password:o,options:u}=t;e=await _t(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:a0})}else if("phone"in t){const{phone:a,password:o,options:u}=t;e=await _t(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:a0})}else throw new Fc("You must provide either an email or phone number and a password");const{data:i,error:n}=e;return n?{data:{user:null,session:null},error:n}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new jr}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:n})}catch(e){if(ht(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(t){var e,i,n,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:e}=t;switch(e){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(t){var e,i,n,a,o,u,d,f,p,g,v;let b,w;if("message"in t)b=t.message,w=t.signature;else{const{chain:_,wallet:A,statement:E,options:R}=t;let C;if(oi())if(typeof A=="object")C=A;else{const H=window;if("ethereum"in H&&typeof H.ethereum=="object"&&"request"in H.ethereum&&typeof H.ethereum.request=="function")C=H.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=A}const x=new URL((e=R?.url)!==null&&e!==void 0?e:window.location.href),D=await C.request({method:"eth_requestAccounts"}).then(H=>H).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!D||D.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=dw(D[0]);let k=(i=R?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!k){const H=await C.request({method:"eth_chainId"});k=Ix(H)}const I={domain:x.host,address:M,statement:E,uri:x.href,version:"1",chainId:k,nonce:(n=R?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(o=(a=R?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(u=R?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=R?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=R?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(p=R?.signInWithEthereum)===null||p===void 0?void 0:p.resources};b=Ux(I),w=await C.request({method:"personal_sign",params:[jx(b),M]})}try{const{data:_,error:A}=await _t(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Pi});if(A)throw A;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new jr}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:A})}catch(_){if(ht(_))return{data:{user:null,session:null},error:_};throw _}}async signInWithSolana(t){var e,i,n,a,o,u,d,f,p,g,v,b;let w,_;if("message"in t)w=t.message,_=t.signature;else{const{chain:A,wallet:E,statement:R,options:C}=t;let x;if(oi())if(typeof E=="object")x=E;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))x=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=E}const D=new URL((e=C?.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in x&&x.signIn){const M=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:D.host,uri:D.href}),R?{statement:R}:null));let k;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")k=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)k=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)w=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),_=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${D.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...R?["",R,""]:[""],"Version: 1",`URI: ${D.href}`,`Issued At: ${(n=(i=C?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=C?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((o=C?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((g=(p=C?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...C.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const M=await x.signMessage(new TextEncoder().encode(w),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=M}}try{const{data:A,error:E}=await _t(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:In(_)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Pi});if(E)throw E;return!A||!A.session||!A.user?{data:{user:null,session:null},error:new jr}:(A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),{data:Object.assign({},A),error:E})}catch(A){if(ht(A))return{data:{user:null,session:null},error:A};throw A}}async _exchangeCodeForSession(t){const e=await kn(this.storage,`${this.storageKey}-code-verifier`),[i,n]=(e??"").split("/");try{const{data:a,error:o}=await _t(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:Pi});if(await tn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new jr}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:o})}catch(a){if(ht(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:e,provider:i,token:n,access_token:a,nonce:o}=t,u=await _t(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:n,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:e?.captchaToken}},xform:Pi}),{data:d,error:f}=u;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new jr}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(e){if(ht(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(t){var e,i,n,a,o;try{if("email"in t){const{email:u,options:d}=t;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Ur(this.storage,this.storageKey));const{error:g}=await _t(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(e=d?.data)!==null&&e!==void 0?e:{},create_user:(i=d?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:g}}if("phone"in t){const{phone:u,options:d}=t,{data:f,error:p}=await _t(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(n=d?.data)!==null&&n!==void 0?n:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(o=d?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:f?.message_id},error:p}}throw new Fc("You must provide either an email or phone number.")}catch(u){if(ht(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(t){var e,i;try{let n,a;"options"in t&&(n=(e=t.options)===null||e===void 0?void 0:e.redirectTo,a=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:o,error:u}=await _t(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Pi});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,f=o.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(n){if(ht(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var e,i,n;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await Ur(this.storage,this.storageKey)),await _t(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&i!==void 0?i:void 0}),!((n=t?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:Mx})}catch(a){if(ht(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:i}=t;if(i)throw i;if(!e)throw new en;const{error:n}=await _t(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(ht(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:i,type:n,options:a}=t,{error:o}=await _t(this.fetch,"POST",e,{headers:this.headers,body:{email:i,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:i,type:n,options:a}=t,{data:o,error:u}=await _t(this.fetch,"POST",e,{headers:this.headers,body:{phone:i,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:u}}throw new Fc("You must provide either an email or phone number and a type")}catch(e){if(ht(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await i,await e()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=e();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await kn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<ff:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.userStorage){const o=await kn(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=mf()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(d,f,p)=>(!o&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,p))})}return{data:{session:t},error:null}}const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await _t(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:sn}):await this._useSession(async e=>{var i,n,a;const{data:o,error:u}=e;if(u)throw u;return!(!((i=o.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new en}:await _t(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:sn})})}catch(e){if(ht(e))return rx(e)&&(await this._removeSession(),await tn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async i=>{const{data:n,error:a}=i;if(a)throw a;if(!n.session)throw new en;const o=n.session;let u=null,d=null;this.flowType==="pkce"&&t.email!=null&&([u,d]=await Ur(this.storage,this.storageKey));const{data:f,error:p}=await _t(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:d}),jwt:o.access_token,xform:sn});if(p)throw p;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(i){if(ht(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new en;const e=Date.now()/1e3;let i=e,n=!0,a=null;const{payload:o}=gf(t.access_token);if(o.exp&&(i=o.exp,n=i<=e),n){const{data:u,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!u)return{data:{user:null,session:null},error:null};a=u}else{const{data:u,error:d}=await this._getUser(t.access_token);if(d)throw d;a={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:i-e,expires_at:i},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(e){if(ht(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var i;if(!t){const{data:o,error:u}=e;if(u)throw u;t=(i=o.session)!==null&&i!==void 0?i:void 0}if(!t?.refresh_token)throw new en;const{data:n,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(ht(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(t,e){try{if(!oi())throw new zc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new zc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new Zb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zc("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Zb("No code detected.");const{data:R,error:C}=await this._exchangeCodeForSession(t.code);if(C)throw C;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:R.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:n,access_token:a,refresh_token:o,expires_in:u,expires_at:d,token_type:f}=t;if(!a||!u||!o||!f)throw new zc("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(u);let v=p+g;d&&(v=parseInt(d));const b=v-p;b*1e3<=Yr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${g}s`);const w=v-g;p-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,v,p):p-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,v,p);const{data:_,error:A}=await this._getUser(a);if(A)throw A;const E={provider_token:i,provider_refresh_token:n,access_token:a,expires_in:g,expires_at:v,refresh_token:o,token_type:f,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:t.type},error:null}}catch(i){if(ht(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await kn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var i;const{data:n,error:a}=e;if(a)return{error:a};const o=(i=n.session)===null||i===void 0?void 0:i.access_token;if(o){const{error:u}=await this.admin.signOut(o,t);if(u&&!(nx(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return t!=="others"&&(await this._removeSession(),await tn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const e=fx(),i={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async e=>{var i,n;try{const{data:{session:a},error:o}=e;if(o)throw o;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,e={}){let i=null,n=null;this.flowType==="pkce"&&([i,n]=await Ur(this.storage,this.storageKey,!0));try{return await _t(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:n,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(a){if(ht(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:e,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(e){if(ht(e))return{data:null,error:e};throw e}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var e;try{const{data:i,error:n}=await this._useSession(async a=>{var o,u,d,f,p;const{data:g,error:v}=a;if(v)throw v;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await _t(this.fetch,"GET",b,{headers:this.headers,jwt:(p=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(n)throw n;return oi()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(i?.url),{data:{provider:t.provider,url:i?.url},error:null}}catch(i){if(ht(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async linkIdentityIdToken(t){return await this._useSession(async e=>{var i;try{const{error:n,data:{session:a}}=e;if(n)throw n;const{options:o,provider:u,token:d,access_token:f,nonce:p}=t,g=await _t(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=a?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:u,id_token:d,access_token:f,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Pi}),{data:v,error:b}=g;return b?{data:{user:null,session:null},error:b}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new jr}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),{data:v,error:b})}catch(n){if(ht(n))return{data:{user:null,session:null},error:n};throw n}})}async unlinkIdentity(t){try{return await this._useSession(async e=>{var i,n;const{data:a,error:o}=e;if(o)throw o;return await _t(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0})})}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const i=Date.now();return await yx(async n=>(n>0&&await mx(200*Math.pow(2,n-1)),this._debug(e,"refreshing attempt",n),await _t(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Pi})),(n,a)=>{const o=200*Math.pow(2,n);return a&&pf(a)&&Date.now()+o-i<Yr})}catch(i){if(this._debug(e,"error",i),ht(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",i),oi()&&!e.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t,e;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const n=await kn(this.storage,this.storageKey);if(n&&this.userStorage){let o=await kn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await Xr(this.userStorage,this.storageKey+"-user",o)),n.user=(t=o?.user)!==null&&t!==void 0?t:mf()}else if(n&&!n.user&&!n.user){const o=await kn(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await tn(this.storage,this.storageKey+"-user"),await Xr(this.storage,this.storageKey,n)):n.user=mf()}if(this._debug(i,"session from storage",n),!this._isValidSession(n)){this._debug(i,"session is not valid"),n!==null&&await this._removeSession();return}const a=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<ff;if(this._debug(i,`session has${a?"":" not"} expired with margin of ${ff}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),pf(o)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:u}=await this._getUser(n.access_token);!u&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(i,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(i,"error",n),console.error(n);return}finally{this._debug(i,"end")}}async _callRefreshToken(t){var e,i;if(!t)throw new en;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Su;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new en;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const u={data:a.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(a){if(this._debug(n,"error",a),ht(a)){const o={data:null,error:a};return pf(a)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(o),o}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,e,i=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",e,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:e});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,e)}catch(d){a.push(d)}});if(await Promise.all(o),a.length>0){for(let u=0;u<a.length;u+=1)console.error(a[u]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const e=Object.assign({},t),i=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&e.user&&await Xr(this.userStorage,this.storageKey+"-user",{user:e.user});const n=Object.assign({},e);delete n.user;const a=n0(n);await Xr(this.storage,this.storageKey,a)}else{const n=n0(e);await Xr(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await tn(this.storage,this.storageKey),await tn(this.storage,this.storageKey+"-code-verifier"),await tn(this.storage,this.storageKey+"-user"),this.userStorage&&await tn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&oi()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Yr);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:i}}=e;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((i.expires_at*1e3-t)/Yr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Yr}ms, refresh threshold is ${Hf} ticks`),n<=Hf&&await this._callRefreshToken(i.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof hw)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!oi()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,i){const n=[`provider=${encodeURIComponent(e)}`];if(i?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&n.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[a,o]=await Ur(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(u.toString())}if(i?.queryParams){const a=new URLSearchParams(i.queryParams);n.push(a.toString())}return i?.skipBrowserRedirect&&n.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var i;const{data:n,error:a}=e;return a?{data:null,error:a}:await _t(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token})})}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _enroll(t){try{return await this._useSession(async e=>{var i,n;const{data:a,error:o}=e;if(o)return{data:null,error:o};const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:f}=await _t(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(i=a?.session)===null||i===void 0?void 0:i.access_token});return f?{data:null,error:f}:(t.factorType==="totp"&&d.type==="totp"&&(!((n=d?.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(e){if(ht(e))return{data:null,error:e};throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var i;const{data:n,error:a}=e;if(a)return{data:null,error:a};const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Gx(t.webauthn.credential_response):Yx(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:d}=await _t(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),{data:u,error:d})})}catch(e){if(ht(e))return{data:null,error:e};throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var i;const{data:n,error:a}=e;if(a)return{data:null,error:a};const o=await _t(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(i=n?.session)===null||i===void 0?void 0:i.access_token});if(o.error)return o;const{data:u}=o;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:qx(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:Vx(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(ht(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(t){const{data:e,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){var t;const{data:{user:e},error:i}=await this.getUser();if(i)return{data:null,error:i};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=e?.factors)!==null&&t!==void 0?t:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var e,i;const{data:{session:n},error:a}=t;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=gf(n.access_token);let u=null;o.aal&&(u=o.aal);let d=u;((i=(e=n.user.factors)===null||e===void 0?void 0:e.filter(g=>g.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(d="aal2");const p=o.amr||[];return{data:{currentLevel:u,nextLevel:d,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(t,e={keys:[]}){let i=e.keys.find(u=>u.kid===t);if(i)return i;const n=Date.now();if(i=this.jwks.keys.find(u=>u.kid===t),i&&this.jwks_cached_at+ix>n)return i;const{data:a,error:o}=await _t(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,i=a.keys.find(u=>u.kid===t),!i)?null:i}async getClaims(t,e={}){try{let i=t;if(!i){const{data:b,error:w}=await this.getSession();if(w||!b.session)return{data:null,error:w};i=b.session.access_token}const{header:n,payload:a,signature:o,raw:{header:u,payload:d}}=gf(i);e?.allowExpired||Ex(a.exp);const f=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,e?.keys?{keys:e.keys}:e?.jwks);if(!f){const{error:b}=await this.getUser(i);if(b)throw b;return{data:{claims:a,header:n,signature:o},error:null}}const p=Tx(n.alg),g=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,o,hx(`${u}.${d}`)))throw new Vf("Invalid JWT signature");return{data:{claims:a,header:n,signature:o},error:null}}catch(i){if(ht(i))return{data:null,error:i};throw i}}}$o.nextInstanceID=0;const iO=$o;class sO extends iO{constructor(t){super(t)}}class nO{constructor(t,e,i){var n,a,o;this.supabaseUrl=t,this.supabaseKey=e;const u=QR(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const d=`sb-${u.hostname.split(".")[0]}-auth-token`,f={db:$R,realtime:VR,auth:Object.assign(Object.assign({},qR),{storageKey:d}),global:HR},p=WR(i??{},f);this.storageKey=(n=p.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=p.global.headers)!==null&&a!==void 0?a:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(g,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=p.auth)!==null&&o!==void 0?o:{},this.headers,p.global.fetch),this.fetch=XR(e,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new JC(new URL("rest/v1",u).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new UR(this.storageUrl.href,this.headers,this.fetch,i?.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new HC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,i)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,e;if(this.accessToken)return await this.accessToken();const{data:i}=await this.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:n,userStorage:a,storageKey:o,flowType:u,lock:d,debug:f},p,g){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sO({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),p),storageKey:o,autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:n,userStorage:a,flowType:u,lock:d,debug:f,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new gR(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,i)=>{this._handleTokenChanged(e,"CLIENT",i?.access_token)})}_handleTokenChanged(t,e,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const rO=(l,t,e)=>new nO(l,t,e);function aO(){if(typeof window<"u"||typeof process>"u")return!1;const l=process.version;if(l==null)return!1;const t=l.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}aO()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const oO="https://hzxyijuarpfbvygrhqqx.supabase.co",lO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh6eHlpanVhcnBmYnZ5Z3JocXF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA5MTU0MjYsImV4cCI6MjA3NjQ5MTQyNn0._l5uOOO5PBqV9fc2RDk3pjf8Q_DKENc4wTPCvALr0GE",$r=rO(oO,lO),pw=dt.createContext(void 0);function cO({children:l}){const[t,e]=dt.useState(!1),[i,n]=dt.useState(null);dt.useEffect(()=>{let o;async function u(){try{const{data:d,error:f}=await $r.from("presentation_state").select("id,dark_mode").limit(1).maybeSingle();if(f&&console.error("Error reading presentation_state during init:",f.message),d&&d.id){n(d.id);const p=!!d.dark_mode;e(p),p?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}else{const{data:p,error:g}=await $r.from("presentation_state").insert([{dark_mode:t,created_at:new Date().toISOString()}]).select("id").maybeSingle();g?console.error("Error creating presentation_state during init:",g.message):p&&p.id&&n(p.id)}o=$r.channel("presentation-state-channel").on("postgres_changes",{event:"UPDATE",schema:"public",table:"presentation_state"},p=>{!!p.new?.dark_mode?(document.documentElement.classList.add("dark"),e(!0)):(document.documentElement.classList.remove("dark"),e(!1)),p.new?.id&&n(p.new.id)}).subscribe()}catch(d){console.error("Unexpected error initializing theme:",d)}}return u(),()=>{o&&$r.removeChannel(o)}},[]);const a=dt.useCallback(async o=>{const u=!t;e(u),u?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");try{if(i){const{error:d}=await $r.from("presentation_state").update({dark_mode:u,user_id:o??null,created_at:new Date().toISOString()}).eq("id",i);d&&console.error("Error updating presentation_state:",d.message)}else{const{data:d,error:f}=await $r.from("presentation_state").insert([{dark_mode:u,user_id:o??null,created_at:new Date().toISOString()}]).select("id").maybeSingle();f?console.error("Error inserting presentation_state on toggle:",f.message):d&&d.id&&n(d.id)}}catch(d){console.error("Unexpected error toggling theme:",d)}},[t,i]);return st.jsx(pw.Provider,{value:{isDark:t,setIsDark:e,toggleTheme:a,presentationStateId:i},children:l})}function _O(){const l=dt.useContext(pw);if(!l)throw new Error("useTheme must be used within a ThemeProvider");return l}const uO=MT({routeTree:NC,basepath:"/me",history:VA()}),h0=document.getElementById("root");h0.innerHTML||$A.createRoot(h0).render(st.jsx(BC,{children:st.jsx(cO,{children:st.jsx(LT,{router:uO})})}));export{bu as A,qn as G,Po as R,Le as T,c_ as a,ws as b,N0 as c,pO as d,Gf as g,As as i,st as j,fO as p,dt as r,$r as s,_O as u};
